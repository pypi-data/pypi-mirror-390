"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[2799],{32799:(e,s,t)=>{t.r(s),t.d(s,{default:()=>S});var a=t(65043),l=t(61494),i=t(98105),r=t(22019),n=t(6051),o=t(15492),c=t(91686),d=t(42261),u=t(89073),x=t(96603),h=t(8354),p=t(76399),y=t(8347),f=t(35589),j=t(35271),m=t(20168),g=t(70579);const{Title:A,Text:v}=l.A,{TabPane:w}=i.A,b=[{label:"Full Pipeline",value:"full"},{label:"Prism Only",value:"prismOnly"},{label:"Diff Only",value:"diffOnly"},{label:"Raw",value:"raw"}],S=()=>{const{isDarkMode:e}=(0,y.D)(),[s,t]=(0,a.useState)([]),[l,S]=(0,a.useState)("all"),[T,k]=(0,a.useState)(!0),[C,P]=(0,a.useState)({}),[F,$]=(0,a.useState)(null),[D,O]=(0,a.useState)(!1),[R,V]=(0,a.useState)("full");(0,a.useEffect)(()=>{!async function(){k(!0);try{const e="/testcases";console.log("Loading test cases from:",e);const s=await fetch(`${e}/index.json`);if(!s.ok)throw new Error(`Failed to load index.json: ${s.statusText}`);const a=await s.json();console.log("Index loaded:",a);const l=(await Promise.all(Object.entries(a.testSets||{}).map(async s=>{let[t,a]=s;return Promise.all(a.cases.map(async s=>{const[l,i]=await Promise.all([fetch(`${e}/${a.path}/${s}.meta.json`),fetch(`${e}/${a.path}/${s}.diff`)]),r=await l.json(),n=await i.text();return{...r,id:s,category:t,diff:n}}))}))).flat().filter(e=>Boolean(e)&&Boolean(e.id)&&Boolean(e.name)&&Array.isArray(e.tags));t(l)}catch(e){console.error("Error loading test cases:",e),r.Ay.error("Failed to load test cases")}finally{k(!1)}}()},[]);const B=[...new Set(s.map(e=>e.category))],E="all"===l?s:s.filter(e=>e.category===l);return(0,g.jsxs)("div",{children:[(0,g.jsxs)(n.A,{direction:"vertical",style:{width:"100%",marginBottom:"16px"},children:[(0,g.jsx)(A,{level:3,children:"Diff Rendering Test Cases"}),(0,g.jsxs)(n.A,{children:[(0,g.jsx)(o.Ay,{type:"primary",onClick:async()=>{O(!0);const e=new j.y;try{const s=await Promise.all(m.bc.map(s=>e.runSuite(s)));$(s[0]),r.Ay.success("Test suite completed")}catch(s){r.Ay.error("Failed to run tests"),console.error("Test error:",s)}finally{O(!1)}},loading:D,children:"Run All Tests"}),(0,g.jsx)(o.Ay,{onClick:()=>P({}),disabled:0===Object.keys(C).length,children:"Clear Results"})]})]}),T?(0,g.jsxs)("div",{style:{textAlign:"center",padding:"40px"},children:[(0,g.jsx)(c.A,{size:"large"}),(0,g.jsx)("div",{style:{marginTop:"16px"},children:"Loading test cases..."})]}):(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(d.A,{message:"Visual Verification Suite",description:`${s.length} test cases loaded across ${B.length} categories.\n                                    Each case can be validated against its source file when provided.`,type:"info",showIcon:!0,style:{margin:"16px"}}),(0,g.jsx)(u.A,{style:{margin:"16px"},children:(0,g.jsxs)(n.A,{direction:"vertical",children:[(0,g.jsx)(v,{strong:!0,children:"Render Pipeline Control"}),(0,g.jsx)(x.Ay.Group,{options:b,onChange:e=>V(e.target.value),value:R,optionType:"button",buttonStyle:"solid"})]})}),F&&(0,g.jsx)(d.A,{message:"Test Results",description:(0,g.jsxs)(n.A,{direction:"vertical",size:"small",children:[(0,g.jsx)(A,{level:5,children:"Summary"}),(0,g.jsxs)(n.A,{direction:"vertical",children:[(0,g.jsxs)(v,{children:["Total Suites: ",F.summary.totalSuites]}),(0,g.jsxs)(v,{children:["Total Tests: ",F.summary.totalTests]}),(0,g.jsxs)(v,{children:["Passed: ",F.summary.totalPassed]}),(0,g.jsxs)(v,{children:["Failed: ",F.summary.totalFailed]}),(0,g.jsxs)(v,{children:["Skipped: ",F.summary.totalSkipped]}),(0,g.jsxs)(v,{children:["Duration: ",F.summary.totalDuration,"ms"]})]}),(0,g.jsx)(h.A,{}),(0,g.jsx)(A,{level:5,children:"Suite Details"}),F.suiteResults.map((e,s)=>(0,g.jsx)(u.A,{size:"small",style:{marginBottom:8},children:(0,g.jsxs)(n.A,{direction:"vertical",children:[(0,g.jsx)(v,{strong:!0,children:e.suiteName}),(0,g.jsxs)(n.A,{children:[(0,g.jsxs)(p.A,{color:"blue",children:[e.totalTests," tests"]}),(0,g.jsxs)(p.A,{color:"success",children:[e.passed," passed"]}),e.failed>0&&(0,g.jsxs)(p.A,{color:"error",children:[e.failed," failed"]}),e.skipped>0&&(0,g.jsxs)(p.A,{color:"warning",children:[e.skipped," skipped"]})]})]})},s))]}),type:0===F.summary.totalFailed?"success":"warning",showIcon:!0,style:{margin:"16px"}}),(0,g.jsxs)(i.A,{activeKey:l,onChange:S,style:{margin:"0 16px"},children:[(0,g.jsx)(w,{tab:"All Cases"},"all"),B.map(e=>(0,g.jsx)(w,{tab:e},e))]}),(0,g.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(600px, 1fr))",gap:"16px",padding:"16px"},children:E.map(s=>(0,g.jsx)(u.A,{title:s.name,extra:(0,g.jsxs)(n.A,{children:[(0,g.jsx)(p.A,{color:"blue",children:s.id}),(0,g.jsx)(p.A,{color:"purple",children:s.category}),s.subcategory&&(0,g.jsx)(p.A,{color:"cyan",children:s.subcategory}),void 0!==C[s.id]&&(0,g.jsx)(p.A,{color:C[s.id]?"success":"error",children:C[s.id]?"Valid":"Invalid"})]}),children:(0,g.jsxs)(n.A,{direction:"vertical",style:{width:"100%"},children:[(0,g.jsx)(v,{type:"secondary",children:s.description}),s.tags&&s.tags.length>0&&(0,g.jsx)(n.A,{wrap:!0,children:s.tags.map(e=>(0,g.jsx)(p.A,{children:e},e))}),(0,g.jsx)("div",{className:"diff-container",children:(0,g.jsx)(f.default,{markdown:`\`\`\`diff\n${s.diff}\n\`\`\``,enableCodeApply:!1})}),s.sourceContent&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(h.A,{children:"Source File"}),(0,g.jsx)("pre",{style:{backgroundColor:e?"#1f1f1f":"#f6f8fa",padding:"16px",borderRadius:"6px",overflow:"auto"},children:(0,g.jsx)("code",{children:s.sourceContent})})]}),(0,g.jsx)(o.Ay,{onClick:()=>(async e=>{try{const s=(await fetch("/api/apply-changes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({diff:e.diff,filePath:e.sourceFile,content:e.sourceContent,validate:!0})})).ok;return P(t=>({...t,[e.id]:s})),r.Ay.success(s?"Diff validation successful":"Diff validation failed"),s}catch(s){return console.error("Validation error:",s),r.Ay.error("Validation error occurred"),!1}})(s),style:{marginTop:"8px"},children:"Validate Diff"})]})},s.id))})]})]})}}}]);
//# sourceMappingURL=2799.73f5f393.chunk.js.map