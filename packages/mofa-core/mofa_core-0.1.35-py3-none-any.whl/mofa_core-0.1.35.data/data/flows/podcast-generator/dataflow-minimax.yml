nodes:
  # Script segmenter (DYNAMIC - launched separately)
  - id: script-segmenter
    build: pip install -e ../../agents/script-segmenter
    path: dynamic
    outputs:
      - daniu_text
      - yifan_text
      - script_complete
      - log
    inputs:
      daniu_segment_complete: minimax-daniu/segment_complete
      yifan_segment_complete: minimax-yifan/segment_complete

  # MiniMax T2A TTS for 大牛 (Liu Xiang voice)
  - id: minimax-daniu
    build: pip install -e ../../agents/minimax-t2a
    path: dora-minimax-t2a
    inputs:
      text: script-segmenter/daniu_text
    outputs:
      - audio
      - segment_complete
      - log
    env:
      MINIMAX_API_KEY: "$MINIMAX_API_KEY"
      MINIMAX_VOICE_ID: "ttv-voice-2025103011222725-sg8dZxUP"
      MINIMAX_SPEED: "1.0"
      MINIMAX_VOL: "1.0"
      MINIMAX_PITCH: "-1"
      ENABLE_ENGLISH_NORMALIZATION: "true"
      SAMPLE_RATE: "32000"
      BATCH_DURATION_MS: "2000"
      TEXT_LANG: "zh"
      LOG_LEVEL: "INFO"

  # MiniMax T2A TTS for 一帆 (Doubao voice)
  - id: minimax-yifan
    build: pip install -e ../../agents/minimax-t2a
    path: dora-minimax-t2a
    inputs:
      text: script-segmenter/yifan_text
    outputs:
      - audio
      - segment_complete
      - log
    env:
      MINIMAX_API_KEY: "$MINIMAX_API_KEY"
      MINIMAX_VOICE_ID: "moss_audio_aaa1346a-7ce7-11f0-8e61-2e6e3c7ee85d"
      MINIMAX_SPEED: "1.0"
      MINIMAX_VOL: "1.0"
      MINIMAX_PITCH: "0"
      ENABLE_ENGLISH_NORMALIZATION: "true"
      SAMPLE_RATE: "32000"
      BATCH_DURATION_MS: "2000"
      TEXT_LANG: "zh"
      LOG_LEVEL: "INFO"

  # Voice output (DYNAMIC - launched separately)
  - id: voice-output
    build: pip install -e ../../agents/voice-output
    path: dynamic
    outputs:
      - log
    inputs:
      daniu_audio:
        source: minimax-daniu/audio
        queue_size: 1000
      yifan_audio:
        source: minimax-yifan/audio
        queue_size: 1000
      daniu_segment_complete: minimax-daniu/segment_complete
      yifan_segment_complete: minimax-yifan/segment_complete
      script_complete: script-segmenter/script_complete

  # Viewer (DYNAMIC - launched separately, optional)
  - id: viewer
    build: pip install -e ../../agents/viewer
    path: dynamic
    inputs:
      segmenter_log: script-segmenter/log
      daniu_log: minimax-daniu/log
      yifan_log: minimax-yifan/log
      output_log: voice-output/log
      daniu_text: script-segmenter/daniu_text
      yifan_text: script-segmenter/yifan_text
      script_complete: script-segmenter/script_complete
