[build-system]
# Should be mirrored in requirements.txt
requires = [
    "cmake>=3.26.1",
    "ninja",
    "packaging>=24.2",
    "setuptools>=77.0.3,<80.0.0",
    "setuptools-scm>=8.0",
    "torch == 2.9.0",
    "wheel",
    "jinja2",
]
build-backend = "setuptools.build_meta"

[project]
name = "aphrodite-kernels"
authors = [{name = "PygmalionAI"}]
license = { file = "LICENSE" }
description = "Aphrodite Engine CUDA/C++ Kernels"
classifiers = [
    "Programming Language :: Python :: 3.10",
    "Programming Language :: Python :: 3.11",
    "Programming Language :: Python :: 3.12",
    "Programming Language :: Python :: 3.13",
    "Intended Audience :: Developers",
    "Intended Audience :: Information Technology",
    "Intended Audience :: Science/Research",
    "Topic :: Scientific/Engineering :: Artificial Intelligence",
]
requires-python = ">=3.10,<3.14"
dynamic = ["version"]

[project.urls]
Homepage="https://github.com/aphrodite-engine/aphrodite-engine"
Documentation="https://aphrodite.pygmalion.chat"

[tool.setuptools_scm]
search_parent_directories = false

[tool.setuptools.packages.find]
where = ["."]
include = ["aphrodite_kernels*"]

[tool.ruff]
# Allow lines to be as long as 120.
line-length = 120
exclude = [
    "csrc/**",
    "cmake/**",
    "aphrodite_kernels/aphrodite_flash_attn/**",
]

[tool.ruff.lint.per-file-ignores]
"aphrodite_kernels/_custom_ops.py" = ["F401", "F403", "F405"]

[tool.ruff.lint]
select = [
    # pycodestyle
    "E",
    # Pyflakes
    "F",
    # pyupgrade
    "UP",
    # flake8-bugbear
    "B",
    # flake8-simplify
    "SIM",
    # isort
    "I",
]
ignore = [
    # star imports
    "F405", "F403",
    # lambda expression assignment
    "E731",
    # zip without `strict=`
    "B905",
    # Loop control variable not used within loop body
    "B007",
    # f-string format
    "UP032",
    # ternary op
    "SIM108",
]

