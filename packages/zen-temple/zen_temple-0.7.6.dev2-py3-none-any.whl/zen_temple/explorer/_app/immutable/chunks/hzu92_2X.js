import"./DsnmJJEf.js";import{b as _e,s as xe,o as Qe}from"./Dv-zU6kM.js";import{C as ut,aq as pt,L as ft,Z as gt,f as he,d as X,r as $,s as oe,b3 as Ye,b as ce,t as ye,v as mt,p as Ue,u as be,j as Ee,h as E,e as me,i as ne,m as Ne,a as Fe,c as qe,g as Pe,k as tt,q as lt,be as st}from"./wiODf3u9.js";import{i as Ie}from"./BanhNaiI.js";import{p as Y,b as vt}from"./CdVljubK.js";import{s as bt,f as ke,g as it,u as wt}from"./DPXpTqfB.js";import{s as yt,a as ot,c as ct}from"./CcFbe3Gs.js";import{s as nt}from"./D_sdVLPA.js";function _t(d,e){var t=void 0,s;ut(()=>{t!==(t=e())&&(s&&(pt(s),s=null),t&&(s=ft(()=>{gt(()=>t(d))})))})}function St(d){return Array.from(new Set(d))}function fs(d){return d.map(e=>({value:e,label:e}))}function gs(d,e,t){return Object.entries(d).filter(([s,i])=>{const n=i.split(",");return t&&!e.includes(n[0])&&e.includes(n[1])||!t&&e.includes(n[0])&&!e.includes(n[1])}).map(([s,i])=>s)}var Lt=he('<label class="fw-medium fs-4"> </label>'),Ot=he('<div class="fw-medium fs-4"> </div>'),Et=he('<div class="flex justify-between items-center mb-1"><div class="uppercase text-gray-600 dark:text-gray-400 tracking-wide text-sm"><!></div> <!></div>');function Ct(d,e){var t=Et(),s=X(t),i=X(s);{var n=h=>{var o=Lt(),p=X(o,!0);$(o),ye(()=>{yt(o,"for",e.formId),xe(p,e.label)}),ce(h,o)},l=h=>{var o=Ot(),p=X(o,!0);$(o),ye(()=>xe(p,e.label)),ce(h,o)};Ie(i,h=>{e.formId?h(n):h(l,!1)})}$(s);var c=oe(s,2);_e(c,()=>e.rightSide??Ye),$(t),ce(d,t)}class xt{main;placeholder;values;single;max;value;valueText;valueDelete;valueOut;deselect;deselectPath;arrow;arrowClose;arrowOpen;content;contentOpen;dirAbove;dirBelow;search;searchHighlighter;searching;addable;addablePath;list;optgroup;optgroupLabel;optgroupLabelText;optgroupActions;optgroupSelectAll;optgroupSelectAllBox;optgroupSelectAllCheck;optgroupClosable;option;optionDelete;highlighted;mainOpen;close;selected;error;disabled;hide;constructor(e){e||(e={}),this.main=e.main||"ss-main",this.placeholder=e.placeholder||"ss-placeholder",this.values=e.values||"ss-values",this.single=e.single||"ss-single",this.max=e.max||"ss-max",this.value=e.value||"ss-value",this.valueText=e.valueText||"ss-value-text",this.valueDelete=e.valueDelete||"ss-value-delete",this.valueOut=e.valueOut||"ss-value-out",this.deselect=e.deselect||"ss-deselect",this.deselectPath=e.deselectPath||"M10,10 L90,90 M10,90 L90,10",this.arrow=e.arrow||"ss-arrow",this.arrowClose=e.arrowClose||"M10,30 L50,70 L90,30",this.arrowOpen=e.arrowOpen||"M10,70 L50,30 L90,70",this.content=e.content||"ss-content",this.contentOpen=e.contentOpen||"ss-open",this.dirAbove=e.dirAbove||"ss-dir-above",this.dirBelow=e.dirBelow||"ss-dir-below",this.search=e.search||"ss-search",this.searchHighlighter=e.searchHighlighter||"ss-search-highlight",this.searching=e.searching||"ss-searching",this.addable=e.addable||"ss-addable",this.addablePath=e.addablePath||"M50,10 L50,90 M10,50 L90,50",this.list=e.list||"ss-list",this.optgroup=e.optgroup||"ss-optgroup",this.optgroupLabel=e.optgroupLabel||"ss-optgroup-label",this.optgroupLabelText=e.optgroupLabelText||"ss-optgroup-label-text",this.optgroupActions=e.optgroupActions||"ss-optgroup-actions",this.optgroupSelectAll=e.optgroupSelectAll||"ss-selectall",this.optgroupSelectAllBox=e.optgroupSelectAllBox||"M60,10 L10,10 L10,90 L90,90 L90,50",this.optgroupSelectAllCheck=e.optgroupSelectAllCheck||"M30,45 L50,70 L90,10",this.optgroupClosable=e.optgroupClosable||"ss-closable",this.option=e.option||"ss-option",this.optionDelete=e.optionDelete||"M10,10 L90,90 M10,90 L90,10",this.highlighted=e.highlighted||"ss-highlighted",this.mainOpen=e.mainOpen||"ss-open",this.close=e.close||"ss-close",this.selected=e.selected||"ss-selected",this.error=e.error||"ss-error",this.disabled=e.disabled||"ss-disabled",this.hide=e.hide||"ss-hide"}}function Ze(){return Math.random().toString(36).substring(2,10)}function kt(d,e){function t(i,n){return n&&i&&i.classList&&i.classList.contains(n)||n&&i&&i.dataset&&i.dataset.id&&i.dataset.id===e?i:null}function s(i,n){return!i||i===document?null:t(i,n)?i:s(i.parentNode,n)}return t(d,e)||s(d,e)}function Be(d,e=50,t=!1){let s;return function(...i){const n=self,l=()=>{s=null,t||d.apply(n,i)},c=t&&!s;clearTimeout(s),s=setTimeout(l,e),c&&d.apply(n,i)}}function Ve(d,e){return JSON.stringify(d)===JSON.stringify(e)}function At(d){const e=d.replace(/[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g,t=>"-"+t.toLowerCase());return d[0]===d[0].toUpperCase()?e.substring(1):e}class q{id;value;text;html;defaultSelected;selected;display;disabled;placeholder;class;style;data;mandatory;constructor(e){this.id=!e.id||e.id===""?Ze():e.id,this.value=e.value===void 0?e.text||"":e.value||"",this.text=e.text||"",this.html=e.html||"",this.defaultSelected=e.defaultSelected!==void 0?e.defaultSelected:!1,this.selected=e.selected!==void 0?e.selected:!1,this.display=e.display!==void 0?e.display:!0,this.disabled=e.disabled!==void 0?e.disabled:!1,this.mandatory=e.mandatory!==void 0?e.mandatory:!1,this.placeholder=e.placeholder!==void 0?e.placeholder:!1,this.class=e.class||"",this.style=e.style||"",this.data=e.data||{}}}class le{id;label;selectAll;selectAllText;closable;options;constructor(e){if(this.id=!e.id||e.id===""?Ze():e.id,this.label=e.label||"",this.selectAll=e.selectAll===void 0?!1:e.selectAll,this.selectAllText=e.selectAllText||"Select All",this.closable=e.closable||"off",this.options=[],e.options)for(const t of e.options)this.options.push(new q(t))}}class Tt{selectType="single";data=[];selectedOrder=[];constructor(e,t){this.selectType=e,this.setData(t)}validateDataArray(e){if(!Array.isArray(e))return new Error("Data must be an array");for(let t of e)if(t)if(t instanceof le||"label"in t){if(!("label"in t))return new Error("Optgroup must have a label");if("options"in t&&t.options)for(let s of t.options){const i=this.validateOption(s);if(i)return i}}else if(t instanceof q||"text"in t){const s=this.validateOption(t);if(s)return s}else return new Error("Data object must be a valid optgroup or option");return null}validateOption(e){return"text"in e?null:new Error("Option must have a text")}partialToFullData(e){let t=[];return e.forEach(s=>{if(s){if(s instanceof le||"label"in s){let i=[];"options"in s&&s.options&&s.options.forEach(n=>{i.push(new q(n))}),i.length>0&&t.push(new le(s))}(s instanceof q||"text"in s)&&t.push(new q(s))}}),t}setData(e,t=!1){const s=this.partialToFullData(e);if(t){const i=this.getSelectedOptions(),n=[];i.forEach(l=>{let c=!1;for(const h of s){if(h instanceof q&&h.id===l.id){c=!0;break}if(h instanceof le){for(const o of h.options)if(o.id===l.id){c=!0;break}}}c||n.push(l)}),this.data=[...n,...s]}else this.data=s;this.selectType==="single"&&this.setSelectedBy("id",this.getSelected())}getData(){return this.filter(null,!0)}getDataOptions(){return this.filter(null,!1)}addOption(e,t=!1){if(t){let s=[new q(e)];this.setData(s.concat(this.getData()))}else this.setData(this.getData().concat(new q(e)))}setSelectedBy(e,t){let s=null,i=!1;const n=[];for(let c of this.data){if(c instanceof le)for(let h of c.options){s||(s=h);let o=h[e]||"";h.selected=i?!1:t.includes(o),h.selected&&(n.push(h),this.selectType==="single"&&(i=!0))}c instanceof q&&(s||(s=c),c.selected=i?!1:t.includes(c[e]),c.selected&&(n.push(c),this.selectType==="single"&&(i=!0)))}this.selectType==="single"&&s&&!i&&(s.selected=!0,n.push(s));const l=t.map(c=>n.find(h=>h[e]===c)?.id||"");this.selectedOrder=l}getSelected(){return this.getSelectedOptions().map(e=>e.id)}getSelectedValues(){return this.getSelectedOptions().map(e=>e.value)}getSelectedOptions(){return this.filter(e=>e.selected,!1)}getOptgroupByID(e){for(let t of this.data)if(t instanceof le&&t.id===e)return t;return null}getOptionByID(e){let t=this.filter(s=>s.id===e,!1);return t.length?t[0]:null}getSelectType(){return this.selectType}getFirstOption(){let e=null;for(let t of this.data)if(t instanceof le?e=t.options[0]:t instanceof q&&(e=t),e)break;return e}search(e,t){return e=e.trim(),e===""?this.getData():this.filter(s=>t(s,e),!0)}filter(e,t){const s=[];return this.data.forEach(i=>{if(i instanceof le){let n=[];if(i.options.forEach(l=>{(!e||e(l))&&(t?n.push(new q(l)):s.push(new q(l)))}),n.length>0){let l=new le(i);l.options=n,s.push(l)}}i instanceof q&&(!e||e(i))&&s.push(new q(i))}),s}selectedOrderOptions(e){const t=[];return this.selectedOrder.forEach(s=>{const i=e.find(n=>n.id===s);i&&t.push(i)}),e.forEach(s=>{let i=!1;t.forEach(n=>{if(s.id===n.id){i=!0;return}}),i||t.push(s)}),t}}class Dt{settings;store;callbacks;lastSelectedOption;main;content;classes;constructor(e,t,s,i){this.store=s,this.settings=e,this.classes=t,this.callbacks=i,this.lastSelectedOption=null,this.main=this.mainDiv(),this.content=this.contentDiv(),this.updateClassStyles(),this.updateAriaAttributes(),this.settings.contentLocation&&this.settings.contentLocation.appendChild(this.content.main)}enable(){this.main.main.classList.remove(this.classes.disabled),this.main.main.setAttribute("aria-disabled","false"),this.content.search.input.disabled=!1}disable(){this.main.main.classList.add(this.classes.disabled),this.main.main.setAttribute("aria-disabled","true"),this.content.search.input.disabled=!0}open(){this.main.arrow.path.setAttribute("d",this.classes.arrowOpen),this.main.main.setAttribute("aria-expanded","true");const e=this.settings.openPosition==="up"?this.classes.dirAbove:this.classes.dirBelow;this.main.main.classList.add(e),this.content.main.classList.add(e),this.content.main.classList.add(this.classes.contentOpen),this.content.search.input.removeAttribute("aria-hidden"),this.moveContent();const t=this.store.getSelectedOptions();if(t.length){const s=t[t.length-1].id,i=this.content.list.querySelector('[data-id="'+s+'"]');i&&this.ensureElementInView(this.content.list,i)}}close(){this.main.main.setAttribute("aria-expanded","false"),this.main.arrow.path.setAttribute("d",this.classes.arrowClose),this.content.main.classList.remove(this.classes.contentOpen),this.content.search.input.setAttribute("aria-hidden","true"),this.main.main.removeAttribute("aria-activedescendant"),setTimeout(()=>{this.main.main.classList.remove(this.classes.dirAbove,this.classes.dirBelow),this.content.main.classList.remove(this.classes.dirAbove,this.classes.dirBelow)},100)}updateClassStyles(){if(this.main.main.className="",this.main.main.removeAttribute("style"),this.content.main.className="",this.content.main.removeAttribute("style"),this.main.main.classList.add(this.classes.main),this.content.main.classList.add(this.classes.content),this.settings.style!==""&&(this.main.main.style.cssText=this.settings.style,this.content.main.style.cssText=this.settings.style),this.settings.class.length)for(const e of this.settings.class)e.trim()!==""&&(this.main.main.classList.add(e.trim()),this.content.main.classList.add(e.trim()));(this.settings.contentPosition==="relative"||this.settings.contentPosition==="fixed")&&this.content.main.classList.add("ss-"+this.settings.contentPosition)}updateAriaAttributes(){const e=this.content.list.id;this.main.main.role="combobox",this.main.main.setAttribute("aria-haspopup","listbox"),this.main.main.setAttribute("aria-controls",e),this.main.main.setAttribute("aria-expanded","false"),this.content.list.setAttribute("role","listbox"),this.content.list.setAttribute("aria-label",this.settings.ariaLabel+" listbox"),this.settings.isMultiple&&this.content.list.setAttribute("aria-multiselectable","true"),this.content.search.input.setAttribute("aria-controls",e)}mainDiv(){const e=document.createElement("div");e.dataset.id=this.settings.id,e.setAttribute("aria-label",this.settings.ariaLabel),e.tabIndex=0,e.onkeydown=o=>{switch(o.key){case"ArrowUp":case"ArrowDown":return this.callbacks.open(),o.key==="ArrowDown"?this.highlight("down"):this.highlight("up"),!1;case"Tab":return this.callbacks.close(),!0;case"Enter":case" ":this.callbacks.open();const p=this.content.list.querySelector("."+this.classes.highlighted);return p&&p.click(),!1;case"Escape":return this.callbacks.close(),!1}return o.key.length===1&&this.callbacks.open(),!0},e.onclick=o=>{this.settings.disabled||(this.settings.isOpen?this.callbacks.close():this.callbacks.open())};const t=document.createElement("div");t.classList.add(this.classes.values),e.appendChild(t);const s=document.createElement("div");s.classList.add(this.classes.deselect);const i=this.store?.getSelectedOptions();!this.settings.allowDeselect||this.settings.isMultiple&&i&&i.length<=0?s.classList.add(this.classes.hide):s.classList.remove(this.classes.hide),s.onclick=o=>{if(o.stopPropagation(),this.settings.disabled)return;let p=!0;const m=this.store.getSelectedOptions(),b=[];if(this.callbacks.beforeChange&&(p=this.callbacks.beforeChange(b,m)===!0),p){if(this.settings.isMultiple)this.callbacks.setSelected([],!1),this.updateDeselectAll();else{const x=this.store.getFirstOption(),S=x?x.id:"";this.callbacks.setSelected(S,!1)}this.settings.closeOnSelect&&this.callbacks.close(),this.callbacks.afterChange&&this.callbacks.afterChange(this.store.getSelectedOptions())}};const n=document.createElementNS("http://www.w3.org/2000/svg","svg");n.setAttribute("viewBox","0 0 100 100");const l=document.createElementNS("http://www.w3.org/2000/svg","path");l.setAttribute("d",this.classes.deselectPath),n.appendChild(l),s.appendChild(n),e.appendChild(s);const c=document.createElementNS("http://www.w3.org/2000/svg","svg");c.classList.add(this.classes.arrow),c.setAttribute("viewBox","0 0 100 100");const h=document.createElementNS("http://www.w3.org/2000/svg","path");return h.setAttribute("d",this.classes.arrowClose),this.settings.alwaysOpen&&c.classList.add(this.classes.hide),c.appendChild(h),e.appendChild(c),{main:e,values:t,deselect:{main:s,svg:n,path:l},arrow:{main:c,path:h}}}mainFocus(e){e!=="click"&&this.main.main.focus({preventScroll:!0})}placeholder(){const e=this.store.filter(i=>i.placeholder,!1);let t=this.settings.placeholderText;e.length&&(e[0].html!==""?t=e[0].html:e[0].text!==""&&(t=e[0].text));const s=document.createElement("div");return s.classList.add(this.classes.placeholder),s.innerHTML=t,s}renderValues(){if(!this.settings.isMultiple){this.renderSingleValue();return}this.renderMultipleValues(),this.updateDeselectAll()}renderSingleValue(){const e=this.store.filter(s=>s.selected&&!s.placeholder,!1),t=e.length>0?e[0]:null;if(!t)this.main.values.innerHTML=this.placeholder().outerHTML;else{const s=document.createElement("div");s.classList.add(this.classes.single),t.html?s.innerHTML=t.html:s.innerText=t.text,this.main.values.innerHTML=s.outerHTML}!this.settings.allowDeselect||!e.length?this.main.deselect.main.classList.add(this.classes.hide):this.main.deselect.main.classList.remove(this.classes.hide)}renderMultipleValues(){let e=this.main.values.childNodes,t=this.store.filter(i=>i.selected&&i.display,!1);if(t.length===0){this.main.values.innerHTML=this.placeholder().outerHTML;return}else{const i=this.main.values.querySelector("."+this.classes.placeholder);i&&i.remove()}if(t.length>this.settings.maxValuesShown){const i=document.createElement("div");i.classList.add(this.classes.max),i.textContent=this.settings.maxValuesMessage.replace("{number}",t.length.toString()),this.main.values.innerHTML=i.outerHTML;return}else{const i=this.main.values.querySelector("."+this.classes.max);i&&i.remove()}this.settings.keepOrder&&(t=this.store.selectedOrderOptions(t));let s=[];for(let i=0;i<e.length;i++){const n=e[i],l=n.getAttribute("data-id");l&&(t.filter(c=>c.id===l,!1).length||s.push(n))}for(const i of s)i.classList.add(this.classes.valueOut),setTimeout(()=>{this.main.values.hasChildNodes()&&this.main.values.contains(i)&&this.main.values.removeChild(i)},100);e=this.main.values.childNodes;for(let i=0;i<t.length;i++){let n=!0;for(let l=0;l<e.length;l++)t[i].id===String(e[l].dataset.id)&&(n=!1);n&&(this.settings.keepOrder?this.main.values.appendChild(this.multipleValue(t[i])):e.length===0?this.main.values.appendChild(this.multipleValue(t[i])):i===0?this.main.values.insertBefore(this.multipleValue(t[i]),e[i]):e[i-1].insertAdjacentElement("afterend",this.multipleValue(t[i])))}}multipleValue(e){const t=document.createElement("div");t.classList.add(this.classes.value),t.dataset.id=e.id;const s=document.createElement("div");if(s.classList.add(this.classes.valueText),s.textContent=e.text,t.appendChild(s),!e.mandatory){const i=document.createElement("div");i.classList.add(this.classes.valueDelete),i.setAttribute("tabindex","0"),i.onclick=c=>{if(c.preventDefault(),c.stopPropagation(),this.settings.disabled)return;let h=!0;const o=this.store.getSelectedOptions(),p=o.filter(m=>m.selected&&m.id!==e.id,!0);if(!(this.settings.minSelected&&p.length<this.settings.minSelected)&&(this.callbacks.beforeChange&&(h=this.callbacks.beforeChange(p,o)===!0),h)){let m=[];for(const b of p){if(b instanceof le)for(const x of b.options)x.id&&m.push(x.id);b instanceof q&&m.push(b.id)}this.callbacks.setSelected(m,!1),this.settings.closeOnSelect&&this.callbacks.close(),this.callbacks.afterChange&&this.callbacks.afterChange(p),this.updateDeselectAll()}};const n=document.createElementNS("http://www.w3.org/2000/svg","svg");n.setAttribute("viewBox","0 0 100 100");const l=document.createElementNS("http://www.w3.org/2000/svg","path");l.setAttribute("d",this.classes.optionDelete),n.appendChild(l),i.appendChild(n),t.appendChild(i),i.onkeydown=c=>{c.key==="Enter"&&i.click()}}return t}contentDiv(){const e=document.createElement("div");e.dataset.id=this.settings.id;const t=this.searchDiv();e.appendChild(t.main);const s=this.listDiv();return e.appendChild(s),{main:e,search:t,list:s}}moveContent(){if(this.settings.contentPosition==="relative"){this.moveContentBelow();return}if(this.settings.openPosition==="down"){this.moveContentBelow();return}else if(this.settings.openPosition==="up"){this.moveContentAbove();return}this.putContent()==="up"?this.moveContentAbove():this.moveContentBelow()}searchDiv(){const e=document.createElement("div"),t=document.createElement("input"),s=document.createElement("div");e.classList.add(this.classes.search);const i={main:e,input:t};if(this.settings.showSearch||(e.classList.add(this.classes.hide),t.readOnly=!0),t.type="search",t.placeholder=this.settings.searchPlaceholder,t.tabIndex=-1,t.setAttribute("aria-label",this.settings.searchPlaceholder),t.setAttribute("aria-autocomplete","list"),t.setAttribute("autocapitalize","off"),t.setAttribute("autocomplete","off"),t.setAttribute("autocorrect","off"),t.setAttribute("aria-hidden","true"),t.oninput=Be(n=>{this.callbacks.search(n.target.value)},100),t.onkeydown=n=>{switch(n.key){case"ArrowUp":case"ArrowDown":return n.key==="ArrowDown"?this.highlight("down"):this.highlight("up"),!1;case"Tab":return this.callbacks.close(),!0;case"Escape":return this.callbacks.close(),!1;case" ":const l=this.content.list.querySelector("."+this.classes.highlighted);return l?(l.click(),!1):!0;case"Enter":const c=this.content.list.querySelector("."+this.classes.highlighted);return c?(c.click(),!1):this.callbacks.addable?(s.click(),!1):!0}return!0},e.appendChild(t),this.callbacks.addable){s.classList.add(this.classes.addable);const n=document.createElementNS("http://www.w3.org/2000/svg","svg");n.setAttribute("viewBox","0 0 100 100");const l=document.createElementNS("http://www.w3.org/2000/svg","path");l.setAttribute("d",this.classes.addablePath),n.appendChild(l),s.appendChild(n),s.onclick=c=>{if(c.preventDefault(),c.stopPropagation(),!this.callbacks.addable)return;const h=this.content.search.input.value.trim();if(h===""){this.content.search.input.focus();return}const o=m=>{let b=new q(m);if(this.callbacks.addOption(b),this.settings.isMultiple){let x=this.store.getSelected();x.push(b.id),this.callbacks.setSelected(x,!0)}else this.callbacks.setSelected([b.id],!0);this.callbacks.search(""),this.settings.closeOnSelect&&setTimeout(()=>{this.callbacks.close()},100)},p=this.callbacks.addable(h);p===!1||p===void 0||p===null||(p instanceof Promise?p.then(m=>{typeof m=="string"?o({text:m,value:m}):p instanceof Error?this.renderError(p.message):o(m)}):typeof p=="string"?o({text:p,value:p}):p instanceof Error?this.renderError(p.message):o(p))},e.appendChild(s),i.addable={main:s,svg:n,path:l}}return i}searchFocus(){this.content.search.input.focus()}getOptions(e=!1,t=!1,s=!1){let i="."+this.classes.option;return e&&(i+=":not(."+this.classes.placeholder+")"),t&&(i+=":not(."+this.classes.disabled+")"),s&&(i+=":not(."+this.classes.hide+")"),Array.from(this.content.list.querySelectorAll(i))}highlight(e){const t=this.getOptions(!0,!0,!0);if(t.length===0)return;if(t.length===1&&!t[0].classList.contains(this.classes.highlighted)){t[0].classList.add(this.classes.highlighted);return}let s=!1;for(const n of t)n.classList.contains(this.classes.highlighted)&&(s=!0);if(!s){for(const n of t)if(n.classList.contains(this.classes.selected)){n.classList.add(this.classes.highlighted);break}}for(let n=0;n<t.length;n++)if(t[n].classList.contains(this.classes.highlighted)){const l=t[n];l.classList.remove(this.classes.highlighted);const c=l.parentElement;if(c&&c.classList.contains(this.classes.mainOpen)){const p=c.querySelector("."+this.classes.optgroupLabel);p&&p.click()}let h=t[e==="down"?n+1<t.length?n+1:0:n-1>=0?n-1:t.length-1];h.classList.add(this.classes.highlighted),this.ensureElementInView(this.content.list,h),h.id&&this.main.main.setAttribute("aria-activedescendant",h.id);const o=h.parentElement;if(o&&o.classList.contains(this.classes.close)){const p=o.querySelector("."+this.classes.optgroupLabel);p&&p.click()}return}const i=t[e==="down"?0:t.length-1];i.classList.add(this.classes.highlighted),i.id&&this.main.main.setAttribute("aria-activedescendant",i.id),this.ensureElementInView(this.content.list,i)}listDiv(){const e=document.createElement("div");e.classList.add(this.classes.list);const t=this.settings.id+"-list";return e.id=t,e.dataset.id=t,e}renderError(e){this.content.list.innerHTML="";const t=document.createElement("div");t.classList.add(this.classes.error),t.textContent=e,this.content.list.appendChild(t)}renderSearching(){this.content.list.innerHTML="";const e=document.createElement("div");e.classList.add(this.classes.searching),e.textContent=this.settings.searchingText,this.content.list.appendChild(e)}renderOptions(e){if(this.content.list.innerHTML="",e.length===0){const s=document.createElement("div");s.classList.add(this.classes.search),this.callbacks.addable?s.innerHTML=this.settings.addableText.replace("{value}",this.content.search.input.value):s.innerHTML=this.settings.searchText,this.content.list.appendChild(s);return}this.settings.allowDeselect&&!this.settings.isMultiple&&(this.store.filter(s=>s.placeholder,!1).length||this.store.addOption(new q({text:"",value:"",selected:!1,placeholder:!0}),!0));const t=document.createDocumentFragment();for(const s of e){if(s instanceof le){const i=document.createElement("div");i.classList.add(this.classes.optgroup);const n=document.createElement("div");n.classList.add(this.classes.optgroupLabel),i.appendChild(n);const l=document.createElement("div");l.classList.add(this.classes.optgroupLabelText),l.textContent=s.label,n.appendChild(l);const c=document.createElement("div");if(c.classList.add(this.classes.optgroupActions),n.appendChild(c),this.settings.isMultiple&&s.selectAll){const h=document.createElement("div");h.classList.add(this.classes.optgroupSelectAll);let o=!0;for(const S of s.options)if(!S.selected){o=!1;break}o&&h.classList.add(this.classes.selected);const p=document.createElement("span");p.textContent=s.selectAllText,h.appendChild(p);const m=document.createElementNS("http://www.w3.org/2000/svg","svg");m.setAttribute("viewBox","0 0 100 100"),h.appendChild(m);const b=document.createElementNS("http://www.w3.org/2000/svg","path");b.setAttribute("d",this.classes.optgroupSelectAllBox),m.appendChild(b);const x=document.createElementNS("http://www.w3.org/2000/svg","path");x.setAttribute("d",this.classes.optgroupSelectAllCheck),m.appendChild(x),h.addEventListener("click",S=>{S.preventDefault(),S.stopPropagation();const z=this.store.getSelected();if(o){const I=z.filter(K=>{for(const B of s.options)if(K===B.id)return!1;return!0});this.callbacks.setSelected(I,!0);return}else{let I=s.options.map(B=>B.id).filter(B=>B!==void 0);const K=z.concat(I);for(const B of s.options)B.id&&!this.store.getOptionByID(B.id)&&this.callbacks.addOption(new q(B));this.callbacks.setSelected(K,!0);return}}),c.appendChild(h)}if(s.closable!=="off"){const h=document.createElement("div");h.classList.add(this.classes.optgroupClosable);const o=document.createElementNS("http://www.w3.org/2000/svg","svg");o.setAttribute("viewBox","0 0 100 100"),o.classList.add(this.classes.arrow),h.appendChild(o);const p=document.createElementNS("http://www.w3.org/2000/svg","path");o.appendChild(p),s.options.some(m=>m.selected)||this.content.search.input.value.trim()!==""?(h.classList.add(this.classes.mainOpen),p.setAttribute("d",this.classes.arrowOpen)):s.closable==="open"?(i.classList.add(this.classes.mainOpen),p.setAttribute("d",this.classes.arrowOpen)):s.closable==="close"&&(i.classList.add(this.classes.close),p.setAttribute("d",this.classes.arrowClose)),n.addEventListener("click",m=>{m.preventDefault(),m.stopPropagation(),i.classList.contains(this.classes.close)?(i.classList.remove(this.classes.close),i.classList.add(this.classes.mainOpen),p.setAttribute("d",this.classes.arrowOpen)):(i.classList.remove(this.classes.mainOpen),i.classList.add(this.classes.close),p.setAttribute("d",this.classes.arrowClose))}),c.appendChild(h)}i.appendChild(n);for(const h of s.options)i.appendChild(this.option(new q(h))),t.appendChild(i)}s instanceof q&&t.appendChild(this.option(s))}this.content.list.appendChild(t)}option(e){if(e.placeholder){const s=document.createElement("div");return s.classList.add(this.classes.option),s.classList.add(this.classes.hide),s}const t=document.createElement("div");return t.dataset.id=e.id,t.id=this.settings.id+"-"+e.id,t.classList.add(this.classes.option),t.setAttribute("role","option"),e.class&&e.class.split(" ").forEach(s=>{t.classList.add(s)}),e.style&&(t.style.cssText=e.style),this.settings.searchHighlight&&this.content.search.input.value.trim()!==""?t.innerHTML=this.highlightText(e.html!==""?e.html:e.text,this.content.search.input.value,this.classes.searchHighlighter):e.html!==""?t.innerHTML=e.html:t.textContent=e.text,this.settings.showOptionTooltips&&t.textContent&&t.setAttribute("title",t.textContent),e.display||t.classList.add(this.classes.hide),e.disabled&&t.classList.add(this.classes.disabled),e.selected&&this.settings.hideSelected&&t.classList.add(this.classes.hide),e.selected?(t.classList.add(this.classes.selected),t.setAttribute("aria-selected","true"),this.main.main.setAttribute("aria-activedescendant",t.id)):(t.classList.remove(this.classes.selected),t.setAttribute("aria-selected","false")),t.addEventListener("click",s=>{s.preventDefault(),s.stopPropagation();const i=this.store.getSelected(),n=s.currentTarget,l=String(n.dataset.id),c=s.ctrlKey||s.metaKey;if(e.disabled||!this.settings.isMultiple&&e.selected&&!this.settings.allowDeselect||e.selected&&e.mandatory||this.settings.isMultiple&&this.settings.maxSelected<=i.length&&!e.selected||this.settings.isMultiple&&this.settings.minSelected>=i.length&&e.selected&&!c)return;let h=!1;const o=this.store.getSelectedOptions();let p=[];if(this.settings.isMultiple){const m=o.some(b=>b.id===l);if(s.shiftKey&&this.lastSelectedOption){const b=this.store.getDataOptions(),x=b.findIndex(z=>z.id===this.lastSelectedOption.id),S=b.findIndex(z=>z.id===e.id);if(x>=0&&S>=0){const z=Math.min(x,S),I=Math.max(x,S),K=b.slice(z,I+1).filter(B=>!o.find(ae=>ae.id===B.id));o.length+K.length<=this.settings.maxSelected?p=o.concat(K):p=o}else p=o}else c?(m?p=o.filter(b=>b.id!==l):p=o.concat(e),this.lastSelectedOption=e):(m?p=o.filter(b=>b.id!==l):p=o.concat(e),this.lastSelectedOption=e)}if(this.settings.isMultiple||(e.selected?p=[]:p=[e]),this.callbacks.beforeChange||(h=!0),this.callbacks.beforeChange&&(this.callbacks.beforeChange(p,o)===!1?h=!1:h=!0),h){this.store.getOptionByID(l)||this.callbacks.addOption(e),this.callbacks.setSelected(p.map(b=>b.id),!1);const m=s.ctrlKey||s.metaKey||s.shiftKey;this.settings.closeOnSelect&&!(this.settings.isMultiple&&m)&&this.callbacks.close(),this.callbacks.afterChange&&this.callbacks.afterChange(p)}}),t}destroy(){this.main.main.remove(),this.content.main.remove()}highlightText(e,t,s){const i=t.trim();if(i==="")return e;const n=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),l=document.createElement("div");l.innerHTML=e;const c=h=>{if(h.nodeType===Node.TEXT_NODE){const o=h.textContent||"",p=new RegExp("("+n+")","i");if(p.test(o)){const m=document.createElement("span");o.split(p).forEach((b,x)=>{if(b&&p.test(b)){const S=document.createElement("mark");S.className=s,S.textContent=b,m.appendChild(S)}else b&&m.appendChild(document.createTextNode(b))}),h.parentNode?.replaceChild(m,h)}}else h.nodeType===Node.ELEMENT_NODE&&Array.from(h.childNodes).forEach(o=>c(o))};return Array.from(l.childNodes).forEach(h=>c(h)),l.innerHTML}moveContentAbove(){const e=this.main.main.offsetHeight,t=this.content.main.offsetHeight;this.main.main.classList.remove(this.classes.dirBelow),this.main.main.classList.add(this.classes.dirAbove),this.content.main.classList.remove(this.classes.dirBelow),this.content.main.classList.add(this.classes.dirAbove);const s=this.main.main.getBoundingClientRect();this.content.main.style.margin="-"+(e+t-1)+"px 0px 0px 0px",this.content.main.style.top=s.top+s.height+(this.settings.contentPosition==="fixed"?0:window.scrollY)+"px",this.content.main.style.left=s.left+(this.settings.contentPosition==="fixed"?0:window.scrollX)+"px",this.content.main.style.width=s.width+"px"}moveContentBelow(){this.main.main.classList.remove(this.classes.dirAbove),this.main.main.classList.add(this.classes.dirBelow),this.content.main.classList.remove(this.classes.dirAbove),this.content.main.classList.add(this.classes.dirBelow);const e=this.main.main.getBoundingClientRect();this.content.main.style.margin="-1px 0px 0px 0px",this.settings.contentPosition!=="relative"&&(this.content.main.style.top=e.top+e.height+(this.settings.contentPosition==="fixed"?0:window.scrollY)+"px",this.content.main.style.left=e.left+(this.settings.contentPosition==="fixed"?0:window.scrollX)+"px",this.content.main.style.width=e.width+"px")}ensureElementInView(e,t){const s=e.scrollTop+e.offsetTop,i=s+e.clientHeight,n=t.offsetTop,l=n+t.clientHeight;n<s?e.scrollTop-=s-n:l>i&&(e.scrollTop+=l-i)}putContent(){const e=this.main.main.offsetHeight,t=this.main.main.getBoundingClientRect(),s=this.content.main.offsetHeight;return window.innerHeight-(t.top+e)<=s&&t.top>s?"up":"down"}updateDeselectAll(){if(!this.store||!this.settings)return;const e=this.store.getSelectedOptions(),t=e&&e.length>0,s=this.settings.isMultiple,i=this.settings.allowDeselect,n=this.main.deselect.main,l=this.classes.hide;i&&!(s&&!t)?n.classList.remove(l):n.classList.add(l)}}class Nt{select;onValueChange;onClassChange;onDisabledChange;onOptionsChange;onLabelClick;listen=!1;observer=null;preventNativeSelect=null;preventNativeSelectMousedown=null;preventNativeSelectFocus=null;constructor(e){this.select=e,this.valueChange=this.valueChange.bind(this),this.select.addEventListener("change",this.valueChange,{passive:!0}),this.observer=new MutationObserver(this.observeCall.bind(this)),this.changeListen(!0)}enable(){this.select.disabled=!1}disable(){this.select.disabled=!0}hideUI(){this.select.tabIndex=-1,this.select.style.position="absolute",this.select.style.width="1px",this.select.style.height="1px",this.select.style.opacity="0",this.select.style.overflow="hidden",this.select.style.pointerEvents="none",this.select.style.margin="0",this.select.style.padding="0",this.select.style.borderWidth="0",this.select.style.clip="rect(0 0 0 0)",this.select.setAttribute("aria-hidden","true"),this.preventNativeSelect||(this.preventNativeSelect=e=>{e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation()},this.preventNativeSelectMousedown=e=>{e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation()},this.preventNativeSelectFocus=e=>{e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation()},this.select.addEventListener("click",this.preventNativeSelect,{capture:!0,passive:!1}),this.select.addEventListener("mousedown",this.preventNativeSelectMousedown,{capture:!0,passive:!1}),this.select.addEventListener("focus",this.preventNativeSelectFocus,{capture:!0,passive:!1}))}showUI(){this.select.removeAttribute("tabindex"),this.select.style.position="",this.select.style.width="",this.select.style.height="",this.select.style.opacity="",this.select.style.overflow="",this.select.style.pointerEvents="",this.select.style.margin="",this.select.style.padding="",this.select.style.borderWidth="",this.select.style.clip="",this.select.removeAttribute("aria-hidden"),this.preventNativeSelect&&(this.select.removeEventListener("click",this.preventNativeSelect,{capture:!0}),this.preventNativeSelect=null),this.preventNativeSelectMousedown&&(this.select.removeEventListener("mousedown",this.preventNativeSelectMousedown,{capture:!0}),this.preventNativeSelectMousedown=null),this.preventNativeSelectFocus&&(this.select.removeEventListener("focus",this.preventNativeSelectFocus,{capture:!0}),this.preventNativeSelectFocus=null)}changeListen(e){this.listen=e,e&&this.observer&&this.observer.observe(this.select,{subtree:!0,childList:!0,attributes:!0}),e||this.observer&&this.observer.disconnect()}valueChange(e){return this.listen&&this.onValueChange&&this.onValueChange(this.getSelectedOptions()),!0}observeCall(e){if(!this.listen)return;let t=!1,s=!1,i=!1;for(const n of e){if(n.target===this.select&&(n.attributeName==="disabled"&&(s=!0),n.attributeName==="class"&&(t=!0),n.type==="childList")){for(const l of Array.from(n.addedNodes))if(l.nodeName==="OPTION"&&l.value===this.select.value){this.select.dispatchEvent(new Event("change"));break}i=!0}(n.target.nodeName==="OPTGROUP"||n.target.nodeName==="OPTION")&&(i=!0)}t&&this.onClassChange&&this.onClassChange(this.select.className.split(" ")),s&&this.onDisabledChange&&(this.changeListen(!1),this.onDisabledChange(this.select.disabled),this.changeListen(!0)),i&&this.onOptionsChange&&(this.changeListen(!1),this.onOptionsChange(this.getData()),this.changeListen(!0))}getData(){let e=[];const t=this.select.childNodes;for(const s of t)s.nodeName==="OPTGROUP"&&e.push(this.getDataFromOptgroup(s)),s.nodeName==="OPTION"&&e.push(this.getDataFromOption(s));return e}getDataFromOptgroup(e){let t={id:e.id,label:e.label,selectAll:e.dataset?e.dataset.selectall==="true":!1,selectAllText:e.dataset?e.dataset.selectalltext:"Select all",closable:e.dataset?e.dataset.closable:"off",options:[]};const s=e.childNodes;for(const i of s)i.nodeName==="OPTION"&&t.options.push(this.getDataFromOption(i));return t}getDataFromOption(e){return{id:e.id,value:e.value,text:e.text,html:e.dataset&&e.dataset.html?e.dataset.html:"",defaultSelected:e.defaultSelected,selected:e.selected,display:e.style.display!=="none",disabled:e.disabled,mandatory:e.dataset?e.dataset.mandatory==="true":!1,placeholder:e.dataset.placeholder==="true",class:e.className,style:e.style.cssText,data:e.dataset}}getSelectedOptions(){let e=[];const t=this.select.childNodes;for(const s of t){if(s.nodeName==="OPTGROUP"){const i=s.childNodes;for(const n of i)if(n.nodeName==="OPTION"){const l=n;l.selected&&e.push(this.getDataFromOption(l))}}if(s.nodeName==="OPTION"){const i=s;i.selected&&e.push(this.getDataFromOption(i))}}return e}getSelectedValues(){return this.getSelectedOptions().map(e=>e.value)}setSelected(e){this.changeListen(!1);const t=this.select.childNodes;for(const s of t){if(s.nodeName==="OPTGROUP"){const i=s.childNodes;for(const n of i)if(n.nodeName==="OPTION"){const l=n;l.selected=e.includes(l.id)}}if(s.nodeName==="OPTION"){const i=s;i.selected=e.includes(i.id)}}this.changeListen(!0)}setSelectedByValue(e){this.changeListen(!1);const t=this.select.childNodes;for(const s of t){if(s.nodeName==="OPTGROUP"){const i=s.childNodes;for(const n of i)if(n.nodeName==="OPTION"){const l=n;l.selected=e.includes(l.value)}}if(s.nodeName==="OPTION"){const i=s;i.selected=e.includes(i.value)}}this.changeListen(!0)}updateSelect(e,t,s){this.changeListen(!1),e&&(this.select.dataset.id=e),t&&(this.select.style.cssText=t),s&&(this.select.className="",s.forEach(i=>{i.trim()!==""&&this.select.classList.add(i.trim())})),this.changeListen(!0)}updateOptions(e){this.changeListen(!1),this.select.innerHTML="";for(const t of e)t instanceof le&&this.select.appendChild(this.createOptgroup(t)),t instanceof q&&this.select.appendChild(this.createOption(t));this.select.dispatchEvent(new Event("change",{bubbles:!0})),this.changeListen(!0)}createOptgroup(e){const t=document.createElement("optgroup");if(t.id=e.id,t.label=e.label,e.selectAll&&(t.dataset.selectAll="true"),e.closable!=="off"&&(t.dataset.closable=e.closable),e.options)for(const s of e.options)t.appendChild(this.createOption(s));return t}createOption(e){const t=document.createElement("option");return t.id=e.id,t.value=e.value,t.textContent=e.text,e.html!==""&&t.setAttribute("data-html",e.html),t.defaultSelected=e.defaultSelected,t.selected=e.selected,e.disabled&&(t.disabled=!0),e.display||(t.style.display="none"),e.placeholder&&t.setAttribute("data-placeholder","true"),e.mandatory&&t.setAttribute("data-mandatory","true"),e.class&&e.class.split(" ").forEach(s=>{t.classList.add(s)}),e.data&&typeof e.data=="object"&&Object.keys(e.data).forEach(s=>{t.setAttribute("data-"+At(s),e.data[s])}),t}setupLabelHandlers(){const e=[],t=this.select.id;t&&document.querySelectorAll(`label[for="${t}"]`).forEach(i=>e.push(i));let s=this.select.parentElement;for(;s&&s!==document.body;){if(s.tagName==="LABEL"){e.push(s);break}s=s.parentElement}Array.from(new Set(e)).forEach(i=>{if(i.__slimSelectLabelHandler)return;const n=l=>{l.preventDefault(),l.stopPropagation(),this.onLabelClick&&setTimeout(()=>{this.onLabelClick()},0)};i.__slimSelectLabelHandler=n,i.addEventListener("click",n,{capture:!0,passive:!1})})}removeLabelHandlers(){const e=[],t=this.select.id;t&&document.querySelectorAll(`label[for="${t}"]`).forEach(i=>e.push(i));let s=this.select.parentElement;for(;s&&s!==document.body;){if(s.tagName==="LABEL"){e.push(s);break}s=s.parentElement}Array.from(new Set(e)).forEach(i=>{const n=i.__slimSelectLabelHandler;n&&(i.removeEventListener("click",n,{capture:!0}),delete i.__slimSelectLabelHandler)})}destroy(){this.changeListen(!1),this.select.removeEventListener("change",this.valueChange),this.preventNativeSelect&&(this.select.removeEventListener("click",this.preventNativeSelect,{capture:!0}),this.preventNativeSelect=null),this.preventNativeSelectMousedown&&(this.select.removeEventListener("mousedown",this.preventNativeSelectMousedown,{capture:!0}),this.preventNativeSelectMousedown=null),this.preventNativeSelectFocus&&(this.select.removeEventListener("focus",this.preventNativeSelectFocus,{capture:!0}),this.preventNativeSelectFocus=null),this.observer&&(this.observer.disconnect(),this.observer=null),this.removeLabelHandlers(),delete this.select.dataset.id,this.showUI()}}class Pt{id="";style="";class=[];isMultiple=!1;isOpen=!1;isFullOpen=!1;intervalMove=null;disabled;alwaysOpen;showSearch;focusSearch;ariaLabel;searchPlaceholder;searchText;searchingText;searchHighlight;closeOnSelect;contentLocation;contentPosition;openPosition;placeholderText;allowDeselect;hideSelected;keepOrder;showOptionTooltips;minSelected;maxSelected;timeoutDelay;maxValuesShown;maxValuesMessage;addableText;constructor(e){e||(e={}),this.id="ss-"+Ze(),this.style=e.style||"",this.class=e.class||[],this.disabled=e.disabled!==void 0?e.disabled:!1,this.alwaysOpen=e.alwaysOpen!==void 0?e.alwaysOpen:!1,this.showSearch=e.showSearch!==void 0?e.showSearch:!0,this.focusSearch=e.focusSearch!==void 0?e.focusSearch:!0,this.ariaLabel=e.ariaLabel||"Combobox",this.searchPlaceholder=e.searchPlaceholder||"Search...",this.searchText=e.searchText||"No Results",this.searchingText=e.searchingText||"Searching...",this.searchHighlight=e.searchHighlight!==void 0?e.searchHighlight:!1,this.closeOnSelect=e.closeOnSelect!==void 0?e.closeOnSelect:!0,this.contentLocation=e.contentLocation||document.body,this.contentPosition=e.contentPosition||"absolute",this.openPosition=e.openPosition||"auto",this.placeholderText=e.placeholderText!==void 0?e.placeholderText:"Select Value",this.allowDeselect=e.allowDeselect!==void 0?e.allowDeselect:!1,this.hideSelected=e.hideSelected!==void 0?e.hideSelected:!1,this.keepOrder=e.keepOrder!==void 0?e.keepOrder:!1,this.showOptionTooltips=e.showOptionTooltips!==void 0?e.showOptionTooltips:!1,this.minSelected=e.minSelected||0,this.maxSelected=e.maxSelected||1e3,this.timeoutDelay=e.timeoutDelay||200,this.maxValuesShown=e.maxValuesShown||20,this.maxValuesMessage=e.maxValuesMessage||"{number} selected",this.addableText=e.addableText||'Press "Enter" to add {value}'}}class Mt{selectEl;settings;cssClasses;select;store;render;openTimeout=null;closeTimeout=null;events={search:void 0,searchFilter:(e,t)=>e.text.toLowerCase().indexOf(t.toLowerCase())!==-1,addable:void 0,beforeChange:void 0,afterChange:void 0,beforeOpen:void 0,afterOpen:void 0,beforeClose:void 0,afterClose:void 0};constructor(e){if(this.selectEl=typeof e.select=="string"?document.querySelector(e.select):e.select,!this.selectEl){e.events&&e.events.error&&e.events.error(new Error("Could not find select element"));return}if(this.selectEl.tagName!=="SELECT"){e.events&&e.events.error&&e.events.error(new Error("Element isnt of type select"));return}this.selectEl.dataset.ssid&&this.destroy(),this.settings=new Pt(e.settings),this.cssClasses=new xt(e.cssClasses);const t=["beforeOpen","afterOpen","beforeClose","afterClose"];for(const c in e.events)e.events.hasOwnProperty(c)&&(t.indexOf(c)!==-1?this.events[c]=Be(e.events[c],100):this.events[c]=e.events[c]);this.settings.disabled=e.settings?.disabled?e.settings.disabled:this.selectEl.disabled,this.settings.isMultiple=this.selectEl.multiple,this.settings.style=this.selectEl.style.cssText,this.settings.class=this.selectEl.className.split(" "),this.select=new Nt(this.selectEl),this.selectEl.id||(this.selectEl.id=this.settings.id),this.select.updateSelect(this.settings.id,this.settings.style,this.settings.class),this.select.hideUI(),this.select.onValueChange=c=>{this.setSelected(c.map(h=>h.id))},this.select.onClassChange=c=>{this.settings.class=c,this.render.updateClassStyles()},this.select.onDisabledChange=c=>{c?this.disable():this.enable()},this.select.onOptionsChange=c=>{this.setData(c)},this.select.onLabelClick=()=>{this.settings.disabled||this.open()};const s=e.data?e.data:this.select.getData();this.store=new Tt(this.settings.isMultiple?"multiple":"single",s),e.data&&this.select.updateOptions(this.store.getData());const i={open:this.open.bind(this),close:this.close.bind(this),addable:this.events.addable?this.events.addable:void 0,setSelected:this.setSelected.bind(this),addOption:this.addOption.bind(this),search:this.search.bind(this),beforeChange:this.events.beforeChange,afterChange:this.events.afterChange};this.render=new Dt(this.settings,this.cssClasses,this.store,i),this.render.renderValues(),this.render.renderOptions(this.store.getData());const n=this.selectEl.getAttribute("aria-label"),l=this.selectEl.getAttribute("aria-labelledby");n?this.render.main.main.setAttribute("aria-label",n):l&&this.render.main.main.setAttribute("aria-labelledby",l),this.selectEl.parentNode&&this.selectEl.parentNode.insertBefore(this.render.main.main,this.selectEl.nextSibling),window.addEventListener("resize",this.windowResize,!1),this.settings.openPosition==="auto"&&window.addEventListener("scroll",this.windowScroll,!1),document.addEventListener("visibilitychange",this.windowVisibilityChange),this.settings.disabled&&this.disable(),this.settings.alwaysOpen&&this.open(),this.select.setupLabelHandlers(),this.selectEl.slim=this}enable(){this.settings.disabled=!1,this.select.enable(),this.render.enable()}disable(){this.settings.disabled=!0,this.select.disable(),this.render.disable()}getData(){return this.store.getData()}setData(e){const t=this.store.getSelected(),s=this.store.validateDataArray(e);if(s){this.events.error&&this.events.error(s);return}this.store.setData(e);const i=this.store.getData();this.select.updateOptions(i),this.render.renderValues(),this.render.renderOptions(i),this.events.afterChange&&!Ve(t,this.store.getSelected())&&this.events.afterChange(this.store.getSelectedOptions())}getSelected(){let e=this.store.getSelectedOptions();return this.settings.keepOrder&&(e=this.store.selectedOrderOptions(e)),e.map(t=>t.value)}setSelected(e,t=!0){const s=this.store.getSelected(),i=this.store.getDataOptions();e=Array.isArray(e)?e:[e];const n=[];for(const c of e){if(i.find(h=>h.id==c)){n.push(c);continue}for(const h of i.filter(o=>o.value==c))n.push(h.id)}this.store.setSelectedBy("id",n);const l=this.store.getData();this.select.updateOptions(l),this.render.renderValues(),this.render.content.search.input.value!==""?this.search(this.render.content.search.input.value):this.render.renderOptions(l),t&&this.events.afterChange&&!Ve(s,this.store.getSelected())&&this.events.afterChange(this.store.getSelectedOptions())}addOption(e){const t=this.store.getSelected();this.store.getDataOptions().some(i=>i.value===(e.value??e.text))||this.store.addOption(e);const s=this.store.getData();this.select.updateOptions(s),this.render.renderValues(),this.render.renderOptions(s),this.events.afterChange&&!Ve(t,this.store.getSelected())&&this.events.afterChange(this.store.getSelectedOptions())}open(){this.settings.disabled||this.settings.isOpen||(this.events.beforeOpen&&this.events.beforeOpen(),this.render.open(),this.settings.showSearch&&this.settings.focusSearch&&this.render.searchFocus(),this.settings.isOpen=!0,this.openTimeout=setTimeout(()=>{this.events.afterOpen&&this.events.afterOpen(),this.settings.isOpen&&(this.settings.isFullOpen=!0),document.addEventListener("click",this.documentClick)},this.settings.timeoutDelay),this.settings.contentPosition==="absolute"&&(this.settings.intervalMove&&clearInterval(this.settings.intervalMove),this.settings.intervalMove=setInterval(this.render.moveContent.bind(this.render),500)))}close(e=null){!this.settings.isOpen||this.settings.alwaysOpen||(this.events.beforeClose&&this.events.beforeClose(),this.render.close(),this.render.content.search.input.value!==""&&this.search(""),this.render.mainFocus(e),this.settings.isOpen=!1,this.settings.isFullOpen=!1,this.closeTimeout=setTimeout(()=>{this.events.afterClose&&this.events.afterClose(),document.removeEventListener("click",this.documentClick)},this.settings.timeoutDelay),this.settings.intervalMove&&clearInterval(this.settings.intervalMove))}search(e){if(this.render.content.search.input.value!==e&&(this.render.content.search.input.value=e),e===""){this.render.renderOptions(this.store.getData());return}if(!this.events.search){const s=e===""?this.store.getData():this.store.search(e,this.events.searchFilter);this.render.renderOptions(s);return}this.render.renderSearching();const t=this.events.search(e,this.store.getSelectedOptions());if(t instanceof Promise){t.then(s=>{this.store.setData(s,!0),this.select.updateOptions(this.store.getData()),this.render.renderOptions(this.store.getData())}).catch(s=>{this.render.renderError(typeof s=="string"?s:s.message)});return}else Array.isArray(t)?(this.store.setData(t,!0),this.select.updateOptions(this.store.getData()),this.render.renderOptions(this.store.getData())):this.render.renderError("Search event must return a promise or an array of data")}destroy(){this.openTimeout&&(clearTimeout(this.openTimeout),this.openTimeout=null),this.closeTimeout&&(clearTimeout(this.closeTimeout),this.closeTimeout=null),this.settings.intervalMove&&(clearInterval(this.settings.intervalMove),this.settings.intervalMove=null),document.removeEventListener("click",this.documentClick),window.removeEventListener("resize",this.windowResize,!1),this.settings.openPosition==="auto"&&window.removeEventListener("scroll",this.windowScroll,!1),document.removeEventListener("visibilitychange",this.windowVisibilityChange),this.store.setData([]),this.render.destroy(),this.select.destroy()}windowResize=Be(()=>{!this.settings.isOpen&&!this.settings.isFullOpen||this.render.moveContent()});windowScroll=Be(()=>{!this.settings.isOpen&&!this.settings.isFullOpen||this.render.moveContent()});documentClick=e=>{this.settings.isOpen&&e.target&&!kt(e.target,this.settings.id)&&this.close(e.type)};windowVisibilityChange=()=>{document.hidden&&this.close()}}var Rt=he('<!> <select class="slim mb-2"></select>',1);function Ke(d,e){const t=mt();Ue(e,!0);let s=Y(e,"value",15),i=Y(e,"disabled",3,!1),n,l=me(!1),c="",h=Ne(()=>e.options.map(S=>typeof S=="string"?{text:S,value:S}:{text:S.label,value:S.value}));function o(S){s(S),ne(l,!0),e.onUpdate?.(S)}function p(S){return n=new Mt({select:S,data:E(h),settings:{id:t,showSearch:!1,allowDeselect:!0},events:{afterChange:z=>{o(z[0]?.value)}},cssClasses:{deselect:"hidden"}}),c=JSON.stringify(E(h)),n.setSelected(s()||"",!1),()=>{n?.destroy()}}be(()=>{s(),Ee(async()=>{if(E(l)){ne(l,!1);return}n&&n.setSelected(s()||"",!1)})}),be(()=>{E(h),Ee(async()=>{JSON.stringify(E(h))!==c&&(c=JSON.stringify(E(h)),n&&n.setData(bt(E(h).map(S=>new q(S)))))})}),be(()=>{i(),Ee(()=>{n&&(i()?n.disable():n.enable())})});var m=Rt(),b=Fe(m);Ct(b,{get label(){return e.label},get formId(){return t}});var x=oe(b,2);_t(x,()=>p),ye(()=>x.disabled=i()),ce(d,m),qe()}function It(d){return d&&d.__esModule&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d}var He={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/var Ft=He.exports,at;function Bt(){return at||(at=1,(function(d,e){((t,s)=>{d.exports=s()})(Ft,function t(){var s=typeof self<"u"?self:typeof window<"u"?window:s!==void 0?s:{},i,n=!s.document&&!!s.postMessage,l=s.IS_PAPA_WORKER||!1,c={},h=0,o={};function p(a){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(r){var u=Se(r);u.chunkSize=parseInt(u.chunkSize),r.step||r.chunk||(u.chunkSize=null),this._handle=new z(u),(this._handle.streamer=this)._config=u}).call(this,a),this.parseChunk=function(r,u){var g=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<g){let C=this._config.newline;C||(f=this._config.quoteChar||'"',C=this._handle.guessLineEndings(r,f)),r=[...r.split(C).slice(g)].join(C)}this.isFirstChunk&&P(this._config.beforeFirstChunk)&&(f=this._config.beforeFirstChunk(r))!==void 0&&(r=f),this.isFirstChunk=!1,this._halted=!1;var g=this._partialLine+r,f=(this._partialLine="",this._handle.parse(g,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(r=f.meta.cursor,g=(this._finished||(this._partialLine=g.substring(r-this._baseIndex),this._baseIndex=r),f&&f.data&&(this._rowCount+=f.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),l)s.postMessage({results:f,workerId:o.WORKER_ID,finished:g});else if(P(this._config.chunk)&&!u){if(this._config.chunk(f,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=f=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(f.data),this._completeResults.errors=this._completeResults.errors.concat(f.errors),this._completeResults.meta=f.meta),this._completed||!g||!P(this._config.complete)||f&&f.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),g||f&&f.meta.paused||this._nextChunk(),f}this._halted=!0},this._sendError=function(r){P(this._config.error)?this._config.error(r):l&&this._config.error&&s.postMessage({workerId:o.WORKER_ID,error:r,finished:!1})}}function m(a){var r;(a=a||{}).chunkSize||(a.chunkSize=o.RemoteChunkSize),p.call(this,a),this._nextChunk=n?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(u){this._input=u,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(r=new XMLHttpRequest,this._config.withCredentials&&(r.withCredentials=this._config.withCredentials),n||(r.onload=ue(this._chunkLoaded,this),r.onerror=ue(this._chunkError,this)),r.open(this._config.downloadRequestBody?"POST":"GET",this._input,!n),this._config.downloadRequestHeaders){var u,g=this._config.downloadRequestHeaders;for(u in g)r.setRequestHeader(u,g[u])}var f;this._config.chunkSize&&(f=this._start+this._config.chunkSize-1,r.setRequestHeader("Range","bytes="+this._start+"-"+f));try{r.send(this._config.downloadRequestBody)}catch(C){this._chunkError(C.message)}n&&r.status===0&&this._chunkError()}},this._chunkLoaded=function(){r.readyState===4&&(r.status<200||400<=r.status?this._chunkError():(this._start+=this._config.chunkSize||r.responseText.length,this._finished=!this._config.chunkSize||this._start>=(u=>(u=u.getResponseHeader("Content-Range"))!==null?parseInt(u.substring(u.lastIndexOf("/")+1)):-1)(r),this.parseChunk(r.responseText)))},this._chunkError=function(u){u=r.statusText||u,this._sendError(new Error(u))}}function b(a){(a=a||{}).chunkSize||(a.chunkSize=o.LocalChunkSize),p.call(this,a);var r,u,g=typeof FileReader<"u";this.stream=function(f){this._input=f,u=f.slice||f.webkitSlice||f.mozSlice,g?((r=new FileReader).onload=ue(this._chunkLoaded,this),r.onerror=ue(this._chunkError,this)):r=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var f=this._input,C=(this._config.chunkSize&&(C=Math.min(this._start+this._config.chunkSize,this._input.size),f=u.call(f,this._start,C)),r.readAsText(f,this._config.encoding));g||this._chunkLoaded({target:{result:C}})},this._chunkLoaded=function(f){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(f.target.result)},this._chunkError=function(){this._sendError(r.error)}}function x(a){var r;p.call(this,a=a||{}),this.stream=function(u){return r=u,this._nextChunk()},this._nextChunk=function(){var u,g;if(!this._finished)return u=this._config.chunkSize,r=u?(g=r.substring(0,u),r.substring(u)):(g=r,""),this._finished=!r,this.parseChunk(g)}}function S(a){p.call(this,a=a||{});var r=[],u=!0,g=!1;this.pause=function(){p.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){p.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(f){this._input=f,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){g&&r.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),r.length?this.parseChunk(r.shift()):u=!0},this._streamData=ue(function(f){try{r.push(typeof f=="string"?f:f.toString(this._config.encoding)),u&&(u=!1,this._checkIsFinished(),this.parseChunk(r.shift()))}catch(C){this._streamError(C)}},this),this._streamError=ue(function(f){this._streamCleanUp(),this._sendError(f)},this),this._streamEnd=ue(function(){this._streamCleanUp(),g=!0,this._streamData("")},this),this._streamCleanUp=ue(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function z(a){var r,u,g,f,C=Math.pow(2,53),V=-C,se=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,k=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,v=this,H=0,y=0,ee=!1,L=!1,A=[],w={data:[],errors:[],meta:{}};function J(T){return a.skipEmptyLines==="greedy"?T.join("").trim()==="":T.length===1&&T[0].length===0}function W(){if(w&&g&&(re("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+o.DefaultDelimiter+"'"),g=!1),a.skipEmptyLines&&(w.data=w.data.filter(function(_){return!J(_)})),Z()){let _=function(U,G){P(a.transformHeader)&&(U=a.transformHeader(U,G)),A.push(U)};if(w)if(Array.isArray(w.data[0])){for(var T=0;Z()&&T<w.data.length;T++)w.data[T].forEach(_);w.data.splice(0,1)}else w.data.forEach(_)}function N(_,U){for(var G=a.header?{}:[],M=0;M<_.length;M++){var R=M,D=_[M],D=((de,O)=>(F=>(a.dynamicTypingFunction&&a.dynamicTyping[F]===void 0&&(a.dynamicTyping[F]=a.dynamicTypingFunction(F)),(a.dynamicTyping[F]||a.dynamicTyping)===!0))(de)?O==="true"||O==="TRUE"||O!=="false"&&O!=="FALSE"&&((F=>{if(se.test(F)&&(F=parseFloat(F),V<F&&F<C))return 1})(O)?parseFloat(O):k.test(O)?new Date(O):O===""?null:O):O)(R=a.header?M>=A.length?"__parsed_extra":A[M]:R,D=a.transform?a.transform(D,R):D);R==="__parsed_extra"?(G[R]=G[R]||[],G[R].push(D)):G[R]=D}return a.header&&(M>A.length?re("FieldMismatch","TooManyFields","Too many fields: expected "+A.length+" fields but parsed "+M,y+U):M<A.length&&re("FieldMismatch","TooFewFields","Too few fields: expected "+A.length+" fields but parsed "+M,y+U)),G}var j;w&&(a.header||a.dynamicTyping||a.transform)&&(j=1,!w.data.length||Array.isArray(w.data[0])?(w.data=w.data.map(N),j=w.data.length):w.data=N(w.data,0),a.header&&w.meta&&(w.meta.fields=A),y+=j)}function Z(){return a.header&&A.length===0}function re(T,N,j,_){T={type:T,code:N,message:j},_!==void 0&&(T.row=_),w.errors.push(T)}P(a.step)&&(f=a.step,a.step=function(T){w=T,Z()?W():(W(),w.data.length!==0&&(H+=T.data.length,a.preview&&H>a.preview?u.abort():(w.data=w.data[0],f(w,v))))}),this.parse=function(T,N,j){var _=a.quoteChar||'"',_=(a.newline||(a.newline=this.guessLineEndings(T,_)),g=!1,a.delimiter?P(a.delimiter)&&(a.delimiter=a.delimiter(T),w.meta.delimiter=a.delimiter):((_=((U,G,M,R,D)=>{var de,O,F,we;D=D||[",","	","|",";",o.RECORD_SEP,o.UNIT_SEP];for(var Le=0;Le<D.length;Le++){for(var pe,Te=D[Le],te=0,fe=0,Q=0,ie=(F=void 0,new K({comments:R,delimiter:Te,newline:G,preview:10}).parse(U)),ve=0;ve<ie.data.length;ve++)M&&J(ie.data[ve])?Q++:(pe=ie.data[ve].length,fe+=pe,F===void 0?F=pe:0<pe&&(te+=Math.abs(pe-F),F=pe));0<ie.data.length&&(fe/=ie.data.length-Q),(O===void 0||te<=O)&&(we===void 0||we<fe)&&1.99<fe&&(O=te,de=Te,we=fe)}return{successful:!!(a.delimiter=de),bestDelimiter:de}})(T,a.newline,a.skipEmptyLines,a.comments,a.delimitersToGuess)).successful?a.delimiter=_.bestDelimiter:(g=!0,a.delimiter=o.DefaultDelimiter),w.meta.delimiter=a.delimiter),Se(a));return a.preview&&a.header&&_.preview++,r=T,u=new K(_),w=u.parse(r,N,j),W(),ee?{meta:{paused:!0}}:w||{meta:{paused:!1}}},this.paused=function(){return ee},this.pause=function(){ee=!0,u.abort(),r=P(a.chunk)?"":r.substring(u.getCharIndex())},this.resume=function(){v.streamer._halted?(ee=!1,v.streamer.parseChunk(r,!0)):setTimeout(v.resume,3)},this.aborted=function(){return L},this.abort=function(){L=!0,u.abort(),w.meta.aborted=!0,P(a.complete)&&a.complete(w),r=""},this.guessLineEndings=function(U,_){U=U.substring(0,1048576);var _=new RegExp(I(_)+"([^]*?)"+I(_),"gm"),j=(U=U.replace(_,"")).split("\r"),_=U.split(`
`),U=1<_.length&&_[0].length<j[0].length;if(j.length===1||U)return`
`;for(var G=0,M=0;M<j.length;M++)j[M][0]===`
`&&G++;return G>=j.length/2?`\r
`:"\r"}}function I(a){return a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function K(a){var r=(a=a||{}).delimiter,u=a.newline,g=a.comments,f=a.step,C=a.preview,V=a.fastMode,se=null,k=!1,v=a.quoteChar==null?'"':a.quoteChar,H=v;if(a.escapeChar!==void 0&&(H=a.escapeChar),(typeof r!="string"||-1<o.BAD_DELIMITERS.indexOf(r))&&(r=","),g===r)throw new Error("Comment character same as delimiter");g===!0?g="#":(typeof g!="string"||-1<o.BAD_DELIMITERS.indexOf(g))&&(g=!1),u!==`
`&&u!=="\r"&&u!==`\r
`&&(u=`
`);var y=0,ee=!1;this.parse=function(L,A,w){if(typeof L!="string")throw new Error("Input must be a string");var J=L.length,W=r.length,Z=u.length,re=g.length,T=P(f),N=[],j=[],_=[],U=y=0;if(!L)return te();if(V||V!==!1&&L.indexOf(v)===-1){for(var G=L.split(u),M=0;M<G.length;M++){if(_=G[M],y+=_.length,M!==G.length-1)y+=u.length;else if(w)return te();if(!g||_.substring(0,re)!==g){if(T){if(N=[],we(_.split(r)),fe(),ee)return te()}else we(_.split(r));if(C&&C<=M)return N=N.slice(0,C),te(!0)}}return te()}for(var R=L.indexOf(r,y),D=L.indexOf(u,y),de=new RegExp(I(H)+I(v),"g"),O=L.indexOf(v,y);;)if(L[y]===v)for(O=y,y++;;){if((O=L.indexOf(v,O+1))===-1)return w||j.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:N.length,index:y}),pe();if(O===J-1)return pe(L.substring(y,O).replace(de,v));if(v===H&&L[O+1]===H)O++;else if(v===H||O===0||L[O-1]!==H){R!==-1&&R<O+1&&(R=L.indexOf(r,O+1));var F=Le((D=D!==-1&&D<O+1?L.indexOf(u,O+1):D)===-1?R:Math.min(R,D));if(L.substr(O+1+F,W)===r){_.push(L.substring(y,O).replace(de,v)),L[y=O+1+F+W]!==v&&(O=L.indexOf(v,y)),R=L.indexOf(r,y),D=L.indexOf(u,y);break}if(F=Le(D),L.substring(O+1+F,O+1+F+Z)===u){if(_.push(L.substring(y,O).replace(de,v)),Te(O+1+F+Z),R=L.indexOf(r,y),O=L.indexOf(v,y),T&&(fe(),ee))return te();if(C&&N.length>=C)return te(!0);break}j.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:N.length,index:y}),O++}}else if(g&&_.length===0&&L.substring(y,y+re)===g){if(D===-1)return te();y=D+Z,D=L.indexOf(u,y),R=L.indexOf(r,y)}else if(R!==-1&&(R<D||D===-1))_.push(L.substring(y,R)),y=R+W,R=L.indexOf(r,y);else{if(D===-1)break;if(_.push(L.substring(y,D)),Te(D+Z),T&&(fe(),ee))return te();if(C&&N.length>=C)return te(!0)}return pe();function we(Q){N.push(Q),U=y}function Le(Q){var ie=0;return ie=Q!==-1&&(Q=L.substring(O+1,Q))&&Q.trim()===""?Q.length:ie}function pe(Q){return w||(Q===void 0&&(Q=L.substring(y)),_.push(Q),y=J,we(_),T&&fe()),te()}function Te(Q){y=Q,we(_),_=[],D=L.indexOf(u,y)}function te(Q){if(a.header&&!A&&N.length&&!k){var ie=N[0],ve=Object.create(null),ze=new Set(ie);let $e=!1;for(let Oe=0;Oe<ie.length;Oe++){let ge=ie[Oe];if(ve[ge=P(a.transformHeader)?a.transformHeader(ge,Oe):ge]){let De,et=ve[ge];for(;De=ge+"_"+et,et++,ze.has(De););ze.add(De),ie[Oe]=De,ve[ge]++,$e=!0,(se=se===null?{}:se)[De]=ge}else ve[ge]=1,ie[Oe]=ge;ze.add(ge)}$e&&console.warn("Duplicate headers found and renamed."),k=!0}return{data:N,errors:j,meta:{delimiter:r,linebreak:u,aborted:ee,truncated:!!Q,cursor:U+(A||0),renamedHeaders:se}}}function fe(){f(te()),N=[],j=[]}},this.abort=function(){ee=!0},this.getCharIndex=function(){return y}}function B(a){var r=a.data,u=c[r.workerId],g=!1;if(r.error)u.userError(r.error,r.file);else if(r.results&&r.results.data){var f={abort:function(){g=!0,ae(r.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:Ae,resume:Ae};if(P(u.userStep)){for(var C=0;C<r.results.data.length&&(u.userStep({data:r.results.data[C],errors:r.results.errors,meta:r.results.meta},f),!g);C++);delete r.results}else P(u.userChunk)&&(u.userChunk(r.results,f,r.file),delete r.results)}r.finished&&!g&&ae(r.workerId,r.results)}function ae(a,r){var u=c[a];P(u.userComplete)&&u.userComplete(r),u.terminate(),delete c[a]}function Ae(){throw new Error("Not implemented.")}function Se(a){if(typeof a!="object"||a===null)return a;var r,u=Array.isArray(a)?[]:{};for(r in a)u[r]=Se(a[r]);return u}function ue(a,r){return function(){a.apply(r,arguments)}}function P(a){return typeof a=="function"}return o.parse=function(a,r){var u=(r=r||{}).dynamicTyping||!1;if(P(u)&&(r.dynamicTypingFunction=u,u={}),r.dynamicTyping=u,r.transform=!!P(r.transform)&&r.transform,!r.worker||!o.WORKERS_SUPPORTED)return u=null,o.NODE_STREAM_INPUT,typeof a=="string"?(a=(g=>g.charCodeAt(0)!==65279?g:g.slice(1))(a),u=new(r.download?m:x)(r)):a.readable===!0&&P(a.read)&&P(a.on)?u=new S(r):(s.File&&a instanceof File||a instanceof Object)&&(u=new b(r)),u.stream(a);(u=(()=>{var g;return!!o.WORKERS_SUPPORTED&&(g=(()=>{var f=s.URL||s.webkitURL||null,C=t.toString();return o.BLOB_URL||(o.BLOB_URL=f.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",C,")();"],{type:"text/javascript"})))})(),(g=new s.Worker(g)).onmessage=B,g.id=h++,c[g.id]=g)})()).userStep=r.step,u.userChunk=r.chunk,u.userComplete=r.complete,u.userError=r.error,r.step=P(r.step),r.chunk=P(r.chunk),r.complete=P(r.complete),r.error=P(r.error),delete r.worker,u.postMessage({input:a,config:r,workerId:u.id})},o.unparse=function(a,r){var u=!1,g=!0,f=",",C=`\r
`,V='"',se=V+V,k=!1,v=null,H=!1,y=((()=>{if(typeof r=="object"){if(typeof r.delimiter!="string"||o.BAD_DELIMITERS.filter(function(A){return r.delimiter.indexOf(A)!==-1}).length||(f=r.delimiter),typeof r.quotes!="boolean"&&typeof r.quotes!="function"&&!Array.isArray(r.quotes)||(u=r.quotes),typeof r.skipEmptyLines!="boolean"&&typeof r.skipEmptyLines!="string"||(k=r.skipEmptyLines),typeof r.newline=="string"&&(C=r.newline),typeof r.quoteChar=="string"&&(V=r.quoteChar),typeof r.header=="boolean"&&(g=r.header),Array.isArray(r.columns)){if(r.columns.length===0)throw new Error("Option columns is empty");v=r.columns}r.escapeChar!==void 0&&(se=r.escapeChar+V),r.escapeFormulae instanceof RegExp?H=r.escapeFormulae:typeof r.escapeFormulae=="boolean"&&r.escapeFormulae&&(H=/^[=+\-@\t\r].*$/)}})(),new RegExp(I(V),"g"));if(typeof a=="string"&&(a=JSON.parse(a)),Array.isArray(a)){if(!a.length||Array.isArray(a[0]))return ee(null,a,k);if(typeof a[0]=="object")return ee(v||Object.keys(a[0]),a,k)}else if(typeof a=="object")return typeof a.data=="string"&&(a.data=JSON.parse(a.data)),Array.isArray(a.data)&&(a.fields||(a.fields=a.meta&&a.meta.fields||v),a.fields||(a.fields=Array.isArray(a.data[0])?a.fields:typeof a.data[0]=="object"?Object.keys(a.data[0]):[]),Array.isArray(a.data[0])||typeof a.data[0]=="object"||(a.data=[a.data])),ee(a.fields||[],a.data||[],k);throw new Error("Unable to serialize unrecognized input");function ee(A,w,J){var W="",Z=(typeof A=="string"&&(A=JSON.parse(A)),typeof w=="string"&&(w=JSON.parse(w)),Array.isArray(A)&&0<A.length),re=!Array.isArray(w[0]);if(Z&&g){for(var T=0;T<A.length;T++)0<T&&(W+=f),W+=L(A[T],T);0<w.length&&(W+=C)}for(var N=0;N<w.length;N++){var j=(Z?A:w[N]).length,_=!1,U=Z?Object.keys(w[N]).length===0:w[N].length===0;if(J&&!Z&&(_=J==="greedy"?w[N].join("").trim()==="":w[N].length===1&&w[N][0].length===0),J==="greedy"&&Z){for(var G=[],M=0;M<j;M++){var R=re?A[M]:M;G.push(w[N][R])}_=G.join("").trim()===""}if(!_){for(var D=0;D<j;D++){0<D&&!U&&(W+=f);var de=Z&&re?A[D]:D;W+=L(w[N][de],D)}N<w.length-1&&(!J||0<j&&!U)&&(W+=C)}}return W}function L(A,w){var J,W;return A==null?"":A.constructor===Date?JSON.stringify(A).slice(1,25):(W=!1,H&&typeof A=="string"&&H.test(A)&&(A="'"+A,W=!0),J=A.toString().replace(y,se),(W=W||u===!0||typeof u=="function"&&u(A,w)||Array.isArray(u)&&u[w]||((Z,re)=>{for(var T=0;T<re.length;T++)if(-1<Z.indexOf(re[T]))return!0;return!1})(J,o.BAD_DELIMITERS)||-1<J.indexOf(f)||J.charAt(0)===" "||J.charAt(J.length-1)===" ")?V+J+V:J)}},o.RECORD_SEP="",o.UNIT_SEP="",o.BYTE_ORDER_MARK="\uFEFF",o.BAD_DELIMITERS=["\r",`
`,'"',o.BYTE_ORDER_MARK],o.WORKERS_SUPPORTED=!n&&!!s.Worker,o.NODE_STREAM_INPUT=1,o.LocalChunkSize=10485760,o.RemoteChunkSize=5242880,o.DefaultDelimiter=",",o.Parser=K,o.ParserHandle=z,o.NetworkStreamer=m,o.FileStreamer=b,o.StringStreamer=x,o.ReadableStreamStreamer=S,s.jQuery&&((i=s.jQuery).fn.parse=function(a){var r=a.config||{},u=[];return this.each(function(C){if(!(i(this).prop("tagName").toUpperCase()==="INPUT"&&i(this).attr("type").toLowerCase()==="file"&&s.FileReader)||!this.files||this.files.length===0)return!0;for(var V=0;V<this.files.length;V++)u.push({file:this.files[V],inputElem:this,instanceConfig:i.extend({},r)})}),g(),this;function g(){if(u.length===0)P(a.complete)&&a.complete();else{var C,V,se,k,v=u[0];if(P(a.before)){var H=a.before(v.file,v.inputElem);if(typeof H=="object"){if(H.action==="abort")return C="AbortError",V=v.file,se=v.inputElem,k=H.reason,void(P(a.error)&&a.error({name:C},V,se,k));if(H.action==="skip")return void f();typeof H.config=="object"&&(v.instanceConfig=i.extend(v.instanceConfig,H.config))}else if(H==="skip")return void f()}var y=v.instanceConfig.complete;v.instanceConfig.complete=function(ee){P(y)&&y(ee,v.file,v.inputElem),f()},o.parse(v.file,v.instanceConfig)}}function f(){u.splice(0,1),g()}}),l&&(s.onmessage=function(a){a=a.data,o.WORKER_ID===void 0&&a&&(o.WORKER_ID=a.workerId),typeof a.input=="string"?s.postMessage({workerId:o.WORKER_ID,results:o.parse(a.input,a.config),finished:!0}):(s.File&&a.input instanceof File||a.input instanceof Object)&&(a=o.parse(a.input,a.config))&&s.postMessage({workerId:o.WORKER_ID,results:a,finished:!0})}),(m.prototype=Object.create(p.prototype)).constructor=m,(b.prototype=Object.create(p.prototype)).constructor=b,(x.prototype=Object.create(x.prototype)).constructor=x,(S.prototype=Object.create(p.prototype)).constructor=S,o})})(He)),He.exports}var Ht=Bt();const ht=It(Ht);async function jt(){let d=ke.PUBLIC_TEMPLE_URL+"solutions/list",e=await fetch(d,{cache:"no-store"});if(!e.ok)return alert("could not fetch "+d),[];let t=await e.json();return t.sort((s,i)=>s.name.localeCompare(i.name)),t}async function Ut(d){const e=ke.PUBLIC_TEMPLE_URL+`solutions/get_detail/${d}`;let t=await fetch(e,{cache:"no-store"});if(!t.ok)throw alert("Could not fetch "+e),new Error("Could not fetch "+e);return await t.json()}async function ms(d,e,t,s="",i=0,n=1){const l=new URL(ke.PUBLIC_TEMPLE_URL+"solutions/get_full_ts");l.searchParams.set("solution_name",d),l.searchParams.set("components",e.join(",")),l.searchParams.set("unit_component",s),l.searchParams.set("scenario",t),l.searchParams.set("year",i.toString()),l.searchParams.set("rolling_average_size",n.toString());const c=l.toString();let h=await fetch(c,{cache:"no-store"});if(!h.ok)throw alert("Error when fetching "+c),new Error("Error when fetching "+c);let o=await h.json();const p=Object.fromEntries(Object.entries(o).map(([m,b])=>m=="unit"||b===void 0?null:[m,dt(b)]).filter(m=>m!==null));return{unit:Xe(o.unit||""),components:p}}async function vs(d,e,t,s=""){let i=new URL(ke.PUBLIC_TEMPLE_URL+"solutions/get_total");i.searchParams.set("solution_name",d),i.searchParams.set("components",e.join(",")),i.searchParams.set("scenario",t),i.searchParams.set("unit_component",s);const n=i.toString();let l=await fetch(n,{cache:"no-store"});if(!l.ok)throw alert("Error when fetching "+n),new Error("Error when fetching "+n);let c=await l.json();for(const h in c)h=="unit"||c[h]===void 0||(c[h]=zt(qt(c[h])));return c.unit=Xe(c.unit||""),c}async function bs(d,e,t){let s=await(await fetch(ke.PUBLIC_TEMPLE_URL+`solutions/get_unit/${d}/${e}?scenario=${t}`,{cache:"no-store"})).json();return Xe(s)}async function ws(d,e,t,s,i,n){const l=ke.PUBLIC_TEMPLE_URL+`solutions/get_energy_balance/${d}/${e}/${t}?scenario=${s}&year=${i}&rolling_average_size=${n}`;let c=await fetch(l,{cache:"no-store"});if(!c.ok)throw alert("Could not fetch "+l),new Error("Could not fetch "+l);let h=await c.json(),o=["shed_demand","demand","flow_conversion_input","flow_export","flow_import","flow_storage_charge","flow_storage_discharge","flow_transport_in","flow_transport_out","cost_shed_demand","flow_conversion_output","constraint_nodal_energy_balance"],p={};for(const m of o)h[m]!==void 0&&(p[m]=dt(h[m]));return p}function qt(d){if(d.slice(0,d.indexOf(`
`)).split(",").length==2){let i=d.split(`
`),n="",l="";for(const c of i.slice(1,i.length)){if(c=="")continue;let h=c.split(",");n+=h[0]+",",l+=h[1]+","}d=n.substring(0,n.length-1)+`
`+l.substring(0,l.length-1)}return d.slice(-1)==`
`&&(d=d.slice(0,-1)),ht.parse(d,{delimiter:",",header:!0,newline:`
`})}function dt(d){return d.map(e=>{let{d:t,t:s,...i}=e;const[n,l]=s;let c=0;return t=t.map(h=>c+=h),t=t.map(h=>h*l+n),{index:i,data:t}})}function Xe(d){return d.slice(-1)==`
`&&(d=d.slice(0,d.length-1)),ht.parse(d,{delimiter:",",header:!0,newline:`
`})}function zt(d){return d.data=d.data.filter(e=>Object.keys(e).some(t=>!Number.isNaN(Number(t))&&!Number.isNaN(e[t])&&Math.abs(e[t])>0)),d}let Ge=me(Pe([])),We={},Je=!1;function Vt(){Qe(async()=>{E(Ge).length>0||Je||(Je=!0,ne(Ge,await jt(),!0),Je=!1)})}function rt(){return E(Ge)}async function Kt(d){if(We[d])return We[d];const e=await Ut(d);return e&&(We[d]=e),e}function Wt(d,e,t){return{solution_name:d,scenario_name:e,detail:t.scenarios[e],version:t.version}}function Jt(d){return[...Array(d.system.optimized_years).keys()].map(e=>e*d.system.interval_between_years+d.system.reference_year)}var Gt=he("<!> <!> <!>",1);function ys(d,e){Ue(e,!0),Vt();let t=Y(e,"carriers",31,()=>Pe([])),s=Y(e,"nodes",31,()=>Pe([])),i=Y(e,"years",31,()=>Pe([])),n=Y(e,"selected_solution",15),l=Y(e,"activeFirstLevel",15,""),c=Y(e,"activeSecondLevel",15,""),h=Y(e,"activeScenario",15,""),o=Y(e,"excludeSolutions",19,()=>[]),p=Y(e,"loading",15,!1),m=Y(e,"disabled",3,!0),b=Y(e,"withoutSolution",3,!1),x=Y(e,"urlParamSolution",3,"solution"),S=Y(e,"urlParamScenario",3,"scenario"),z=Ne(()=>St(rt().map(k=>k.name.split(".")[0]))),I=Ne(()=>{if(l()=="")return[];const k=new Set(o().map(v=>v[0]));return rt().filter(v=>v.name.startsWith(l())).map(v=>v.name.split(".")[1]||null).filter(v=>v!==null&&!k.has(v))}),K=me(Pe([])),B=Ne(()=>{const k=new Set(o().filter(v=>v[0]==c()).map(v=>v[1]));return E(K).filter(v=>!k.has(v))}),ae=Ne(()=>E(z).length>0&&E(I).length==0?l()||null:l()&&c()?`${l()}.${c()}`:null),Ae=me(!0),Se=me(!0);Qe(async()=>{if(x()==null||S()==null)return;const k=it(x())?.split(".")||["",""];l(k[0]),c(k[1]),h(it(S())||"")}),be(()=>{E(ae),h(),Ee(ue)}),be(()=>{n(),tt().then(()=>{x()==null||S()==null||n()==null||wt({[x()]:n().solution_name,[S()]:E(B).length>1?n().scenario_name:null})})}),be(()=>{if(!n()){t([]),s([]),i([]);return}t(n().detail.system.set_carriers.slice().sort()),s(n().detail.system.set_nodes.slice().sort()),i(Jt(n().detail))}),be(()=>{l(),Ee(()=>{if(E(Ae)){ne(Ae,!1);return}c(E(I).length===1?E(I)[0]:""),h("")})}),be(()=>{c(),Ee(()=>{if(E(Se)){ne(Se,!1);return}h("")})}),be(()=>{E(I).length===1&&c(E(I)[0])});async function ue(){if(await tt(),E(ae)===null){n(null),ne(K,[],!0);return}if(n()!==null&&n().solution_name===E(ae)&&n().scenario_name===h())return;p(!0);const k=await Kt(E(ae));if(ne(K,Object.keys(k.scenarios),!0),E(B).length==1&&h(E(B)[0]),h()==""||!(h()in k.scenarios)){h(""),n(null),p(!1);return}n(Wt(E(ae),h(),k)),e.solutionSelected?.(n()),p(!1)}function P(){return l()==""?!1:E(I).length>1||E(B).length>1}var a={moreSolutionsExist:P},r=Gt(),u=Fe(r);{var g=k=>{Ke(k,{label:"Solution",get disabled(){return m()},get options(){return E(z)},get value(){return l()},set value(v){l(v)}})};Ie(u,k=>{b()||k(g)})}var f=oe(u,2);{var C=k=>{Ke(k,{label:"Subsolution",get disabled(){return m()},get options(){return E(I)},get value(){return c()},set value(v){c(v)}})};Ie(f,k=>{E(I).length>0&&k(C)})}var V=oe(f,2);{var se=k=>{Ke(k,{label:"Scenario",get disabled(){return m()},get options(){return E(B)},get value(){return h()},set value(v){h(v)}})};Ie(V,k=>{E(K).length>1&&k(se)})}return ce(d,r),qe(a)}var Qt=(d,e)=>{ne(e,!0)},Yt=(d,e)=>{ne(e,!1)},Zt=he('<div class="absolute font-normal -translate-x-1/2 -translate-y-full z-3 border bg-gray-200 dark:bg-gray-800 border-black dark:border-white rounded-lg p-2"> <svg class="absolute -translate-x-1/2 left-1/2" width="20" height="10"><polygon points="0,0 20,0 10,10" class="fill-gray-200 dark:fill-gray-800"></polygon><path d="M0,0 L10,10 L20,0" class="fill-none stroke-black dark:stroke-white"></path></svg></div>'),Xt=he('<button aria-label="Help tooltip"><i class="bi bi-question-circle-fill text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"></i></button> <!>',1);function _s(d,e){Ue(e,!0);let t=me(void 0),s=me(!1),i=me(!1),n=me(0),l=me(0);function c(){if(E(t)){const b=E(t).getBoundingClientRect();ne(n,b.top,!0),ne(l,b.left+b.width/2)}}Qe(()=>{c()});var h=Xt(),o=Fe(h);o.__mouseover=[Qt,s],o.__focusout=[Yt,i],vt(o,b=>ne(t,b),()=>E(t));var p=oe(o,2);{var m=b=>{var x=Zt();let S;var z=X(x),I=oe(z);nt(I,"",{},{bottom:"-10px"}),$(x),ye(K=>{S=nt(x,"",S,K),xe(z,`${e.content??""} `)},[()=>({top:`${E(n)-10}px`,left:`${E(l)}px`})]),ce(b,x)};Ie(p,b=>{(E(s)||E(i))&&b(m)})}st("focus",o,()=>{ne(i,!0),c()}),st("mouseleave",o,()=>{ne(s,!1)}),ce(d,h),qe()}lt(["mouseover","focusout"]);var $t=he("<div><!></div>");function es(d,e){let t=Y(e,"class",3,""),s=Y(e,"noPadding",3,!1);var i=$t(),n=X(i);_e(n,()=>e.children),$(i),ye(()=>ot(i,1,ct(["bg-white dark:bg-gray-800","shadow-lg shadow-black/10 dark:shadow-white/5","rounded-lg","mb-4",!s()&&"p-4",t()]))),ce(d,i)}var ts=he('<h3 class="sr-only"> </h3> <!>',1);function Ss(d,e){var t=ts(),s=Fe(t),i=X(s,!0);$(s);var n=oe(s,2);_e(n,()=>e.children??Ye),ye(()=>xe(i,e.title)),ce(d,t)}const Ce=[["rgb(122, 157, 207)","rgb(8, 64, 126)","rgb(166, 190, 223)","rgb(33, 92, 175)","rgb(211, 222, 239)","rgb(77, 125, 191)"],["rgb(212, 134, 129)","rgb(150, 39, 45)","rgb(226, 174, 171)","rgb(183, 53, 45)","rgb(241, 215, 213)","rgb(197, 93, 87)"],["rgb(102, 175, 192)","rgb(0, 89, 109)","rgb(153, 202, 213)","rgb(0, 120, 148)","rgb(204, 228, 234)","rgb(51, 149, 171)"],["rgb(202, 108, 174)","rgb(140, 10, 89)","rgb(220, 158, 201)","rgb(167, 17, 122)","rgb(239, 208, 227)","rgb(183, 59, 146)"],["rgb(161, 171, 113)","rgb(54, 82, 19)","rgb(192, 199, 161)","rgb(98, 115, 19)","rgb(224, 227, 208)","rgb(129, 143, 66)"],["rgb(187, 164, 113)","rgb(112, 79, 18)","rgb(210, 194, 161)","rgb(142, 103, 19)","rgb(232, 225, 208)","rgb(165, 133, 66)"]];let Me=0,Re=0,je={};function Ls(){Me=0,Re=0,je={}}function Os(d){if(d!==void 0&&je[d]!==void 0)return je[d];Me>=Ce.length&&(Me=0,Re++,Re>=Ce[0].length&&(Re=0));const e=Ce[Me][Re];return Me++,d!==void 0&&(je[d]=e),e}function Es(d,e=.8){return d.replace("rgb","rgba").replace(")",`, ${e})`)}function Cs(){let d=[];for(let e=0;e<Ce.length;e++)for(let t=0;t<Ce[0].length;t++)d.push(Ce[t][e]);return d}var ss=he('<h2 class="font-bold text-lg mb-4">Filters</h2> <div><!></div>',1),is=he('<div class="grid lg:grid-cols-4 grid-rows-[min-content_1fr] grow gap-4 p-4"><div class="flex items-end justify-between"><div><div class="text-sm text-gray-600 dark:text-gray-400 uppercase tracking-wide mb-1"> </div> <h1 class="text-3xl font-bold"> </h1></div></div> <div class="lg:col-span-3 order-3 lg:order-2"><!></div> <div class="order-2 lg:order-3"><!></div> <main class="lg:col-span-3 order-4"><!></main></div>');function xs(d,e){var t=is(),s=X(t),i=X(s),n=X(i),l=X(n,!0);$(n);var c=oe(n,2),h=X(c,!0);$(c),$(i),$(s);var o=oe(s,2),p=X(o);_e(p,()=>e.buttons??Ye),$(o);var m=oe(o,2),b=X(m);es(b,{children:(z,I)=>{var K=ss(),B=oe(Fe(K),2),ae=X(B);_e(ae,()=>e.filters),$(B),ce(z,K)},$$slots:{default:!0}}),$(m);var x=oe(m,2),S=X(x);_e(S,()=>e.mainContent),$(x),$(t),ye(()=>{xe(l,e.parentTitle),xe(h,e.pageTitle)}),ce(d,t)}var ns=(d,e)=>e.onclick?.(),as=he("<button><!></button>");function ks(d,e){Ue(e,!0);let t=Y(e,"class",3,"");var s=as();s.__click=[ns,e];var i=X(s);_e(i,()=>e.children),$(s),ye(()=>ot(s,1,ct(["flex","text-blue-800 dark:text-blue-400","border-2 border-blue-800 dark:border-blue-400 rounded-lg","px-4 py-2",t()]))),ce(d,s),qe()}lt(["click"]);export{ks as B,es as C,xs as D,Ss as F,_s as H,Mt as I,ys as S,bs as a,Ke as b,ms as c,St as d,vs as e,Es as f,ws as g,Ct as h,_t as i,gs as j,Jt as k,It as l,Cs as m,Os as n,Ls as r,fs as t,q as u};
