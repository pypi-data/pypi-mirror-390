import dotenv
from fastmcp import FastMCP

from tencent_cloud_hackathon_intelligent_pentest_competition_api_server.base import GetChallengeHintResponse
from tencent_cloud_hackathon_intelligent_pentest_competition_api_server.base import GetChallengesResponse
from tencent_cloud_hackathon_intelligent_pentest_competition_api_server.base import SubmitAnswerResponse
from tencent_cloud_hackathon_intelligent_pentest_competition_api_server.client_sdk import APIClient
dotenv.load_dotenv()

mcp = FastMCP('Capture The Flag Competition API')

client = APIClient.get_client()


@mcp.tool
def challenges() -> GetChallengesResponse:
    """Get the challenges"""
    return client.get_challenges()


@mcp.tool
def submit_answer(challenge_code: str, answer: str) -> SubmitAnswerResponse:
    """Submit an answer for a challenge, returns True if the answer is correct, False otherwise"""
    return client.submit_answer(challenge_code=challenge_code, answer=answer)


@mcp.tool
def get_hint(challenge_code: str) -> GetChallengeHintResponse:
    """Get a hint for a playground, returns a hint"""
    return client.get_challenge_hint(challenge_code=challenge_code)


if __name__ == '__main__':
    mcp.run()
