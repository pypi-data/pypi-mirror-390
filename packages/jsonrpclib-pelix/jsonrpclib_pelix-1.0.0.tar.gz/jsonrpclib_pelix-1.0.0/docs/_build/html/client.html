

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>JSON-RPC Client usage &mdash; jsonrpclib-pelix 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=92fd9be5" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=8d563738"></script>
      <script src="_static/doctools.js?v=9a2dae69"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Simple JSON-RPC Server" href="server.html" />
    <link rel="prev" title="Installation" href="installation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            jsonrpclib-pelix
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">JSON-RPC Client usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#unix-socket">Unix Socket</a></li>
<li class="toctree-l2"><a class="reference internal" href="#additional-headers">Additional headers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="server.html">Simple JSON-RPC Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="class_translation.html">Class Translation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">jsonrpclib-pelix</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">JSON-RPC Client usage</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/client.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="json-rpc-client-usage">
<h1>JSON-RPC Client usage<a class="headerlink" href="#json-rpc-client-usage" title="Link to this heading"></a></h1>
<p>This is (obviously) taken from a console session.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">jsonrpclib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">server</span> <span class="o">=</span> <span class="n">jsonrpclib</span><span class="o">.</span><span class="n">ServerProxy</span><span class="p">(</span><span class="s1">&#39;http://localhost:8080&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">server</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<span class="go">11</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">server</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="go">15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">server</span><span class="o">.</span><span class="n">_notify</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<span class="go"># No result returned...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span> <span class="o">=</span> <span class="n">jsonrpclib</span><span class="o">.</span><span class="n">MultiCall</span><span class="p">(</span><span class="n">server</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span><span class="o">.</span><span class="n">ping</span><span class="p">({</span><span class="s1">&#39;key&#39;</span><span class="p">:</span><span class="s1">&#39;value&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span><span class="o">.</span><span class="n">_notify</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">batch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">...</span> <span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">11</span>
<span class="go">{&#39;key&#39;: &#39;value&#39;}</span>
<span class="go"># Note that there are only two responses -- this is according to spec.</span>

<span class="go"># Clean up</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">server</span><span class="p">(</span><span class="s1">&#39;close&#39;</span><span class="p">)()</span>

<span class="go"># Using client history</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">history</span> <span class="o">=</span> <span class="n">jsonrpclib</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">History</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">server</span> <span class="o">=</span> <span class="n">jsonrpclib</span><span class="o">.</span><span class="n">ServerProxy</span><span class="p">(</span><span class="s1">&#39;http://localhost:8080&#39;</span><span class="p">,</span> <span class="n">history</span><span class="o">=</span><span class="n">history</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">server</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<span class="go">11</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">request</span><span class="p">)</span>
<span class="go">{&quot;id&quot;: &quot;f682b956-c8e1-4506-9db4-29fe8bc9fcaa&quot;, &quot;jsonrpc&quot;: &quot;2.0&quot;,</span>
<span class="go">&quot;method&quot;: &quot;add&quot;, &quot;params&quot;: [5, 6]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">response</span><span class="p">)</span>
<span class="go">{&quot;id&quot;: &quot;f682b956-c8e1-4506-9db4-29fe8bc9fcaa&quot;, &quot;jsonrpc&quot;: &quot;2.0&quot;,</span>
<span class="go">&quot;result&quot;: 11}</span>

<span class="go"># Clean up</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">server</span><span class="p">(</span><span class="s1">&#39;close&#39;</span><span class="p">)()</span>
</pre></div>
</div>
<p>If you need 1.0 functionality, there are a bunch of places you can pass that in,
although the best is just to give a specific configuration to
<code class="docutils literal notranslate"><span class="pre">jsonrpclib.ServerProxy</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">jsonrpclib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jsonrpclib</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">DEFAULT</span><span class="o">.</span><span class="n">version</span>
<span class="go">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">config</span> <span class="o">=</span> <span class="n">jsonrpclib</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">Config</span><span class="p">(</span><span class="n">version</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">history</span> <span class="o">=</span> <span class="n">jsonrpclib</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">History</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">server</span> <span class="o">=</span> <span class="n">jsonrpclib</span><span class="o">.</span><span class="n">ServerProxy</span><span class="p">(</span><span class="s1">&#39;http://localhost:8080&#39;</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
<span class="go">                                    history=history)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">server</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="go">17</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">request</span><span class="p">)</span>
<span class="go">{&quot;id&quot;: &quot;827b2923-5b37-49a5-8b36-e73920a16d32&quot;,</span>
<span class="go"> &quot;method&quot;: &quot;add&quot;, &quot;params&quot;: [7, 10]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">response</span><span class="p">)</span>
<span class="go">{&quot;id&quot;: &quot;827b2923-5b37-49a5-8b36-e73920a16d32&quot;, &quot;error&quot;: null, &quot;result&quot;: 17}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">server</span><span class="p">(</span><span class="s1">&#39;close&#39;</span><span class="p">)()</span>
</pre></div>
</div>
<p>The equivalent <code class="docutils literal notranslate"><span class="pre">loads</span></code> and <code class="docutils literal notranslate"><span class="pre">dumps</span></code> functions also exist, although with minor
modifications. The <code class="docutils literal notranslate"><span class="pre">dumps</span></code> arguments are almost identical, but it adds three
arguments: <code class="docutils literal notranslate"><span class="pre">rpcid</span></code> for the ‘id’ key, <code class="docutils literal notranslate"><span class="pre">version</span></code> to specify the JSON-RPC
compatibility, and <code class="docutils literal notranslate"><span class="pre">notify</span></code> if it’s a request that you want to be a
notification.</p>
<p>Additionally, the <code class="docutils literal notranslate"><span class="pre">loads</span></code> method does not return the params and method like
<code class="docutils literal notranslate"><span class="pre">xmlrpclib</span></code>, but instead:</p>
<ol class="arabic simple">
<li><p>parses for errors, raising <code class="docutils literal notranslate"><span class="pre">ProtocolError</span></code>s, and</p></li>
<li><p>returns the entire structure of the request / response for manual parsing.</p></li>
</ol>
<section id="unix-socket">
<h2>Unix Socket<a class="headerlink" href="#unix-socket" title="Link to this heading"></a></h2>
<p>To connect a JSON-RPC server over a Unix socket, you have to use a specific
protocol: <code class="docutils literal notranslate"><span class="pre">unix+http</span></code>.</p>
<p>When connecting to a Unix socket in the current working directory, you can use
the following syntax: <code class="docutils literal notranslate"><span class="pre">unix+http://my.socket</span></code></p>
<p>When you need to give an absolute path you must use the path part of the URL,
the host part will be ignored. For example, you can use this URL to indicate a
Unix socket in <code class="docutils literal notranslate"><span class="pre">/var/lib/daemon.socket</span></code>:
<code class="docutils literal notranslate"><span class="pre">unix+http://./var/lib/daemon.socket</span></code></p>
<p><strong>Note:</strong> Currently, only HTTP is supported over a Unix socket.
If you want HTTPS support to be implemented, please create an
<a class="reference external" href="https://github.com/tcalmant/jsonrpclib/issues">issue on GitHub</a>.</p>
</section>
<section id="additional-headers">
<h2>Additional headers<a class="headerlink" href="#additional-headers" title="Link to this heading"></a></h2>
<p>If your remote service requires custom headers in request, you can pass them
as a <code class="docutils literal notranslate"><span class="pre">headers</span></code> keyword argument, when creating the <code class="docutils literal notranslate"><span class="pre">ServerProxy</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">jsonrpclib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">server</span> <span class="o">=</span> <span class="n">jsonrpclib</span><span class="o">.</span><span class="n">ServerProxy</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s2">&quot;http://localhost:8080&quot;</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;X-Test&#39;</span> <span class="p">:</span> <span class="s1">&#39;Test&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>You can also put additional request headers only for certain method invocation:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">jsonrpclib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">server</span> <span class="o">=</span> <span class="n">jsonrpclib</span><span class="o">.</span><span class="n">ServerProxy</span><span class="p">(</span><span class="s2">&quot;http://localhost:8080&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">server</span><span class="o">.</span><span class="n">_additional_headers</span><span class="p">({</span><span class="s1">&#39;X-Test&#39;</span> <span class="p">:</span> <span class="s1">&#39;Test&#39;</span><span class="p">})</span> <span class="k">as</span> <span class="n">test_server</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">test_server</span><span class="o">.</span><span class="n">ping</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># X-Test header will be no longer sent in requests</span>
</pre></div>
</div>
<p>Of course <code class="docutils literal notranslate"><span class="pre">_additional_headers</span></code> contexts can be nested as well.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="installation.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="server.html" class="btn btn-neutral float-right" title="Simple JSON-RPC Server" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Thomas Calmant.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>