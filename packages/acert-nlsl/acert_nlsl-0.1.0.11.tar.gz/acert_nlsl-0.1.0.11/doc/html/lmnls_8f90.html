<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>NLSL: lmnls.f90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">NLSL
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('lmnls_8f90.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">lmnls.f90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a href="lmnls_8f90_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a3824341b48a4f0f2246536a6922c8d38"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmnls_8f90.html#a3824341b48a4f0f2246536a6922c8d38">lmnls</a> (fcn, m, n, x, fvec, fjac, ldfjac, ftol, xtol, gtol, maxfev, maxitr, diag, scale, <a class="el" href="genio_8c.html#a2d7e5dd7a479c4c7aef6e6133a1441c5">factor</a>, nprint, <a class="el" href="genio_8c.html#a11ec0d8744d11b1caaf0c5747b30720b">info</a>, nfev, njev, ipvt, qtf, gnvec, gradf, wa1, wa2, wa3, wa4)</td></tr>
<tr class="memdesc:a3824341b48a4f0f2246536a6922c8d38"><td class="mdescLeft">&#160;</td><td class="mdescRight"><h1>(L)evenberg-(M)arquardt (N)onlinear (L)east (S)quares </h1>
This is a modification of the original lmder subroutine from the MINPACK subroutine library. It uses a Levenberg-Marquardt nonlinear least-squares algorithm modified to carry out a local optimization constrained to lie within a "trust region" defined by a step bound delta using scaling of the variables.  <a href="#a3824341b48a4f0f2246536a6922c8d38">More...</a><br /></td></tr>
<tr class="separator:a3824341b48a4f0f2246536a6922c8d38"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a class="anchor" id="a3824341b48a4f0f2246536a6922c8d38"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine lmnls </td>
          <td>(</td>
          <td class="paramtype">external&#160;</td>
          <td class="paramname"><em>fcn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(n)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(m)&#160;</td>
          <td class="paramname"><em>fvec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ldfjac,njcol)&#160;</td>
          <td class="paramname"><em>fjac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>ldfjac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>ftol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>xtol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>gtol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>maxfev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>maxitr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(njcol)&#160;</td>
          <td class="paramname"><em>diag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(njcol)&#160;</td>
          <td class="paramname"><em>scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>factor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>nprint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>nfev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>njev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(n)&#160;</td>
          <td class="paramname"><em>ipvt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(njcol)&#160;</td>
          <td class="paramname"><em>qtf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(njcol)&#160;</td>
          <td class="paramname"><em>gnvec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(njcol)&#160;</td>
          <td class="paramname"><em>gradf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(njcol)&#160;</td>
          <td class="paramname"><em>wa1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(njcol)&#160;</td>
          <td class="paramname"><em>wa2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(njcol)&#160;</td>
          <td class="paramname"><em>wa3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(m)&#160;</td>
          <td class="paramname"><em>wa4</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h1>(L)evenberg-(M)arquardt (N)onlinear (L)east (S)quares </h1>
This is a modification of the original lmder subroutine from the MINPACK subroutine library. It uses a Levenberg-Marquardt nonlinear least-squares algorithm modified to carry out a local optimization constrained to lie within a "trust region" defined by a step bound delta using scaling of the variables. </p>
<p>For a description of the trust region approach for least squares problems, see J.E. Dennis and R.B. Schnabel, Numerical Methods for Unconstrained Optimization and Nonlinear Equations, Prentice-Hall, Englewood Cliffs, NJ (1983), sections 6.4, 7.1, and 10.2. </p>
<pre class="fragment">The purpose of LMDER is to minimize the sum of the squares of
m nonlinear functions in n variables by a modification of
the Levenberg-Marquardt algorithm. The user must provide a
subroutine which calculates the functions and the Jacobian.

The subroutine statement is

  subroutine lmnls(fcn,m,n,x,fvec,fjac,ldfjac,ftol,xtol,gtol,
                   maxfev,maxitr,diag,scale,factor,nprint,info,
                   nfev,njev,ipvt,qtf,wa1,wa2,wa3,wa4) </pre><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">FCN</td><td>is the name of the user-supplied subroutine which calculates the functions and the Jacobian. FCN must be declared in an external statement in the user calling program, and should be written as follows: <blockquote class="doxtable">
<pre class="fragment"> subroutine fcn(m,n,x,fvec,fjac,ldfjac,iflag)
 integer m,n,ldfjac,iflag
 double precision x(n),fvec(m),fjac(ldfjac,n)
 ----------
 If iflag=1 calculate the functions at x and
 return this vector in fvec. Do not alter fjac.
 If iflag=2 calculate the Jacobian at x and
 return this matrix in fjac. Do not alter fvec.
 ----------
 return
 end
</pre><p></p>
</blockquote>
The value of IFLAG should not be changed by FCN unless the user wants to terminate execution of LMDER. In this case set iflag to a negative integer.</td></tr>
    <tr><td class="paramname">M</td><td>is a positive integer input variable set to the number of functions.</td></tr>
    <tr><td class="paramname">N</td><td>is a positive integer input variable set to the number of variables. N must not exceed M.</td></tr>
    <tr><td class="paramname">X</td><td>is an array of length N. On input X must contain an initial estimate of the solution vector. On output X contains the final estimate of the solution vector.</td></tr>
    <tr><td class="paramname">FVEC</td><td>is an output array of length M which contains the functions evaluated at the output X.</td></tr>
    <tr><td class="paramname">FJAC</td><td>is an output M by N array. the upper N by N submatrix of FJAC contains an upper triangular matrix R with diagonal elements of nonincreasing magnitude such that <blockquote class="doxtable">
<pre class="fragment">        T     T           T
       P *(JAC *JAC)*P = R *R,
</pre><p></p>
</blockquote>
where P is a permutation matrix and JAC is the final calculated Jacobian. column j of P is column IPVT(j) (see below) of the identity matrix. The lower trapezoidal part of FJAC contains information generated during the computation of R.</td></tr>
    <tr><td class="paramname">LDFJAC</td><td>is a positive integer input variable not less than M which specifies the leading dimension of the array FJAC.</td></tr>
    <tr><td class="paramname">FTOL</td><td>is a nonnegative input variable. Termination occurs when both the actual and predicted relative reductions in the sum of squares are at most FTOL. Therefore, FTOL measures the relative error desired in the sum of squares.</td></tr>
    <tr><td class="paramname">XTOL</td><td>is a nonnegative input variable. Termination occurs when the relative error between two consecutive iterates is at most XTOL. Therefore, XTOL measures the relative error desired in the approximate solution.</td></tr>
    <tr><td class="paramname">GTOL</td><td>is a nonnegative input variable. Termination occurs when the cosine of the angle between FVEC and any column of the Jacobian is at most GTOL in absolute value. therefore, GTOL measures the orthogonality desired between the function vector and the columns of the Jacobian.</td></tr>
    <tr><td class="paramname">MAXFEV</td><td>is a positive integer input variable. Termination occurs when the number of calls to FCN with IFLAG=1 has reached MAXFEV.</td></tr>
    <tr><td class="paramname">SCALE</td><td>is an array of length N containing multiplicative scale factors for each of the variables in X. If an element of SCALE is non-positive, it will be reset internally to unity. Positive entries in the SCALE array will be retained as user-specified scaling factors for the trust-region search of the algorithm. The step for the Ith parameter will be scaled using the norm of the Ith column of the Jacobian <em>divided</em> by SCALE(I). This produces larger steps along the ith dimension, at least initialy. The default value for all parameters is unity (i.e., the column norms of the Jacobian will be used). <blockquote class="doxtable">
<p>NB: This convention differs from the original specifications of LMDER in MINPACK. </p>
</blockquote>
</td></tr>
    <tr><td class="paramname">FACTOR</td><td>is a positive input variable used in determining the initial trust region bound. This bound is set to the product of FACTOR and the Euclidean norm of DIAG*X if nonzero, or else to FACTOR itself. In most cases FACTOR should lie in the interval (.1,100.). 100 is a generally recommended value.</td></tr>
    <tr><td class="paramname">NPRINT</td><td>is an integer input variable that enables controlled printing of iterates if it is positive. In this case, fcn is called with IFLAG=0 at the beginning of the first iteration and every NPRINT iterations thereafter and immediately prior to return, with X, FVEC, and FJAC available for printing. FVEC and FJAC should not be altered. If NPRINT is not positive, no special calls of FCN with IFLAG=0 are made.</td></tr>
    <tr><td class="paramname">INFO</td><td><p class="starttd">is an integer output variable. If the user has terminated execution, INFFO is set to the (negative) value of IFLAG. See description of FCN. Otherwise, INFO is set as follows:</p>
<p>INFO=0 Improper input parameters.</p>
<p>INFO=1 Both actual and predicted relative reductions in the sum of squares are at most FTOL.</p>
<p>INFO=2 Relative error between two consecutive iterates is at most XTOL.</p>
<p>INFO=3 conditions for INFO=1 and INFO=2 both hold.</p>
<p>INFO=4 The cosine of the angle between FVEC and any column of the Jacobian is at most GTOL in absolute value.</p>
<p>INFO=5 number of calls to FCN with IFLAG=1 has reached MAXFEV.</p>
<p>INFO=6 FTOL is too small. No further reduction in the sum of squares is possible.</p>
<p>INFO=7 XTOL is too small. No further improvement in the approximate solution X is possible.</p>
<p class="endtd">INFO=8 GTOL is too small. FVEC is orthogonal to the columns of the Jacobian to machine precision. </p>
</td></tr>
    <tr><td class="paramname">NFEV</td><td>is an integer output variable set to the number of calls to FCN with IFLAG=1.</td></tr>
    <tr><td class="paramname">NJEV</td><td>is an integer output variable set to the number of calls to NJEV with IFLAG=2.</td></tr>
    <tr><td class="paramname">IPVT</td><td>is an integer output array of length N. IPVT defines a permutation matrix p such that JAC*P=Q*R, where JAC is the final calculated Jacobian, Q is orthogonal (not stored), and R is upper triangular with diagonal elements of nonincreasing magnitude. column j of P is column IPVT(j) of the identity matrix.</td></tr>
    <tr><td class="paramname">QTF</td><td>is an output array of length N which contains the first N elements of the vector (Q transpose)*FVEC.</td></tr>
    <tr><td class="paramname">WA1,WA2,and</td><td>WA3 are work arrays of length N.</td></tr>
    <tr><td class="paramname">WA4</td><td>is a work array of length M. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="lmnls_8f90_source.html#l00023">23</a> of file <a class="el" href="lmnls_8f90_source.html">lmnls.f90</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="lmnls_8f90_a3824341b48a4f0f2246536a6922c8d38_cgraph.png" border="0" usemap="#lmnls_8f90_a3824341b48a4f0f2246536a6922c8d38_cgraph" alt=""/></div>
<map name="lmnls_8f90_a3824341b48a4f0f2246536a6922c8d38_cgraph" id="lmnls_8f90_a3824341b48a4f0f2246536a6922c8d38_cgraph">
<area shape="rect" id="node2" href="qrfac_8f90.html#ae3d81a1f6eac605eeb9f19ac00441bf3" title="qrfac" alt="" coords="109,5,159,32"/><area shape="rect" id="node3" href="lmpar_8f90.html#a8d29e34847b75ce1c58a66d2ee9c236b" title="lmpar" alt="" coords="107,56,161,83"/><area shape="rect" id="node4" href="qrsolv_8f90.html#af52d36aab2d7c49d7a972f76fef2e60e" title="qrsolv" alt="" coords="209,56,264,83"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="lmnls_8f90_a3824341b48a4f0f2246536a6922c8d38_icgraph.png" border="0" usemap="#lmnls_8f90_a3824341b48a4f0f2246536a6922c8d38_icgraph" alt=""/></div>
<map name="lmnls_8f90_a3824341b48a4f0f2246536a6922c8d38_icgraph" id="lmnls_8f90_a3824341b48a4f0f2246536a6922c8d38_icgraph">
<area shape="rect" id="node2" href="fitl_8f90.html#a118157010a06f371982aa8f4776e4cbf" title="fitl" alt="" coords="107,5,145,32"/><area shape="rect" id="node3" href="fitc_8f90.html#ae805998691f59fca2d33023f207e8b7d" title="fitc" alt="" coords="193,5,232,32"/><area shape="rect" id="node4" href="nlsl_8f90.html#a89bfe89320539cc08d8701d4f2a028a6" title="nlsl" alt="" coords="280,5,323,32"/></map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="lmnls_8f90.html">lmnls.f90</a></li>
    <li class="footer">Generated on Wed Jun 3 2015 12:50:25 for NLSL by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.9.1 </li>
  </ul>
</div>
</body>
</html>
