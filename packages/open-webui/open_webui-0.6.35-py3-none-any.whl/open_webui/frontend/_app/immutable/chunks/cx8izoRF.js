import"./CWj6FrbW.js";import"./CN51-NxK.js";import{t as D,a as c,B as vt,b as Ke,g as Qe,e as ve,j as e,d as qe,k as C,u as p,w as l,c as m,r as u,s as q,p as Xe,f as _,n as J,z as Ue,i as M,l as re,m as ce,y as yt,o as bt,q as Te,v as kt,x as nt,A as Mt}from"./CvTLsZlf.js";import{i as j}from"./B3D73U8p.js";import{e as Fe,i as Ze}from"./uF71e8HK.js";import{s as ut}from"./D4SMs5q_.js";import{a as Q,s as we,c as mt,r as Ct}from"./CPzR4-ix.js";import{b as Pt}from"./BpTtYi1u.js";import{b as Ot}from"./Cz9Z7v2M.js";import{i as et}from"./CNVL70pO.js";import{p as H}from"./DBxQAEQJ.js";import{a as ge,s as tt}from"./DzS5ldT-.js";import"./CXLK5pxB.js";import{M as ft,a as pt,b as gt,c as st}from"./DM-96xXi.js";import{i as Nt,m as it,z as dt,y as zt}from"./D38tgtmh.js";import{F as Lt}from"./CU2r43ac.js";import{d as Je,r as St}from"./BqAeIAOr.js";import"./BSaLyK_V.js";import{S as Dt}from"./DD1zKOTk.js";import{f as _t}from"./BjO3HhBo.js";import"./BDMvu-7n.js";import{u as Ht,p as Et,g as At,d as It}from"./C6k4SlnJ.js";import{d as ht,g as ct,u as xt,b as Ye,M as He,c as Tt,m as Vt}from"./D6EOiKH3.js";import{t as le}from"./Cqe-NRGo.js";import{g as Ge}from"./U3_qXm6Y.js";import{C as jt}from"./BzIph71e.js";import{S as Wt}from"./B0jU0TkR.js";import{T as X}from"./k6hQMChD.js";import{k as Bt}from"./BOeiEyRi.js";import{C as Ft}from"./I-fSXNXS.js";import{L as Zt}from"./8hQqhvif.js";import{E as qt}from"./DJ3SF0kt.js";import{E as Ut}from"./DVo29qNV.js";import{E as Rt}from"./DEA4EnEJ.js";var Yt=vt('<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5"></path></svg>');function Gt(_e,h){let n=H(h,"className",8,"size-4"),v=H(h,"strokeWidth",8,"1.5");var U=Yt();D(()=>{Q(U,"stroke-width",v()),we(U,0,mt(n()))}),c(_e,U)}var Jt=_('<!> <div class="flex items-center"><!></div>',1),Kt=_('<!> <div class="flex items-center"> </div>',1),Qt=_("<!> <!>",1),Xt=_("<!> <!>",1);function er(_e,h){Ke(h,!1);const n=()=>ge(ze,"$i18n",U),v=()=>ge(ht,"$settings",U),[U,ne]=tt(),ze=Qe("i18n");let ue=H(h,"show",12,!1),t=H(h,"model",8),Le=H(h,"pinModelHandler",8,()=>{}),se=H(h,"copyLinkHandler",8,()=>{}),Ee=H(h,"onClose",8,()=>{});et(),ft(_e,{closeFocus:!1,onOpenChange:he=>{he===!1&&Ee()()},typeahead:!1,get open(){return ue()},set open(he){ue(he)},children:(he,xe)=>{var ke=Xt(),$e=ve(ke);pt($e,{children:(w,Se)=>{{let me=J(()=>(n(),l(()=>n().t("More")))),ye=J(()=>(v(),l(()=>{var ee;return((ee=v())==null?void 0:ee.highContrastMode)??!1?"":"group-hover/item:opacity-100 opacity-0"})));X(w,{get content(){return e(me)},get className(){return e(ye)},children:(ee,Y)=>{var A=qe(),W=ve(A);ut(W,h,"default",{},null),c(ee,A)},$$slots:{default:!0}})}},$$slots:{default:!0}});var ae=C($e,2);gt(ae,{strategy:"fixed",class:"w-full max-w-[180px] text-sm rounded-2xl p-1 z-[9999999] bg-white dark:bg-gray-850 dark:text-white shadow-lg border border-gray-100  dark:border-gray-800",sideOffset:-2,side:"bottom",align:"end",get transition(){return _t},children:(w,Se)=>{var me=Qt(),ye=ve(me);{let Y=J(()=>(v(),p(t()),l(()=>{var A,W;return(((A=v())==null?void 0:A.pinnedModels)??[]).includes((W=t())==null?void 0:W.id)})));st(ye,{type:"button",get"aria-pressed"(){return e(Y)},class:"flex rounded-xl py-1.5 px-3 w-full hover:bg-gray-50 dark:hover:bg-gray-800 transition items-center gap-2",$$events:{click:A=>{var W;A.stopPropagation(),A.preventDefault(),Le()((W=t())==null?void 0:W.id),ue(!1)}},children:(A,W)=>{var I=Jt(),O=ve(I);{var y=F=>{Ut(F,{})},fe=F=>{qt(F,{})};j(O,F=>{v(),p(t()),l(()=>{var G,te;return(((G=v())==null?void 0:G.pinnedModels)??[]).includes((te=t())==null?void 0:te.id)})?F(y):F(fe,!1)})}var K=C(O,2),Me=m(K);{var Ae=F=>{var G=Ue();D(te=>q(G,te),[()=>(n(),l(()=>n().t("Hide from Sidebar")))]),c(F,G)},Ce=F=>{var G=Ue();D(te=>q(G,te),[()=>(n(),l(()=>n().t("Keep in Sidebar")))]),c(F,G)};j(Me,F=>{v(),p(t()),l(()=>{var G,te;return(((G=v())==null?void 0:G.pinnedModels)??[]).includes((te=t())==null?void 0:te.id)})?F(Ae):F(Ce,!1)})}u(K),c(A,I)},$$slots:{default:!0}})}var ee=C(ye,2);st(ee,{type:"button",class:"flex rounded-xl py-1.5 px-3 w-full hover:bg-gray-50 dark:hover:bg-gray-800 transition items-center gap-2",$$events:{click:Y=>{Y.stopPropagation(),Y.preventDefault(),se()(),ue(!1)}},children:(Y,A)=>{var W=Kt(),I=ve(W);Zt(I,{});var O=C(I,2),y=m(O,!0);u(O),D(fe=>q(y,fe),[()=>(n(),l(()=>n().t("Copy Link")))]),c(Y,W)},$$slots:{default:!0}}),c(w,me)},$$slots:{default:!0}}),c(he,ke)},$$slots:{default:!0},$$legacy:!0}),Xe(),ne()}var tr=vt('<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path d="M4 12 L8 7 H21 V17 H8 L4 12 Z" stroke="currentColor" fill="none"></path><circle cx="10" cy="12" r="0.75" fill="currentColor" stroke="currentColor"></circle></svg>');function rr(_e,h){let n=H(h,"className",8,"size-4"),v=H(h,"strokeWidth",8,"1.8");var U=tr();D(()=>{Q(U,"stroke-width",v()),we(U,0,mt(n()))}),c(_e,U)}var ar=_('<img alt="Model" class="rounded-full size-5 flex items-center"/>'),or=_('<div class="line-clamp-1"> </div>'),lr=_('<span class=" text-xs font-medium text-gray-600 dark:text-gray-400 line-clamp-1"> </span>'),nr=_('<div class="flex items-center translate-y-[0.5px]"><!></div>'),sr=_('<div class=" flex items-center"><span class="relative flex size-2"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"></span> <span class="relative inline-flex rounded-full size-2 bg-green-500"></span></span></div>'),ir=_('<div class="flex items-center translate-y-[0.5px] px-0.5"><!></div>'),dr=_("<!> <!>",1),cr=_('<div class="translate-y-[1px]"><!></div>'),vr=_('<div class=" text-xs font-medium rounded-sm uppercase text-white"> </div>'),ur=_('<div slot="tooltip"></div>'),mr=_('<div class="translate-y-[1px]"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-3"><path fill-rule="evenodd" d="M2 2.75A.75.75 0 0 1 2.75 2C8.963 2 14 7.037 14 13.25a.75.75 0 0 1-1.5 0c0-5.385-4.365-9.75-9.75-9.75A.75.75 0 0 1 2 2.75Zm0 4.5a.75.75 0 0 1 .75-.75 6.75 6.75 0 0 1 6.75 6.75.75.75 0 0 1-1.5 0C8 10.35 5.65 8 2.75 8A.75.75 0 0 1 2 7.25ZM3.5 11a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3Z" clip-rule="evenodd"></path></svg></div>'),fr=_('<div class="translate-y-[1px]"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-3"><path fill-rule="evenodd" d="M8.914 6.025a.75.75 0 0 1 1.06 0 3.5 3.5 0 0 1 0 4.95l-2 2a3.5 3.5 0 0 1-5.396-4.402.75.75 0 0 1 1.251.827 2 2 0 0 0 3.085 2.514l2-2a2 2 0 0 0 0-2.828.75.75 0 0 1 0-1.06Z" clip-rule="evenodd"></path><path fill-rule="evenodd" d="M7.086 9.975a.75.75 0 0 1-1.06 0 3.5 3.5 0 0 1 0-4.95l2-2a3.5 3.5 0 0 1 5.396 4.402.75.75 0 0 1-1.251-.827 2 2 0 0 0-3.085-2.514l-2 2a2 2 0 0 0 0 2.828.75.75 0 0 1 0 1.06Z" clip-rule="evenodd"></path></svg></div>'),pr=_('<div class=" translate-y-[1px]"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg></div>'),gr=_('<button class="flex"><!></button>'),_r=_('<button class="flex"><!></button>'),hr=_("<div><!></div>"),xr=_('<button aria-roledescription="model-item"><div class="flex flex-col flex-1 gap-1.5"><div class="flex items-center gap-2"><div class="flex items-center min-w-fit"><!></div> <div class="flex items-center"><!></div> <div class=" shrink-0 flex items-center gap-2"><!> <!> <!> <!></div></div></div> <div class="ml-auto pl-2 pr-1 flex items-center gap-1.5 shrink-0"><!> <!> <!></div></button>');function $r(_e,h){Ke(h,!1);const n=()=>ge(ze,"$i18n",U),v=()=>ge(xt,"$user",U),[U,ne]=tt(),ze=Qe("i18n");let ue=H(h,"selectedModelIdx",24,()=>-1),t=H(h,"item",24,()=>({})),Le=H(h,"index",24,()=>-1),se=H(h,"value",8,""),Ee=H(h,"unloadModelHandler",8,()=>{}),he=H(h,"pinModelHandler",8,()=>{}),xe=H(h,"onClick",8,()=>{});const ke=async r=>{const o=window.location.origin;await Nt(`${o}/?model=${encodeURIComponent(r.id)}`)?le.success(n().t("Copied link to clipboard")):le.error(n().t("Failed to copy link"))};let $e=ce(!1);et();var ae=xr(),w=m(ae),Se=m(w),me=m(Se),ye=m(me);{let r=J(()=>(v(),p(t()),l(()=>{var o,s;return((o=v())==null?void 0:o.role)==="admin"?((s=t())==null?void 0:s.value)??"":""})));X(ye,{get content(){return e(r)},placement:"top-start",children:(o,s)=>{var f=ar();D(()=>Q(f,"src",(p(t()),p(ct),l(()=>{var d,N,x;return((x=(N=(d=t().model)==null?void 0:d.info)==null?void 0:N.meta)==null?void 0:x.profile_image_url)??`${ct}/static/favicon.png`})))),c(o,f)},$$slots:{default:!0}})}u(me);var ee=C(me,2),Y=m(ee);{let r=J(()=>(p(t()),l(()=>`${t().label} (${t().value})`)));X(Y,{get content(){return e(r)},placement:"top-start",children:(o,s)=>{var f=or(),d=m(f,!0);u(f),D(()=>q(d,(p(t()),l(()=>t().label)))),c(o,f)},$$slots:{default:!0}})}u(ee);var A=C(ee,2),W=m(A);{var I=r=>{var o=dr(),s=ve(o);{var f=x=>{var k=nr(),z=m(k);{let L=J(()=>(p(t()),l(()=>{var B,E,T,ie,Pe,Oe;return`${(E=(B=t().model.ollama)==null?void 0:B.details)!=null&&E.quantization_level?((ie=(T=t().model.ollama)==null?void 0:T.details)==null?void 0:ie.quantization_level)+" ":""}${(Pe=t().model.ollama)!=null&&Pe.size?`(${(((Oe=t().model.ollama)==null?void 0:Oe.size)/1073741824).toFixed(1)}GB)`:""}`})));X(z,{get content(){return e(L)},className:"self-end",children:(B,E)=>{var T=lr(),ie=m(T,!0);u(T),D(()=>q(ie,(p(t()),l(()=>{var Pe,Oe;return((Oe=(Pe=t().model.ollama)==null?void 0:Pe.details)==null?void 0:Oe.parameter_size)??""})))),c(B,T)},$$slots:{default:!0}})}u(k),c(x,k)};j(s,x=>{p(t()),l(()=>{var k,z;return(((z=(k=t().model.ollama)==null?void 0:k.details)==null?void 0:z.parameter_size)??"")!==""})&&x(f)})}var d=C(s,2);{var N=x=>{var k=ir(),z=m(k);{let L=J(()=>(n(),p(Je),p(t()),l(()=>{var B;return`${n().t("Unloads {{FROM_NOW}}",{FROM_NOW:Je(((B=t().model.ollama)==null?void 0:B.expires_at)*1e3).fromNow()})}`})));X(z,{get content(){return e(L)},className:"self-end",children:(B,E)=>{var T=sr();c(B,T)},$$slots:{default:!0}})}u(k),c(x,k)};j(d,x=>{p(t()),l(()=>{var k,z;return((k=t().model.ollama)==null?void 0:k.expires_at)&&new Date(((z=t().model.ollama)==null?void 0:z.expires_at)*1e3)>new Date})&&x(N)})}c(r,o)};j(W,r=>{p(t()),l(()=>t().model.owned_by==="ollama")&&r(I)})}var O=C(W,2);{var y=r=>{var o=qe(),s=ve(o);Bt(s,()=>(p(t()),l(()=>t().model.id)),f=>{X(f,{get elementId(){return`tags-${p(t()),l(()=>t().model.id)??""}`},children:(d,N)=>{var x=cr(),k=m(x);rr(k,{}),u(x),c(d,x)},$$slots:{default:!0,tooltip:(d,N)=>{var x=ur();Fe(x,5,()=>(p(t()),l(()=>{var k;return(k=t().model)==null?void 0:k.tags.sort((z,L)=>z.name.localeCompare(L.name))})),Ze,(k,z)=>{X(k,{get content(){return e(z),l(()=>e(z).name)},className:"flex-shrink-0",children:(L,B)=>{var E=vr(),T=m(E,!0);u(E),D(()=>q(T,(e(z),l(()=>e(z).name)))),c(L,E)},$$slots:{default:!0}})}),u(x),D(()=>Q(x,"id",`tags-${p(t()),l(()=>t().model.id)??""}`)),c(d,x)}}})}),c(r,o)};j(O,r=>{p(t()),l(()=>{var o,s;return(((s=(o=t())==null?void 0:o.model)==null?void 0:s.tags)??[]).length>0})&&r(y)})}var fe=C(O,2);{var K=r=>{{let o=J(()=>(n(),l(()=>`${n().t("Direct")}`)));X(r,{get content(){return e(o)},children:(s,f)=>{var d=mr();c(s,d)},$$slots:{default:!0}})}},Me=r=>{var o=qe(),s=ve(o);{var f=d=>{{let N=J(()=>(n(),l(()=>`${n().t("External")}`)));X(d,{get content(){return e(N)},children:(x,k)=>{var z=fr();c(x,z)},$$slots:{default:!0}})}};j(s,d=>{p(t()),l(()=>t().model.connection_type==="external")&&d(f)},!0)}c(r,o)};j(fe,r=>{p(t()),l(()=>{var o;return(o=t().model)==null?void 0:o.direct})?r(K):r(Me,!1)})}var Ae=C(fe,2);{var Ce=r=>{{let o=J(()=>(p(it),p(dt),p(t()),l(()=>{var s,f,d;return`${it.parse(dt((d=(f=(s=t().model)==null?void 0:s.info)==null?void 0:f.meta)==null?void 0:d.description).replaceAll(`
`,"<br>"))}`})));X(r,{get content(){return e(o)},children:(s,f)=>{var d=pr();c(s,d)},$$slots:{default:!0}})}};j(Ae,r=>{p(t()),l(()=>{var o,s,f;return(f=(s=(o=t().model)==null?void 0:o.info)==null?void 0:s.meta)==null?void 0:f.description})&&r(Ce)})}u(A),u(Se),u(w);var F=C(w,2),G=m(F);{var te=r=>{{let o=J(()=>(n(),l(()=>`${n().t("Eject")}`)));X(r,{get content(){return e(o)},className:"flex-shrink-0 group-hover/item:opacity-100 opacity-0 ",children:(s,f)=>{var d=gr(),N=m(d);Gt(N,{className:"size-3"}),u(d),re("click",d,x=>{x.preventDefault(),x.stopPropagation(),Ee()(t().value)}),c(s,d)},$$slots:{default:!0}})}};j(G,r=>{v(),p(t()),l(()=>{var o,s,f;return((o=v())==null?void 0:o.role)==="admin"&&t().model.owned_by==="ollama"&&((s=t().model.ollama)==null?void 0:s.expires_at)&&new Date(((f=t().model.ollama)==null?void 0:f.expires_at)*1e3)>new Date})&&r(te)})}var Ve=C(G,2);er(Ve,{get model(){return p(t()),l(()=>t().model)},get pinModelHandler(){return he()},copyLinkHandler:()=>{ke(t().model)},get show(){return e($e)},set show(r){M($e,r)},children:(r,o)=>{var s=_r(),f=m(s);Rt(f,{}),u(s),D(d=>Q(s,"aria-label",d),[()=>(n(),l(()=>`${n().t("More Options")}`))]),re("click",s,d=>{d.preventDefault(),d.stopPropagation(),M($e,!e($e))}),c(r,s)},$$slots:{default:!0},$$legacy:!0});var a=C(Ve,2);{var g=r=>{var o=hr(),s=m(o);Ft(s,{className:"size-3"}),u(o),c(r,o)};j(a,r=>{p(se()),p(t()),l(()=>se()===t().value)&&r(g)})}u(F),u(ae),D(()=>{Q(ae,"aria-label",(p(t()),l(()=>t().label))),we(ae,1,`flex group/item w-full text-left font-medium line-clamp-1 select-none items-center rounded-button py-2 pl-3 pr-1.5 text-sm text-gray-700 dark:text-gray-100 outline-hidden transition-all duration-75 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-xl cursor-pointer data-highlighted:bg-muted ${Le()===ue()?"bg-gray-100 dark:bg-gray-800 group-hover:bg-transparent":""}`),Q(ae,"data-arrow-selected",Le()===ue()),Q(ae,"data-value",(p(t()),l(()=>t().value)))}),re("click",ae,()=>{xe()()}),c(_e,ae),Xe(),ne()}var wr=_("<div><!> <!></div>"),yr=_('<div class="flex items-center gap-2.5 px-4.5 mt-3.5 mb-1.5"><!> <input id="model-search-input" class="w-full text-sm bg-transparent outline-hidden" autocomplete="off"/></div>'),br=_("<button> </button>"),kr=_("<button> </button>"),Mr=_("<button> </button>"),Cr=_("<button> </button>"),Pr=_("<button> </button>"),Or=_('<div class=" flex w-full bg-white dark:bg-gray-850 overflow-x-auto scrollbar-none font-[450] mb-0.5"><div class="flex gap-1 w-fit text-center text-sm rounded-full bg-transparent px-1.5 whitespace-nowrap"><!> <!> <!> <!> <!></div></div>'),Nr=_('<div><div class="block px-3 py-2 text-sm text-gray-700 dark:text-gray-100"> </div></div>'),zr=_('<button class="flex w-full font-medium line-clamp-1 select-none items-center rounded-button py-2 pl-3 pr-1.5 text-sm text-gray-700 dark:text-gray-100 outline-hidden transition-all duration-75 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-xl cursor-pointer data-highlighted:bg-muted"><div class=" truncate"> </div></button>'),Lr=_('<div class="-mt-1 h-fit text-[0.7rem] dark:text-gray-500 line-clamp-1"> </div>'),Sr=_('<button class="text-gray-800 dark:text-gray-100"><svg class="w-4 h-4 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18 17.94 6M18 18 6.06 6"></path></svg></button>'),Dr=_('<div class="flex w-full justify-between font-medium select-none rounded-button py-2 pl-3 pr-1.5 text-sm text-gray-700 dark:text-gray-100 outline-hidden transition-all duration-75 rounded-xl cursor-pointer data-highlighted:bg-muted"><div class="flex"><div class="mr-2.5 translate-y-0.5"><!></div> <div class="flex flex-col self-start"><div class="flex gap-1"><div class="line-clamp-1"> </div> <div class="shrink-0"> </div></div> <!></div></div> <div class="mr-2 ml-1 translate-y-0.5"><!></div></div>'),Hr=_('<!> <div class="px-2"><!></div> <div class="px-2.5 max-h-64 overflow-y-auto group relative"><!> <!> <!></div> <div class="mb-2.5"></div> <div class="hidden w-[42rem]"></div> <div class="hidden w-[32rem]"></div>',1),Er=_("<!> <!>",1);function ga(_e,h){Ke(h,!1);const n=()=>ge(Ee,"$i18n",t),v=()=>ge(He,"$MODEL_DOWNLOAD_POOL",t),U=()=>ge(Tt,"$config",t),ne=()=>ge(ht,"$settings",t),ze=()=>ge(Vt,"$mobile",t),ue=()=>ge(xt,"$user",t),[t,Le]=tt(),se=ce();Je.extend(St);const Ee=Qe("i18n");yt();let he=H(h,"id",8,""),xe=H(h,"value",12,""),ke=H(h,"placeholder",24,()=>n().t("Select a model")),$e=H(h,"searchEnabled",8,!0),ae=H(h,"searchPlaceholder",24,()=>n().t("Search a model")),w=H(h,"items",24,()=>[]),Se=H(h,"className",8,"w-[32rem]"),me=H(h,"triggerClassName",8,"text-lg"),ye=H(h,"pinModelHandler",8,()=>{}),ee=ce(),Y=ce(!1),A=ce([]),W=ce(""),I=ce(""),O=ce(""),y=ce(""),fe=ce(null),K=ce(0);const Me=new Lt(w().map(a=>{var r,o,s,f,d;return{...a,modelName:(r=a.model)==null?void 0:r.name,tags:(((o=a.model)==null?void 0:o.tags)??[]).map(N=>N.name).join(" "),desc:(d=(f=(s=a.model)==null?void 0:s.info)==null?void 0:f.meta)==null?void 0:d.description}}),{keys:["value","tags","modelName"],threshold:.4}),Ae=()=>{Me&&Me.setCollection(w().map(a=>{var r,o,s,f,d;return{...a,modelName:(r=a.model)==null?void 0:r.name,tags:(((o=a.model)==null?void 0:o.tags)??[]).map(N=>N.name).join(" "),desc:(d=(f=(s=a.model)==null?void 0:s.info)==null?void 0:f.meta)==null?void 0:d.description}}))},Ce=async()=>{await nt();const a=e(se).findIndex(r=>r.value===xe());a>=0?M(K,a):M(K,0),await nt();const g=document.querySelector('[data-arrow-selected="true"]');g==null||g.scrollIntoView({block:"center",inline:"nearest",behavior:"instant"})},F=async()=>{var o,s,f;const a=e(I).trim().replace(/^ollama\s+(run|pull)\s+/,"");if(v(),v()[a]){le.error(n().t("Model '{{modelTag}}' is already in queue for downloading.",{modelTag:a}));return}if(Object.keys(v()).length===3){le.error(n().t("Maximum of 3 models can be downloaded simultaneously. Please try again later."));return}const[g,r]=await Et(localStorage.token,a,"0").catch(d=>(le.error(`${d}`),null));if(g){const d=g.body.pipeThrough(new TextDecoderStream).pipeThrough(zt(`
`)).getReader();for(He.set({...v(),[a]:{...v()[a],abortController:r,reader:d,done:!1}});;)try{const{value:N,done:x}=await d.read();if(x)break;let k=N.split(`
`);for(const z of k)if(z!==""){let L=JSON.parse(z);if(L.error)throw L.error;if(L.detail)throw L.detail;if(L.status)if(L.digest){let B=0;L.completed?B=Math.round(L.completed/L.total*1e3)/10:B=100,He.set({...v(),[a]:{...v()[a],pullProgress:B,digest:L.digest}})}else le.success(L.status),He.set({...v(),[a]:{...v()[a],done:L.status==="success"}})}}catch(N){typeof N!="string"&&(N=N.message),le.error(`${N}`);break}v()[a].done?(le.success(n().t("Model '{{modelName}}' has been successfully downloaded.",{modelName:a})),Ye.set(await Ge(localStorage.token,((s=(o=U())==null?void 0:o.features)==null?void 0:s.enable_direct_connections)&&(((f=ne())==null?void 0:f.directConnections)??null)))):le.error(n().t("Download canceled")),delete v()[a],He.set({...v()})}},G=async()=>{M(fe,await At(localStorage.token).catch(a=>!1))};bt(async()=>{w()&&(M(A,w().filter(a=>{var g,r,o;return!(((o=(r=(g=a.model)==null?void 0:g.info)==null?void 0:r.meta)==null?void 0:o.hidden)??!1)}).flatMap(a=>{var g;return((g=a.model)==null?void 0:g.tags)??[]}).map(a=>a.name.toLowerCase())),M(A,Array.from(new Set(e(A))).sort((a,g)=>a.localeCompare(g))))});const te=async a=>{const{reader:g,abortController:r}=v()[a];r&&r.abort(),g&&(await g.cancel(),delete v()[a],He.set({...v()}),await It(localStorage.token,a),le.success(n().t("{{model}} download has been canceled",{model:a})))},Ve=async a=>{var r,o,s;await Ht(localStorage.token,a).catch(f=>{le.error(n().t("Error unloading model: {{error}}",{error:f}))})&&(le.success(n().t("Model unloaded successfully")),Ye.set(await Ge(localStorage.token,((o=(r=U())==null?void 0:r.features)==null?void 0:o.enable_direct_connections)&&(((s=ne())==null?void 0:s.directConnections)??null))))};Te(()=>(p(w()),p(xe())),()=>{M(W,w().find(a=>a.value===xe())??"")}),Te(()=>p(w()),()=>{w()&&Ae()}),Te(()=>(e(I),e(O),e(y),p(w())),()=>{M(se,(e(I)?Me.search(e(I)).map(a=>a.item).filter(a=>{var g;return e(O)===""?!0:(((g=a.model)==null?void 0:g.tags)??[]).map(r=>r.name.toLowerCase()).includes(e(O).toLowerCase())}).filter(a=>{var g,r,o;if(e(y)==="")return!0;if(e(y)==="local")return((g=a.model)==null?void 0:g.connection_type)==="local";if(e(y)==="external")return((r=a.model)==null?void 0:r.connection_type)==="external";if(e(y)==="direct")return(o=a.model)==null?void 0:o.direct}):w().filter(a=>{var g;return e(O)===""?!0:(((g=a.model)==null?void 0:g.tags)??[]).map(r=>r.name.toLowerCase()).includes(e(O).toLowerCase())}).filter(a=>{var g,r,o;if(e(y)==="")return!0;if(e(y)==="local")return((g=a.model)==null?void 0:g.connection_type)==="local";if(e(y)==="external")return((r=a.model)==null?void 0:r.connection_type)==="external";if(e(y)==="direct")return(o=a.model)==null?void 0:o.direct})).filter(a=>{var g,r,o;return!(((o=(r=(g=a.model)==null?void 0:g.info)==null?void 0:r.meta)==null?void 0:o.hidden)??!1)}))}),Te(()=>(e(O),e(y)),()=>{e(O)||e(y),Ce()}),Te(()=>e(Y),()=>{e(Y)&&G()}),kt(),et(),ft(_e,{onOpenChange:async()=>{M(I,""),window.setTimeout(()=>{var a;return(a=document.getElementById("model-search-input"))==null?void 0:a.focus()},0),Ce()},closeFocus:!1,get open(){return e(Y)},set open(a){M(Y,a)},children:(a,g)=>{var r=Er(),o=ve(r);{let f=J(()=>(ne(),l(()=>{var d;return((d=ne())==null?void 0:d.highContrastMode)??!1?"":"outline-hidden focus:outline-hidden"})));pt(o,{get class(){return`relative w-full ${e(f)??""}`},get"aria-label"(){return ke()},get id(){return`model-selector-${he()??""}-button`},children:(d,N)=>{var x=wr(),k=m(x);{var z=E=>{var T=Ue();D(()=>q(T,(e(W),l(()=>e(W).label)))),c(E,T)},L=E=>{var T=Ue();D(()=>q(T,ke())),c(E,T)};j(k,E=>{e(W)?E(z):E(L,!1)})}var B=C(k,2);jt(B,{className:" self-center ml-2 size-3",strokeWidth:"2.5"}),u(x),D(()=>we(x,1,`flex w-full text-left px-0.5 bg-transparent truncate ${me()??""} justify-between ${ne(),l(()=>{var E;return((E=ne())==null?void 0:E.highContrastMode)??!1?"dark:placeholder-gray-100 placeholder-gray-800":"placeholder-gray-400"})??""}`)),re("mouseenter",x,async()=>{var E,T,ie;Ye.set(await Ge(localStorage.token,((T=(E=U())==null?void 0:E.features)==null?void 0:T.enable_direct_connections)&&(((ie=ne())==null?void 0:ie.directConnections)??null)))}),c(d,x)},$$slots:{default:!0}})}var s=C(o,2);{let f=J(()=>ze()?"w-full":`${Se()}`),d=J(()=>ze()?"bottom":"bottom-start");gt(s,{get class(){return` z-40 ${e(f)??""} max-w-[calc(100vw-1rem)] justify-start rounded-2xl  bg-white dark:bg-gray-850 dark:text-white shadow-lg  outline-hidden`},get transition(){return _t},get side(){return e(d)},sideOffset:2,alignOffset:-1,children:(N,x)=>{var k=qe(),z=ve(k);ut(z,h,"default",{},L=>{var B=Hr(),E=ve(B);{var T=R=>{var $=yr(),V=m($);Wt(V,{className:"size-4",strokeWidth:"2.5"});var Z=C(V,2);Ct(Z),u($),D(S=>{Q(Z,"placeholder",ae()),Q(Z,"aria-label",S)},[()=>(n(),l(()=>n().t("Search In Models")))]),Pt(Z,()=>e(I),S=>M(I,S)),re("keydown",Z,S=>{if(S.code==="Enter"&&e(se).length>0){xe(e(se)[e(K)].value),M(Y,!1);return}else S.code==="ArrowDown"?(S.stopPropagation(),M(K,Math.min(e(K)+1,e(se).length-1))):S.code==="ArrowUp"?(S.stopPropagation(),M(K,Math.max(e(K)-1,0))):M(K,0);const de=document.querySelector('[data-arrow-selected="true"]');de==null||de.scrollIntoView({block:"center",inline:"nearest",behavior:"instant"})}),c(R,$)};j(E,R=>{$e()&&R(T)})}var ie=C(E,2),Pe=m(ie);{var Oe=R=>{var $=Or(),V=m($),Z=m(V);{var S=P=>{var i=br(),b=m(i,!0);u(i),D(pe=>{we(i,1,`min-w-fit outline-none px-1.5 py-0.5 ${e(O)===""&&e(y)===""?"":"text-gray-300 dark:text-gray-600 hover:text-gray-700 dark:hover:text-white"} transition capitalize`),Q(i,"aria-pressed",e(O)===""&&e(y)===""),q(b,pe)},[()=>(n(),l(()=>n().t("All")))]),re("click",i,()=>{M(y,""),M(O,"")}),c(P,i)};j(Z,P=>{p(w()),e(A),l(()=>w().find(i=>{var b;return((b=i.model)==null?void 0:b.connection_type)==="local"})||w().find(i=>{var b;return((b=i.model)==null?void 0:b.connection_type)==="external"})||w().find(i=>{var b;return(b=i.model)==null?void 0:b.direct})||e(A).length>0)&&P(S)})}var de=C(Z,2);{var De=P=>{var i=kr(),b=m(i,!0);u(i),D(pe=>{we(i,1,`min-w-fit outline-none px-1.5 py-0.5 ${e(y)==="local"?"":"text-gray-300 dark:text-gray-600 hover:text-gray-700 dark:hover:text-white"} transition capitalize`),Q(i,"aria-pressed",e(y)==="local"),q(b,pe)},[()=>(n(),l(()=>n().t("Local")))]),re("click",i,()=>{M(O,""),M(y,"local")}),c(P,i)};j(de,P=>{p(w()),l(()=>w().find(i=>{var b;return((b=i.model)==null?void 0:b.connection_type)==="local"}))&&P(De)})}var be=C(de,2);{var Ie=P=>{var i=Mr(),b=m(i,!0);u(i),D(pe=>{we(i,1,`min-w-fit outline-none px-1.5 py-0.5 ${e(y)==="external"?"":"text-gray-300 dark:text-gray-600 hover:text-gray-700 dark:hover:text-white"} transition capitalize`),Q(i,"aria-pressed",e(y)==="external"),q(b,pe)},[()=>(n(),l(()=>n().t("External")))]),re("click",i,()=>{M(O,""),M(y,"external")}),c(P,i)};j(be,P=>{p(w()),l(()=>w().find(i=>{var b;return((b=i.model)==null?void 0:b.connection_type)==="external"}))&&P(Ie)})}var je=C(be,2);{var We=P=>{var i=Cr(),b=m(i,!0);u(i),D(pe=>{we(i,1,`min-w-fit outline-none px-1.5 py-0.5 ${e(y)==="direct"?"":"text-gray-300 dark:text-gray-600 hover:text-gray-700 dark:hover:text-white"} transition capitalize`),Q(i,"aria-pressed",e(y)==="direct"),q(b,pe)},[()=>(n(),l(()=>n().t("Direct")))]),re("click",i,()=>{M(O,""),M(y,"direct")}),c(P,i)};j(je,P=>{p(w()),l(()=>w().find(i=>{var b;return(b=i.model)==null?void 0:b.direct}))&&P(We)})}var Re=C(je,2);Fe(Re,1,()=>e(A),Ze,(P,i)=>{X(P,{get content(){return e(i)},children:(b,pe)=>{var oe=Pr(),Ne=m(oe,!0);u(oe),D(Be=>{we(oe,1,`min-w-fit outline-none px-1.5 py-0.5 ${e(O)===e(i)?"":"text-gray-300 dark:text-gray-600 hover:text-gray-700 dark:hover:text-white"} transition capitalize`),Q(oe,"aria-pressed",e(O)===e(i)),q(Ne,Be)},[()=>(e(i),l(()=>e(i).length>16?`${e(i).slice(0,16)}...`:e(i)))]),re("click",oe,()=>{M(y,""),M(O,e(i))}),c(b,oe)},$$slots:{default:!0}})}),u(V),Ot(V,P=>M(ee,P),()=>e(ee)),u($),re("wheel",$,P=>{P.deltaY!==0&&(P.preventDefault(),P.currentTarget.scrollLeft+=P.deltaY)}),c(R,$)};j(Pe,R=>{e(A),p(w()),l(()=>e(A)&&w().filter($=>{var V,Z,S;return!(((S=(Z=(V=$.model)==null?void 0:V.info)==null?void 0:Z.meta)==null?void 0:S.hidden)??!1)}).length>0)&&R(Oe)})}u(ie);var rt=C(ie,2),at=m(rt);Fe(at,1,()=>e(se),Ze,(R,$,V)=>{$r(R,{get selectedModelIdx(){return e(K)},get item(){return e($)},index:V,get value(){return xe()},get pinModelHandler(){return ye()},unloadModelHandler:Ve,onClick:()=>{xe(e($).value),M(K,V),M(Y,!1)}})},R=>{var $=Nr(),V=m($),Z=m(V,!0);u(V),u($),D(S=>q(Z,S),[()=>(n(),l(()=>n().t("No results found")))]),c(R,$)});var ot=C(at,2);{var $t=R=>{{let $=J(()=>(n(),e(I),l(()=>n().t('Pull "{{searchValue}}" from Ollama.com',{searchValue:e(I)}))));X(R,{get content(){return e($)},placement:"top-start",children:(V,Z)=>{var S=zr(),de=m(S),De=m(de,!0);u(de),u(S),D(be=>q(De,be),[()=>(n(),e(I),l(()=>n().t('Pull "{{searchValue}}" from Ollama.com',{searchValue:e(I)})))]),re("click",S,()=>{F()}),c(V,S)},$$slots:{default:!0}})}};j(ot,R=>{e(I),v(),e(fe),ue(),l(()=>{var $;return!(e(I).trim()in v())&&e(I)&&e(fe)&&(($=ue())==null?void 0:$.role)==="admin"})&&R($t)})}var wt=C(ot,2);Fe(wt,1,()=>(v(),l(()=>Object.keys(v()))),Ze,(R,$)=>{var V=Dr(),Z=m(V),S=m(Z),de=m(S);Dt(de,{}),u(S);var De=C(S,2),be=m(De),Ie=m(be),je=m(Ie);u(Ie);var We=C(Ie,2),Re=m(We,!0);u(We),u(be);var P=C(be,2);{var i=oe=>{var Ne=Lr(),Be=m(Ne,!0);u(Ne),D(()=>q(Be,(v(),e($),l(()=>v()[e($)].digest)))),c(oe,Ne)};j(P,oe=>{v(),e($),l(()=>"digest"in v()[e($)]&&v()[e($)].digest)&&oe(i)})}u(De),u(Z);var b=C(Z,2),pe=m(b);{let oe=J(()=>(n(),l(()=>n().t("Cancel"))));X(pe,{get content(){return e(oe)},children:(Ne,Be)=>{var lt=Sr();re("click",lt,()=>{te(e($))}),c(Ne,lt)},$$slots:{default:!0}})}u(b),u(V),D(()=>{q(je,`Downloading "${e($)??""}"`),q(Re,(v(),e($),l(()=>"pullProgress"in v()[e($)]?`(${v()[e($)].pullProgress}%)`:"")))}),c(R,V)}),u(rt),Mt(6),c(L,B)}),c(N,k)},$$slots:{default:!0}})}c(a,r)},$$slots:{default:!0},$$legacy:!0}),Xe(),Le()}export{ga as S};
//# sourceMappingURL=cx8izoRF.js.map
