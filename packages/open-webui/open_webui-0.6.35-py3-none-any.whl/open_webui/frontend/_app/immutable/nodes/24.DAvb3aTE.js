import"../chunks/CWj6FrbW.js";import"../chunks/CN51-NxK.js";import{g as Ge,aT as ft,o as ut,q as Ee,v as mt,h as pt,e as Se,a as c,p as Je,f as p,b as Ke,i as b,t as $,$ as gt,w as i,j as t,k as m,c as a,r,m as M,A as _t,s as N,l as je,n as ae,u as Oe,z as We}from"../chunks/CvTLsZlf.js";import{i as R}from"../chunks/B3D73U8p.js";import{r as xt,a as De,s as He}from"../chunks/CPzR4-ix.js";import{i as Qe}from"../chunks/CNVL70pO.js";import{s as Re,a as H}from"../chunks/DzS5ldT-.js";import{W as bt,s as Ye,m as ht,u as yt,k as $t}from"../chunks/D6EOiKH3.js";import{U as wt}from"../chunks/ERVESKdh.js";import{e as qe,i as kt}from"../chunks/uF71e8HK.js";import{b as Nt}from"../chunks/BpTtYi1u.js";import{m as St,g as jt,i as Dt,j as Xe}from"../chunks/D38tgtmh.js";import{t as U}from"../chunks/Cqe-NRGo.js";import{f as Ct}from"../chunks/dsq8o_n-.js";import{F as Pt}from"../chunks/CU2r43ac.js";import{d as Q,r as Tt}from"../chunks/BqAeIAOr.js";import"../chunks/BSaLyK_V.js";import{d as At}from"../chunks/DkOAY2Kp.js";import{p as Ft}from"../chunks/KihEXLMb.js";import{g as Lt}from"../chunks/BDMvu-7n.js";import{g as Mt,c as ze,d as Ut}from"../chunks/BY8Ev7y4.js";import{N as Bt,d as It}from"../chunks/D53_wX3Q.js";import{E as Et}from"../chunks/DEA4EnEJ.js";import{C as Ot}from"../chunks/Ch-EHQFf.js";import{S as Wt}from"../chunks/B0jU0TkR.js";import{P as Ht}from"../chunks/DbQqwFih.js";import{S as Yt}from"../chunks/DD1zKOTk.js";import{T as Ce}from"../chunks/k6hQMChD.js";import{F as qt}from"../chunks/XG0PCJXd.js";import{X as Xt}from"../chunks/BFL0NFeS.js";import{S as zt}from"../chunks/CcqZwM1Q.js";var Gt=p('<div class=" text-sm text-gray-500 truncate"> <span class="  font-semibold"> </span>.</div>'),Jt=p('<div class="self-center pl-1.5 translate-y-[0.5px] rounded-l-xl bg-transparent"><button class="p-0.5 rounded-full hover:bg-gray-100 dark:hover:bg-gray-900 transition"><!></button></div>'),Kt=p('<button class="self-center w-fit text-sm p-1 dark:text-gray-300 dark:hover:text-white hover:bg-black/5 dark:hover:bg-white/5 rounded-xl" type="button"><!></button>'),Qt=p('<div class="shrink-0 text-gray-500"> </div>'),Rt=p('<div class=" flex space-x-4 cursor-pointer w-full px-4.5 py-4 border border-gray-50 dark:border-gray-850 bg-transparent dark:hover:bg-gray-850 hover:bg-white rounded-2xl transition"><div class=" flex flex-1 space-x-4 cursor-pointer w-full"><a class="w-full -translate-y-0.5 flex flex-col justify-between"><div class="flex-1"><div class="  flex items-center gap-2 self-center mb-1 justify-between"><div class=" font-semibold line-clamp-1 capitalize"> </div> <div><!></div></div> <div class=" text-xs text-gray-500 dark:text-gray-500 mb-3 line-clamp-3 min-h-10"><!></div></div> <div class=" text-xs px-0.5 w-full flex justify-between items-center"><div> </div> <!></div></a></div></div>'),Vt=p('<div class="w-full text-xs text-gray-500 dark:text-gray-500 font-medium pb-2.5"> </div> <div class="mb-5 gap-2.5 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5"></div>',1),Zt=p('<div class="pb-10"></div>'),er=p('<div class="w-full h-full flex flex-col items-center justify-center"><div class="pb-20 text-center"><div class=" text-xl font-medium text-gray-400 dark:text-gray-600"> </div> <div class="mt-1 text-sm text-gray-300 dark:text-gray-700"> </div></div></div>'),tr=p('<button class="cursor-pointer p-2.5 flex rounded-full border border-gray-50 bg-white dark:border-none dark:bg-gray-850 hover:bg-gray-50 dark:hover:bg-gray-800 transition shadow-xl" type="button"><!></button>'),rr=p('<!> <div class="flex flex-col gap-1 px-3.5"><div class=" flex flex-1 items-center w-full space-x-2"><div class="flex flex-1 items-center"><div class=" self-center ml-1 mr-3"><!></div> <input class=" w-full text-sm py-1 rounded-r-xl outline-hidden bg-transparent"/> <!></div></div></div> <div class="px-4.5 @container h-full pt-2"><!></div> <div class="absolute bottom-0 left-0 right-0 p-5 max-w-full flex justify-end"><div class="flex gap-0.5 justify-end w-full"><!></div></div>',1),ar=p('<div class="w-full h-full flex justify-center items-center"><!></div>'),sr=p('<!> <div id="notes-container" class="w-full min-h-full h-full"><!></div>',1);function or(fe,ue){Ke(ue,!1);const o=()=>H(q,"$i18n",T),se=()=>H(Ft,"$page",T),V=()=>H(bt,"$WEBUI_NAME",T),[T,Y]=Re(),{saveAs:oe}=Ct;Q.extend(At),Q.extend(Tt);async function me(e){for(const s of e)try{Q.locale(s);break}catch(l){`${s}`}}const q=Ge("i18n");let X=M(!1),S=M(""),B=M([]),z=M(null),h=M(null),w=M({}),I=M(!1);const le=e=>{if(!Array.isArray(e))return{};const s={};for(const l of e){const g=jt(l.updated_at/1e9);s[g]||(s[g]=[]),s[g].push({...l,timeRange:g})}return s},Z=async()=>{b(B,await Mt(localStorage.token,!0)),b(z,new Pt(t(B),{keys:["title"]}))},ee=async e=>{const s=await ze(localStorage.token,{title:Q().format("YYYY-MM-DD"),data:{content:{json:null,html:e??"",md:e??""}},meta:null,access_control:{}}).catch(l=>(U.error(`${l}`),null));s&&Lt(`/notes/${s.id}`)},pe=async e=>{if(e==="txt"){const s=new Blob([t(h).data.content.md],{type:"text/plain"});oe(s,`${t(h).title}.txt`)}else if(e==="md"){const s=new Blob([t(h).data.content.md],{type:"text/markdown"});oe(s,`${t(h).title}.md`)}else if(e==="pdf")try{await It(t(h))}catch(s){U.error(`${s}`)}},ge=async e=>{await Ut(localStorage.token,e).catch(l=>(U.error(`${l}`),null))&&Z()},ie=async e=>{for(const s of e){if(s.type!=="text/markdown"){U.error(o().t("Only markdown files are allowed"));return}const l=new FileReader;l.onload=async g=>{const J=g.target.result;let ne=s.name.replace(/\.md$/,"");if(typeof J!="string"){U.error(o().t("Invalid file content"));return}await ze(localStorage.token,{title:ne,data:{content:{json:null,html:St.parse(J??""),md:J}},meta:null,access_control:{}}).catch(xe=>(U.error(`${xe}`),null))&&Z()},l.readAsText(s)}};let E=M(!1);const y=e=>{var s,l;e.preventDefault(),(l=(s=e.dataTransfer)==null?void 0:s.types)!=null&&l.includes("Files")?b(E,!0):b(E,!1)},D=()=>{b(E,!1)},k=async e=>{var s,l;if(e.preventDefault(),(s=e.dataTransfer)!=null&&s.files){const g=Array.from((l=e.dataTransfer)==null?void 0:l.files);g&&g.length>0&&ie(g)}b(E,!1)};ft(()=>{const e=document.getElementById("notes-container");e&&(e==null||e.removeEventListener("dragover",y),e==null||e.removeEventListener("drop",k),e==null||e.removeEventListener("dragleave",D))}),ut(async()=>{if(se().url.searchParams.get("content")!==null){const s=se().url.searchParams.get("content")??"";ee(s);return}await Z(),b(X,!0);const e=document.getElementById("notes-container");e==null||e.addEventListener("dragover",y),e==null||e.addEventListener("drop",k),e==null||e.addEventListener("dragleave",D)}),Ee(()=>o(),()=>{me(o().languages)}),Ee(()=>(t(z),t(S),t(B)),()=>{t(z)&&b(w,le(t(S)?t(z).search(t(S)).map(e=>e.item):t(B)))}),mt(),Qe();var te=sr();pt(e=>{$(s=>gt.title=`
		${s??""} â€¢ ${V()??""}
	`,[()=>(o(),i(()=>o().t("Notes")))])});var A=Se(te);qt(A,{get show(){return t(E)}});var G=m(A,2),F=a(G);{var O=e=>{var s=rr(),l=Se(s);{let d=ae(()=>(o(),i(()=>o().t("Delete note?"))));Ot(l,{get title(){return t(d)},get show(){return t(I)},set show(f){b(I,f)},$$events:{confirm:()=>{ge(t(h).id),b(I,!1)}},children:(f,j)=>{var n=Gt(),C=a(n),P=m(C),re=a(P,!0);r(P),_t(),r(n),$(K=>{N(C,`${K??""} `),N(re,(t(h),i(()=>t(h).title)))},[()=>(o(),i(()=>o().t("This will delete")))]),c(f,n)},$$slots:{default:!0},$$legacy:!0})}var g=m(l,2),J=a(g),ne=a(J),de=a(ne),xe=a(de);Wt(xe,{className:"size-3.5"}),r(de);var ve=m(de,2);xt(ve);var Ve=m(ve,2);{var Ze=d=>{var f=Jt(),j=a(f),n=a(j);Xt(n,{className:"size-3",strokeWidth:"2"}),r(j),r(f),je("click",j,()=>{b(S,"")}),c(d,f)};R(Ve,d=>{t(S)&&d(Ze)})}r(ne),r(J),r(g);var be=m(g,2),et=a(be);{var tt=d=>{var f=Zt();qe(f,5,()=>(t(w),i(()=>Object.keys(t(w)))),kt,(j,n)=>{var C=Vt(),P=Se(C),re=a(P,!0);r(P);var K=m(P,2);qe(K,7,()=>(t(w),t(n),i(()=>t(w)[t(n)])),W=>W.id,(W,v)=>{var he=Rt(),Ae=a(he),ye=a(Ae),$e=a(ye),we=a($e),ke=a(we),st=a(ke,!0);r(ke);var Fe=m(ke,2),ot=a(Fe);Bt(ot,{onDownload:u=>{b(h,t(v)),pe(u)},onCopyLink:async()=>{const u=window.location.origin;await Dt(`${u}/notes/${t(v).id}`)?U.success(o().t("Copied link to clipboard")):U.error(o().t("Failed to copy link"))},onDelete:()=>{b(h,t(v)),b(I,!0)},children:(u,_)=>{var x=Kt(),L=a(x);Et(L,{className:"size-5"}),r(x),c(u,x)},$$slots:{default:!0}}),r(Fe),r(we);var Le=m(we,2),lt=a(Le);{var it=u=>{var _=We();$(()=>N(_,(t(v),i(()=>{var x,L;return(L=(x=t(v).data)==null?void 0:x.content)==null?void 0:L.md})))),c(u,_)},nt=u=>{var _=We();$(x=>N(_,x),[()=>(o(),i(()=>o().t("No content")))]),c(u,_)};R(lt,u=>{t(v),i(()=>{var _,x;return(x=(_=t(v).data)==null?void 0:_.content)==null?void 0:x.md})?u(it):u(nt,!1)})}r(Le),r($e);var Me=m($e,2),Ne=a(Me),dt=a(Ne,!0);r(Ne);var vt=m(Ne,2);{let u=ae(()=>(t(v),o(),i(()=>{var _,x;return((x=(_=t(v))==null?void 0:_.user)==null?void 0:x.email)??o().t("Deleted User")})));Ce(vt,{get content(){return t(u)},className:"flex shrink-0",placement:"top-start",children:(_,x)=>{var L=Qt(),ct=a(L,!0);r(L),$(ce=>N(ct,ce),[()=>(o(),Oe(Xe),t(v),i(()=>{var ce,Ue,Be,Ie;return o().t("By {{name}}",{name:Xe(((Ue=(ce=t(v))==null?void 0:ce.user)==null?void 0:Ue.name)??((Ie=(Be=t(v))==null?void 0:Be.user)==null?void 0:Ie.email)??o().t("Deleted User"))})}))]),c(_,L)},$$slots:{default:!0}})}r(Me),r(ye),r(Ae),r(he),$(u=>{De(ye,"href",(t(v),i(()=>`/notes/${t(v).id}`))),N(st,(t(v),i(()=>t(v).title))),N(dt,u)},[()=>(Oe(Q),t(v),i(()=>Q(t(v).updated_at/1e6).fromNow()))]),c(W,he)}),r(K),$(W=>N(re,W),[()=>(o(),t(n),i(()=>o().t(t(n))))]),c(j,C)}),r(f),c(d,f)},rt=d=>{var f=er(),j=a(f),n=a(j),C=a(n,!0);r(n);var P=m(n,2),re=a(P,!0);r(P),r(j),r(f),$((K,W)=>{N(C,K),N(re,W)},[()=>(o(),i(()=>o().t("No Notes"))),()=>(o(),i(()=>o().t("Create your first note by clicking on the plus button below.")))]),c(d,f)};R(et,d=>{t(w),i(()=>Object.keys(t(w)).length>0)?d(tt):d(rt,!1)})}r(be);var Pe=m(be,2),Te=a(Pe),at=a(Te);{let d=ae(()=>(o(),i(()=>o().t("Create Note"))));Ce(at,{get content(){return t(d)},children:(f,j)=>{var n=tr(),C=a(n);Ht(C,{className:"size-4.5",strokeWidth:"2.5"}),r(n),je("click",n,async()=>{ee()}),c(f,n)},$$slots:{default:!0}})}r(Te),r(Pe),$(d=>De(ve,"placeholder",d),[()=>(o(),i(()=>o().t("Search Notes")))]),Nt(ve,()=>t(S),d=>b(S,d)),c(e,s)},_e=e=>{var s=ar(),l=a(s);Yt(l,{className:"size-5"}),r(s),c(e,s)};R(F,e=>{t(X)?e(O):e(_e,!1)})}r(G),c(fe,te),Je(),Y()}var lr=p('<button id="sidebar-toggle-button" class=" cursor-pointer flex rounded-lg hover:bg-gray-100 dark:hover:bg-gray-850 transition cursor-"><div class=" self-center p-1.5"><!></div></button>'),ir=p("<div><!></div>"),nr=p('<button class="select-none flex rounded-xl p-1.5 w-full hover:bg-gray-50 dark:hover:bg-gray-850 transition" aria-label="User Menu"><div class=" self-center"><img class="size-6 object-cover rounded-full" alt="User profile" draggable="false"/></div></button>'),dr=p('<div><nav class="   px-2 pt-1.5 backdrop-blur-xl w-full drag-region"><div class=" flex items-center"><!> <div class="ml-2 py-0.5 self-center flex items-center justify-between w-full"><div><div class="flex gap-1 scrollbar-none overflow-x-auto w-fit text-center text-sm font-medium bg-transparent py-1 touch-auto pointer-events-auto"><a class="min-w-fit transition" href="/notes"> </a></div></div> <div class=" self-center flex items-center gap-1"><!></div></div></div></nav> <div class=" pb-1 flex-1 max-h-full overflow-y-auto @container"><!></div></div>');function Wr(fe,ue){Ke(ue,!1);const o=()=>H(Ye,"$showSidebar",Y),se=()=>H(ht,"$mobile",Y),V=()=>H(me,"$i18n",Y),T=()=>H(yt,"$user",Y),[Y,oe]=Re(),me=Ge("i18n");Qe();var q=dr(),X=a(q),S=a(X),B=a(S);{var z=y=>{var D=ir(),k=a(D);{let te=ae(()=>o()?V().t("Close Sidebar"):V().t("Open Sidebar"));Ce(k,{get content(){return t(te)},interactive:!0,children:(A,G)=>{var F=lr(),O=a(F),_e=a(O);zt(_e,{}),r(O),r(F),je("click",F,()=>{Ye.set(!o())}),c(A,F)},$$slots:{default:!0}})}r(D),$(()=>He(D,1,`${o()?"md:hidden":""} flex flex-none items-center`)),c(y,D)};R(B,y=>{se()&&y(z)})}var h=m(B,2),w=a(h),I=a(w),le=a(I),Z=a(le,!0);r(le),r(I),r(w);var ee=m(w,2),pe=a(ee);{var ge=y=>{{let D=ae(()=>{var k;return(k=T())==null?void 0:k.role});wt(y,{className:"max-w-[240px]",get role(){return t(D)},help:!0,$$events:{show:k=>{k.detail==="archived-chat"&&$t.set(!0)}},children:(k,te)=>{var A=nr(),G=a(A),F=a(G);r(G),r(A),$(()=>{var O;return De(F,"src",(O=T())==null?void 0:O.profile_image_url)}),c(k,A)},$$slots:{default:!0}})}};R(pe,y=>{T()!==void 0&&T()!==null&&y(ge)})}r(ee),r(h),r(S),r(X);var ie=m(X,2),E=a(ie);or(E,{}),r(ie),r(q),$(y=>{He(q,1,` flex flex-col w-full h-screen max-h-[100dvh] transition-width duration-200 ease-in-out ${o()?"md:max-w-[calc(100%-260px)]":""} max-w-full`),N(Z,y)},[()=>V().t("Notes")]),c(fe,q),Je(),oe()}export{Wr as component};
//# sourceMappingURL=24.DAvb3aTE.js.map
