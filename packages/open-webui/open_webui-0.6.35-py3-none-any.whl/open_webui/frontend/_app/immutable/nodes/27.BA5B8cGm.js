import"../chunks/CWj6FrbW.js";import"../chunks/CN51-NxK.js";import{g as se,o as le,t as S,a as R,p as re,f as C,b as ie,i,j as l,k as q,m as g,c as o,r as s,aY as ne,n as z,s as F,l as J}from"../chunks/CvTLsZlf.js";import{i as de}from"../chunks/B3D73U8p.js";import{a as ce}from"../chunks/CPzR4-ix.js";import{b as fe}from"../chunks/BpTtYi1u.js";import{b as ue}from"../chunks/Cz9Z7v2M.js";import{i as ve}from"../chunks/CNVL70pO.js";import{s as me,a as f}from"../chunks/DzS5ldT-.js";import"../chunks/Cqe-NRGo.js";import{g as pe}from"../chunks/BDMvu-7n.js";import{u as ge,d as xe,c as be,b as _e,g as he}from"../chunks/D6EOiKH3.js";import{c as we}from"../chunks/CJEDGw0G.js";import{y as ye}from"../chunks/D38tgtmh.js";import{S as $e}from"../chunks/cx8izoRF.js";var ke=C('<button class="px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full"> </button>'),Se=C('<button class="px-3 py-1.5 text-sm font-medium bg-gray-300 text-black transition rounded-full"> </button>'),Re=C('<div class=" flex flex-col justify-between w-full overflow-y-auto h-full"><div class="mx-auto w-full md:px-0 h-full"><div class=" flex flex-col h-full px-4"><div class="flex flex-col justify-between mb-1 gap-1"><div class="flex flex-col gap-1 w-full"><div class="flex w-full"><div class="overflow-hidden w-full"><div class="max-w-full"><!></div></div></div></div></div> <div class=" pt-0.5 pb-2.5 flex flex-col justify-between w-full flex-auto overflow-auto h-0" id="messages-container"><div class=" h-full w-full flex flex-col"><div class="flex-1"><textarea id="text-completion-textarea" class="w-full h-full p-3 bg-transparent border border-gray-100 dark:border-gray-850 outline-hidden resize-none rounded-lg text-sm"></textarea></div></div></div> <div class="pb-3 flex justify-end"><!></div></div></div></div>');function Ce(x,L){ie(L,!1);const j=()=>f(_e,"$models",d),W=()=>f(ge,"$user",d),T=()=>f(xe,"$settings",d),E=()=>f(be,"$config",d),u=()=>f(K,"$i18n",d),[d,G]=me(),K=se("i18n");let c=g(""),n=g(""),b=g(!1),v=!1,_=g();const P=()=>{const e=l(_);e&&(e.scrollTop=e==null?void 0:e.scrollHeight)},Q=()=>{v=!0},V=async()=>{const e=j().find(r=>r.id===l(n)),[t,a]=await we(localStorage.token,{model:e.id,stream:!0,messages:[{role:"assistant",content:l(c)}]},`${he}/api`);if(t&&t.ok){const r=t.body.pipeThrough(new TextDecoderStream).pipeThrough(ye(`
`)).getReader();for(;;){const{value:p,done:oe}=await r.read();if(oe||v){v&&a.abort("User: Stop Response");break}try{let $=p.split(`
`);for(const k of $)if(k!==""&&!k.includes("[DONE]")){let Y=JSON.parse(k.replace(/^data: /,""));i(c,l(c)+(Y.choices[0].delta.content??""))}}catch($){}P()}}},X=async()=>{l(n)&&(i(b,!0),await V(),i(b,!1),v=!1)};le(async()=>{var e,t,a,r,p;((e=W())==null?void 0:e.role)!=="admin"&&await pe("/"),(t=T())!=null&&t.models?i(n,(a=T())==null?void 0:a.models[0]):(r=E())!=null&&r.default_models?i(n,(p=E())==null?void 0:p.default_models.split(",")[0]):i(n,"")}),ve();var h=Re(),B=o(h),H=o(B),w=o(H),U=o(w),A=o(U),D=o(A),I=o(D),Z=o(I);{let e=z(()=>u().t("Select a model")),t=z(()=>j().map(a=>({value:a.id,label:a.name,model:a})));$e(Z,{get placeholder(){return l(e)},get items(){return l(t)},get value(){return l(n)},set value(a){i(n,a)},$$legacy:!0})}s(I),s(D),s(A),s(U),s(w);var y=q(w,2),M=o(y),N=o(M),m=o(N);ne(m),ue(m,e=>i(_,e),()=>l(_)),s(N),s(M),s(y);var O=q(y,2),ee=o(O);{var te=e=>{var t=ke(),a=o(t,!0);s(t),S(r=>F(a,r),[()=>u().t("Run")]),J("click",t,()=>{X()}),R(e,t)},ae=e=>{var t=Se(),a=o(t,!0);s(t),S(r=>F(a,r),[()=>u().t("Cancel")]),J("click",t,()=>{Q()}),R(e,t)};de(ee,e=>{l(b)?e(ae,!1):e(te)})}s(O),s(H),s(B),s(h),S(e=>ce(m,"placeholder",e),[()=>u().t("You're a helpful assistant.")]),fe(m,()=>l(c),e=>i(c,e)),R(x,h),re(),G()}function Fe(x){Ce(x,{})}export{Fe as component};
//# sourceMappingURL=27.BA5B8cGm.js.map
