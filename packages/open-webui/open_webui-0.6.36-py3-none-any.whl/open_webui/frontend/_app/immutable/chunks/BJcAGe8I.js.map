{"version":3,"mappings":"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","names":["downloadPdf","note","jsPDF","html2canvas","__vitePreload","virtualWidth","virtualHeight","html","_b","_a","isDarkMode","node","titleNode","contentNode","canvas","imgData","pdf","imgWidth","pageWidthMM","pageHeight","pageHeightMM","imgHeight","heightLeft","position","i18n","getContext","show","className","onDownload","$.prop","$$props","type","onDelete","onCopyLink","onCopyToClipboard","onChange","state","$$value","e","fade","$i18n","flyAndScale","$$render","consequent","consequent_1","consequent_2"],"ignoreList":[],"sources":["../../../../../../src/lib/components/notes/utils.ts","../../../../../../src/lib/components/notes/Notes/NoteMenu.svelte"],"sourcesContent":["export const downloadPdf = async (note) => {\n\tconst [{ default: jsPDF }, { default: html2canvas }] = await Promise.all([\n\t\timport('jspdf'),\n\t\timport('html2canvas-pro')\n\t]);\n\n\t// Define a fixed virtual screen size\n\tconst virtualWidth = 1024; // Fixed width (adjust as needed)\n\tconst virtualHeight = 1400; // Fixed height (adjust as needed)\n\n\t// STEP 1. Get a DOM node to render\n\tconst html = note.data?.content?.html ?? '';\n\tconst isDarkMode = document.documentElement.classList.contains('dark');\n\n\tlet node;\n\tif (html instanceof HTMLElement) {\n\t\tnode = html;\n\t} else {\n\t\tconst virtualWidth = 800; // px, fixed width for cloned element\n\n\t\t// Clone and style\n\t\tnode = document.createElement('div');\n\n\t\t// title node\n\t\tconst titleNode = document.createElement('div');\n\t\ttitleNode.textContent = note.title;\n\t\ttitleNode.style.fontSize = '24px';\n\t\ttitleNode.style.fontWeight = 'medium';\n\t\ttitleNode.style.paddingBottom = '20px';\n\t\ttitleNode.style.color = isDarkMode ? 'white' : 'black';\n\t\tnode.appendChild(titleNode);\n\n\t\tconst contentNode = document.createElement('div');\n\n\t\tcontentNode.innerHTML = html;\n\n\t\tnode.appendChild(contentNode);\n\n\t\tnode.classList.add('text-black');\n\t\tnode.classList.add('dark:text-white');\n\t\tnode.style.width = `${virtualWidth}px`;\n\t\tnode.style.position = 'absolute';\n\t\tnode.style.left = '-9999px';\n\t\tnode.style.height = 'auto';\n\t\tnode.style.padding = '40px 40px';\n\n\t\tconsole.log(node);\n\t\tdocument.body.appendChild(node);\n\t}\n\n\t// Render to canvas with predefined width\n\tconst canvas = await html2canvas(node, {\n\t\tuseCORS: true,\n\t\tbackgroundColor: isDarkMode ? '#000' : '#fff',\n\t\tscale: 2, // Keep at 1x to avoid unexpected enlargements\n\t\twidth: virtualWidth, // Set fixed virtual screen width\n\t\twindowWidth: virtualWidth, // Ensure consistent rendering\n\t\twindowHeight: virtualHeight\n\t});\n\n\t// Remove hidden node if needed\n\tif (!(html instanceof HTMLElement)) {\n\t\tdocument.body.removeChild(node);\n\t}\n\n\tconst imgData = canvas.toDataURL('image/jpeg', 0.7);\n\n\t// A4 page settings\n\tconst pdf = new jsPDF('p', 'mm', 'a4');\n\tconst imgWidth = 210; // A4 width in mm\n\tconst pageWidthMM = 210; // A4 width in mm\n\tconst pageHeight = 297; // A4 height in mm\n\tconst pageHeightMM = 297; // A4 height in mm\n\n\tif (isDarkMode) {\n\t\tpdf.setFillColor(0, 0, 0);\n\t\tpdf.rect(0, 0, pageWidthMM, pageHeightMM, 'F'); // black bg\n\t}\n\n\t// Maintain aspect ratio\n\tconst imgHeight = (canvas.height * imgWidth) / canvas.width;\n\tlet heightLeft = imgHeight;\n\tlet position = 0;\n\n\tpdf.addImage(imgData, 'JPEG', 0, position, imgWidth, imgHeight);\n\theightLeft -= pageHeight;\n\n\t// Handle additional pages\n\twhile (heightLeft > 0) {\n\t\tposition -= pageHeight;\n\t\tpdf.addPage();\n\n\t\tif (isDarkMode) {\n\t\t\tpdf.setFillColor(0, 0, 0);\n\t\t\tpdf.rect(0, 0, pageWidthMM, pageHeightMM, 'F'); // black bg\n\t\t}\n\n\t\tpdf.addImage(imgData, 'JPEG', 0, position, imgWidth, imgHeight);\n\t\theightLeft -= pageHeight;\n\t}\n\n\tpdf.save(`${note.title}.pdf`);\n};\n","<script lang=\"ts\">\n\timport { DropdownMenu } from 'bits-ui';\n\timport { getContext, onMount } from 'svelte';\n\n\timport { flyAndScale } from '$lib/utils/transitions';\n\timport { fade, slide } from 'svelte/transition';\n\n\timport { showSettings, mobile, showSidebar, user } from '$lib/stores';\n\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\n\timport ArchiveBox from '$lib/components/icons/ArchiveBox.svelte';\n\timport Download from '$lib/components/icons/Download.svelte';\n\timport GarbageBin from '$lib/components/icons/GarbageBin.svelte';\n\timport DocumentDuplicate from '$lib/components/icons/DocumentDuplicate.svelte';\n\timport Share from '$lib/components/icons/Share.svelte';\n\timport Link from '$lib/components/icons/Link.svelte';\n\n\tconst i18n = getContext('i18n');\n\n\texport let show = false;\n\texport let className = 'max-w-[180px]';\n\n\texport let onDownload = (type) => {};\n\texport let onDelete = () => {};\n\n\texport let onCopyLink = null;\n\texport let onCopyToClipboard = null;\n\n\texport let onChange = () => {};\n</script>\n\n<DropdownMenu.Root\n\tbind:open={show}\n\tonOpenChange={(state) => {\n\t\tonChange(state);\n\t}}\n>\n\t<DropdownMenu.Trigger>\n\t\t<slot />\n\t</DropdownMenu.Trigger>\n\n\t<slot name=\"content\">\n\t\t<DropdownMenu.Content\n\t\t\tclass=\"w-full {className} text-sm rounded-2xl px-1 py-1 border border-gray-100  dark:border-gray-800  z-50 bg-white dark:bg-gray-850 dark:text-white shadow-lg\"\n\t\t\tsideOffset={6}\n\t\t\tside=\"bottom\"\n\t\t\talign=\"end\"\n\t\t\ttransition={(e) => fade(e, { duration: 100 })}\n\t\t>\n\t\t\t<DropdownMenu.Sub>\n\t\t\t\t<DropdownMenu.SubTrigger\n\t\t\t\t\tclass=\"flex gap-2 items-center px-3 py-1.5 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl\"\n\t\t\t\t>\n\t\t\t\t\t<Download strokeWidth=\"2\" />\n\n\t\t\t\t\t<div class=\"flex items-center\">{$i18n.t('Download')}</div>\n\t\t\t\t</DropdownMenu.SubTrigger>\n\t\t\t\t<DropdownMenu.SubContent\n\t\t\t\t\tclass=\"w-full rounded-xl p-1 z-50 bg-white dark:bg-gray-850 dark:text-white shadow-lg\"\n\t\t\t\t\ttransition={flyAndScale}\n\t\t\t\t\tsideOffset={8}\n\t\t\t\t\talign=\"end\"\n\t\t\t\t>\n\t\t\t\t\t<DropdownMenu.Item\n\t\t\t\t\t\tclass=\"flex gap-2 items-center px-3 py-1.5 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl\"\n\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\tonDownload('txt');\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"flex items-center line-clamp-1\">{$i18n.t('Plain text (.txt)')}</div>\n\t\t\t\t\t</DropdownMenu.Item>\n\n\t\t\t\t\t<DropdownMenu.Item\n\t\t\t\t\t\tclass=\"flex gap-2 items-center px-3 py-1.5 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl\"\n\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\tonDownload('md');\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"flex items-center line-clamp-1\">{$i18n.t('Plain text (.md)')}</div>\n\t\t\t\t\t</DropdownMenu.Item>\n\n\t\t\t\t\t<DropdownMenu.Item\n\t\t\t\t\t\tclass=\"flex gap-2 items-center px-3 py-1.5 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl\"\n\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\tonDownload('pdf');\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"flex items-center line-clamp-1\">{$i18n.t('PDF document (.pdf)')}</div>\n\t\t\t\t\t</DropdownMenu.Item>\n\t\t\t\t</DropdownMenu.SubContent>\n\t\t\t</DropdownMenu.Sub>\n\n\t\t\t{#if onCopyLink || onCopyToClipboard}\n\t\t\t\t<DropdownMenu.Sub>\n\t\t\t\t\t<DropdownMenu.SubTrigger\n\t\t\t\t\t\tclass=\"flex gap-2 items-center px-3 py-1.5 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<Share strokeWidth=\"2\" />\n\n\t\t\t\t\t\t<div class=\"flex items-center\">{$i18n.t('Share')}</div>\n\t\t\t\t\t</DropdownMenu.SubTrigger>\n\t\t\t\t\t<DropdownMenu.SubContent\n\t\t\t\t\t\tclass=\"w-full rounded-xl p-1 z-50 bg-white dark:bg-gray-850 dark:text-white shadow-lg\"\n\t\t\t\t\t\ttransition={flyAndScale}\n\t\t\t\t\t\tsideOffset={8}\n\t\t\t\t\t\talign=\"end\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{#if onCopyLink}\n\t\t\t\t\t\t\t<DropdownMenu.Item\n\t\t\t\t\t\t\t\tclass=\"flex gap-2 items-center px-3 py-1.5 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl\"\n\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\tonCopyLink();\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<Link />\n\t\t\t\t\t\t\t\t<div class=\"flex items-center\">{$i18n.t('Copy link')}</div>\n\t\t\t\t\t\t\t</DropdownMenu.Item>\n\t\t\t\t\t\t{/if}\n\n\t\t\t\t\t\t{#if onCopyToClipboard}\n\t\t\t\t\t\t\t<DropdownMenu.Item\n\t\t\t\t\t\t\t\tclass=\"flex gap-2 items-center px-3 py-1.5 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl\"\n\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\tonCopyToClipboard();\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<DocumentDuplicate strokeWidth=\"2\" />\n\t\t\t\t\t\t\t\t<div class=\"flex items-center\">{$i18n.t('Copy to clipboard')}</div>\n\t\t\t\t\t\t\t</DropdownMenu.Item>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</DropdownMenu.SubContent>\n\t\t\t\t</DropdownMenu.Sub>\n\t\t\t{/if}\n\n\t\t\t<DropdownMenu.Item\n\t\t\t\tclass=\"flex  gap-2  items-center px-3 py-1.5 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl\"\n\t\t\t\ton:click={() => {\n\t\t\t\t\tonDelete();\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<GarbageBin />\n\t\t\t\t<div class=\"flex items-center\">{$i18n.t('Delete')}</div>\n\t\t\t</DropdownMenu.Item>\n\t\t</DropdownMenu.Content>\n\t</slot>\n</DropdownMenu.Root>\n"],"file":"_app/immutable/chunks/BJcAGe8I.js"}