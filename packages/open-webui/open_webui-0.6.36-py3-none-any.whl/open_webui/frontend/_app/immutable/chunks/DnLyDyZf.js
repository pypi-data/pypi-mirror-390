var pr=Object.defineProperty;var xr=(Pe,n,l)=>n in Pe?pr(Pe,n,{enumerable:!0,configurable:!0,writable:!0,value:l}):Pe[n]=l;var ma=(Pe,n,l)=>xr(Pe,typeof n!="symbol"?n+"":n,l);import"./CWj6FrbW.js";import"./CN51-NxK.js";import{b as Rt,g as Jt,y as Sa,o as xa,i as I,j as e,q as Lt,u as i,v as sa,e as ee,w as t,k as $,c as s,r,t as x,s as U,l as Me,a,aY as Fa,p as jt,f as m,m as $e,z as We,d as we,A as Ta,n as be,aT as nr,x as at,B as ua,aX as la}from"./CvTLsZlf.js";import{i as g}from"./B3D73U8p.js";import{k as Ia}from"./BOeiEyRi.js";import{e as Ct,i as Wt}from"./uF71e8HK.js";import{s as Oe,a as Te,r as Ca,c as Ea,e as za,h as br}from"./CPzR4-ix.js";import{i as zt}from"./CNVL70pO.js";import{p as u}from"./DBxQAEQJ.js";import{a as Ae,s as Zt,e as wr}from"./DzS5ldT-.js";import{b as ba,e as Ka,J as Aa,K as or,L as yr,r as kr,j as ir,N as Qa,P as Mr,Q as Ir,m as lr,d as fa,g as da,c as dr,u as La,G as Ja,S as Ya,T as Xa,a as Cr,W as $r,E as er,F as Sr}from"./BhUNH95W.js";import{t as Ut}from"./Cqe-NRGo.js";import{a as Er,u as Nr,e as Pr}from"./CckZ7x42.js";import{b as Ha,F as ha,H as tr,i as vr,I as Br,z as _a,l as cr,m as Ba,v as ar}from"./1mkyv6O_.js";import{d as qt}from"./BqAeIAOr.js";import"./BFK-koEx.js";import{t as ka}from"./F3vQ5aqJ.js";import{b as Na}from"./BpTtYi1u.js";import{b as pa}from"./Cz9Z7v2M.js";import{u as rr,c as Tr}from"./tyDitj2Q.js";import{f as Lr}from"./-iKachMe.js";import{s as Or}from"./CbN_cImE.js";import{i as Rr}from"./BCWY6rkl.js";import{P as gr,N as Va}from"./DNsLisAV.js";import{S as Za}from"./Cgvnmqcj.js";import{C as jr,b as zr,c as Ar,d as Hr,M as $a,F as qr,I as qa,B as Wr}from"./Aa-3RUhz.js";import{T as Mt}from"./k6hQMChD.js";import{T as Dr}from"./CXpGnVFN.js";import{X as Oa}from"./BFL0NFeS.js";import"./BSaLyK_V.js";import"./DkOAY2Kp.js";import{f as Ma}from"./CiB29Aqe.js";import"./dsq8o_n-.js";import"./CXLK5pxB.js";import"./B3JesTH8.js";import{S as Ur}from"./CbY8xr_8.js";import{C as ur}from"./CJhxu3Yk.js";import{b as fr}from"./DSjMDx8q.js";import{M as mr}from"./B1Io5-Zn.js";import{T as Fr}from"./VKbJuFMC.js";import{S as Ga}from"./DD1zKOTk.js";import{B as Ra}from"./Ch4IWKao.js";import{C as Jr}from"./I-fSXNXS.js";import{E as Vr}from"./DEA4EnEJ.js";import{c as Zr}from"./B9tJt5Hw.js";import{c as Gr}from"./DRVJxa9v.js";import{C as Kr,F as Wa}from"./CwxHrcdq.js";import{s as hr}from"./D4SMs5q_.js";import{b as Qr,c as ja}from"./DM-96xXi.js";import{f as Yr}from"./BjO3HhBo.js";import{D as Xr}from"./BggWuidE.js";import{C as es}from"./BzIph71e.js";import{C as ts}from"./D-Tr9fFQ.js";import{S as Da}from"./B0jU0TkR.js";import"./B1Cj3nBs.js";import{L as as}from"./D3B17OuU.js";import{h as rs}from"./4cohCGYu.js";import{F as ss}from"./CU2r43ac.js";import{E as ns}from"./DVo29qNV.js";var os=m('<div class="text-xs font-medium pt-1.5 -mb-0.5"> </div>'),is=m("<button> </button>"),ls=m("<button><!></button>"),ds=m('<div class="text-sm mt-1.5 font-medium"> </div> <div class="flex flex-wrap gap-1.5 text-sm mt-1.5"></div>',1),vs=m('<!> <div class=" my-2.5 rounded-xl px-4 py-3 border border-gray-100 dark:border-gray-850"><div class="flex justify-between items-center"><div class="text-sm font-medium"> </div> <button><!></button></div> <div class="w-full flex justify-center"><div class=" relative w-fit overflow-x-auto scrollbar-none"><div class="mt-1.5 w-fit flex gap-1 pb-2"></div> <div class="sticky top-0 bottom-0 left-0 right-0 flex justify-between text-xs"><div> </div> <div> </div></div></div></div> <div><!></div> <div class="mt-2"><textarea class="w-full text-sm px-1 py-2 bg-transparent outline-hidden resize-none rounded-xl" rows="3"></textarea></div> <div class="mt-2 gap-1.5 flex justify-between"><div class="flex items-end group"><!></div> <button class="px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full"> </button></div></div>',1);function cs(Pe,n){Rt(n,!1);const l=()=>Ae(ba,"$models",z),f=()=>Ae(b,"$i18n",z),[z,S]=Zt(),b=Jt("i18n"),R=Sa();let q=u(n,"message",8),K=u(n,"show",12,!1),N=["accurate_information","followed_instructions_perfectly","showcased_creativity","positive_attitude","attention_to_detail","thorough_explanation","other"],A=["dont_like_the_style","too_verbose","not_helpful","not_factually_correct","didnt_fully_follow_instructions","refused_when_it_shouldnt_have","being_lazy","other"],le=$e([]),d=$e([]),se=$e(null),j=$e(""),Q=$e(null),oe=$e(null);const o=()=>{var G,re,xe,L,ge,P,M,V,pe;e(se)||I(se,((re=(G=q())==null?void 0:G.annotation)==null?void 0:re.reason)??""),e(j)||I(j,((L=(xe=q())==null?void 0:xe.annotation)==null?void 0:L.comment)??""),I(le,(((P=(ge=q())==null?void 0:ge.annotation)==null?void 0:P.tags)??[]).map(ue=>({name:ue}))),e(Q)||I(Q,((pe=(V=(M=q())==null?void 0:M.annotation)==null?void 0:V.details)==null?void 0:pe.rating)??null)};xa(()=>{var G,re;(G=q())!=null&&G.arena&&(I(oe,l().find(xe=>xe.id===q().selectedModelId)),Ut.success(f().t('This response was generated by "{{model}}"',{model:e(oe)?((re=e(oe))==null?void 0:re.name)??e(oe).id:q().selectedModelId})))});const ie=()=>{R("save",{reason:e(se),comment:e(j),tags:e(le).map(G=>G.name),details:{rating:e(Q)}}),Ut.success(f().t("Thanks for your feedback!")),K(!1)};Lt(()=>i(q()),()=>{var G,re,xe,L;((re=(G=q())==null?void 0:G.annotation)==null?void 0:re.rating)===1?I(d,N):((L=(xe=q())==null?void 0:xe.annotation)==null?void 0:L.rating)===-1&&I(d,A)}),Lt(()=>i(q()),()=>{q()&&o()}),sa(),zt();var _e=vs(),he=ee(_e);{var ce=G=>{var re=os(),xe=s(re,!0);r(re),x(L=>U(xe,L),[()=>(f(),e(oe),i(q()),t(()=>{var L;return f().t('This response was generated by "{{model}}"',{model:e(oe)?((L=e(oe))==null?void 0:L.name)??e(oe).id:q().selectedModelId})}))]),a(G,re)};g(he,G=>{i(q()),t(()=>{var re;return(re=q())==null?void 0:re.arena})&&G(ce)})}var Ie=$(he,2),ve=s(Ie),fe=s(ve),W=s(fe,!0);r(fe);var c=$(fe,2),C=s(c);Oa(C,{className:"size-4"}),r(c),r(ve);var v=$(ve,2),ae=s(v),B=s(ae);Ct(B,4,()=>t(()=>Array.from({length:10}).map((G,re)=>re+1)),Wt,(G,re)=>{var xe=is(),L=s(xe,!0);r(xe),x(()=>{Oe(xe,1,`size-7 text-sm border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 ${e(Q)===re?"bg-gray-100 dark:bg-gray-800":""} transition rounded-full disabled:cursor-not-allowed disabled:text-gray-500 disabled:bg-white dark:disabled:bg-gray-900`),xe.disabled=(i(q()),t(()=>{var ge,P;return((P=(ge=q())==null?void 0:ge.annotation)==null?void 0:P.rating)===-1?re>5:re<6})),U(L,re)}),Me("click",xe,()=>{I(Q,re)}),a(G,xe)}),r(B);var k=$(B,2),_=s(k),w=s(_);r(_);var H=$(_,2),y=s(H);r(H),r(k),r(ae),r(v);var h=$(v,2),p=s(h);{var D=G=>{var re=ds(),xe=ee(re),L=s(xe,!0);r(xe);var ge=$(xe,2);Ct(ge,5,()=>e(d),Wt,(P,M)=>{var V=ls(),pe=s(V);{var ue=Ee=>{var Ce=We();x(Re=>U(Ce,Re),[()=>(f(),t(()=>f().t("Accurate information")))]),a(Ee,Ce)},Se=Ee=>{var Ce=we(),Re=ee(Ce);{var vt=ye=>{var Y=We();x(ke=>U(Y,ke),[()=>(f(),t(()=>f().t("Followed instructions perfectly")))]),a(ye,Y)},Qe=ye=>{var Y=we(),ke=ee(Y);{var ne=te=>{var me=We();x(Ne=>U(me,Ne),[()=>(f(),t(()=>f().t("Showcased creativity")))]),a(te,me)},de=te=>{var me=we(),Ne=ee(me);{var je=st=>{var $t=We();x(ot=>U($t,ot),[()=>(f(),t(()=>f().t("Positive attitude")))]),a(st,$t)},lt=st=>{var $t=we(),ot=ee($t);{var Ye=Ve=>{var Be=We();x(St=>U(Be,St),[()=>(f(),t(()=>f().t("Attention to detail")))]),a(Ve,Be)},He=Ve=>{var Be=we(),St=ee(Be);{var Gt=ea=>{var ia=We();x(va=>U(ia,va),[()=>(f(),t(()=>f().t("Thorough explanation")))]),a(ea,ia)},ta=ea=>{var ia=we(),va=ee(ia);{var nt=qe=>{var De=We();x(pt=>U(De,pt),[()=>(f(),t(()=>f().t("Don't like the style")))]),a(qe,De)},Ge=qe=>{var De=we(),pt=ee(De);{var Et=dt=>{var gt=We();x(Xe=>U(gt,Xe),[()=>(f(),t(()=>f().t("Too verbose")))]),a(dt,gt)},Ot=dt=>{var gt=we(),Xe=ee(gt);{var Ue=Le=>{var Fe=We();x(ze=>U(Fe,ze),[()=>(f(),t(()=>f().t("Not helpful")))]),a(Le,Fe)},Ke=Le=>{var Fe=we(),ze=ee(Fe);{var et=ht=>{var Dt=We();x(Vt=>U(Dt,Vt),[()=>(f(),t(()=>f().t("Not factually correct")))]),a(ht,Dt)},ut=ht=>{var Dt=we(),Vt=ee(Dt);{var Xt=tt=>{var ct=We();x(Ft=>U(ct,Ft),[()=>(f(),t(()=>f().t("Didn't fully follow instructions")))]),a(tt,ct)},ft=tt=>{var ct=we(),Ft=ee(ct);{var na=ca=>{var mt=We();x(Nt=>U(mt,Nt),[()=>(f(),t(()=>f().t("Refused when it shouldn't have")))]),a(ca,mt)},aa=ca=>{var mt=we(),Nt=ee(mt);{var xt=Je=>{var bt=We();x(Kt=>U(bt,Kt),[()=>(f(),t(()=>f().t("Being lazy")))]),a(Je,bt)},At=Je=>{var bt=we(),Kt=ee(bt);{var oa=wt=>{var ra=We();x(wa=>U(ra,wa),[()=>(f(),t(()=>f().t("Other")))]),a(wt,ra)},it=wt=>{var ra=We();x(()=>U(ra,e(M))),a(wt,ra)};g(Kt,wt=>{e(M)==="other"?wt(oa):wt(it,!1)},!0)}a(Je,bt)};g(Nt,Je=>{e(M)==="being_lazy"?Je(xt):Je(At,!1)},!0)}a(ca,mt)};g(Ft,ca=>{e(M)==="refused_when_it_shouldnt_have"?ca(na):ca(aa,!1)},!0)}a(tt,ct)};g(Vt,tt=>{e(M)==="didnt_fully_follow_instructions"?tt(Xt):tt(ft,!1)},!0)}a(ht,Dt)};g(ze,ht=>{e(M)==="not_factually_correct"?ht(et):ht(ut,!1)},!0)}a(Le,Fe)};g(Xe,Le=>{e(M)==="not_helpful"?Le(Ue):Le(Ke,!1)},!0)}a(dt,gt)};g(pt,dt=>{e(M)==="too_verbose"?dt(Et):dt(Ot,!1)},!0)}a(qe,De)};g(va,qe=>{e(M)==="dont_like_the_style"?qe(nt):qe(Ge,!1)},!0)}a(ea,ia)};g(St,ea=>{e(M)==="thorough_explanation"?ea(Gt):ea(ta,!1)},!0)}a(Ve,Be)};g(ot,Ve=>{e(M)==="attention_to_detail"?Ve(Ye):Ve(He,!1)},!0)}a(st,$t)};g(Ne,st=>{e(M)==="positive_attitude"?st(je):st(lt,!1)},!0)}a(te,me)};g(ke,te=>{e(M)==="showcased_creativity"?te(ne):te(de,!1)},!0)}a(ye,Y)};g(Re,ye=>{e(M)==="followed_instructions_perfectly"?ye(vt):ye(Qe,!1)},!0)}a(Ee,Ce)};g(pe,Ee=>{e(M)==="accurate_information"?Ee(ue):Ee(Se,!1)})}r(V),x(()=>Oe(V,1,`px-3 py-0.5 border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 ${e(se)===e(M)?"bg-gray-100 dark:bg-gray-800":""} transition rounded-xl`)),Me("click",V,()=>{I(se,e(M))}),a(P,V)}),r(ge),x(P=>U(L,P),[()=>(f(),t(()=>f().t("Why?")))]),a(G,re)};g(p,G=>{e(d),t(()=>e(d).length>0)&&G(D)})}r(h);var T=$(h,2),F=s(T);Fa(F),r(T);var E=$(T,2),Z=s(E),O=s(Z);Dr(O,{get tags(){return e(le)},$$events:{delete:G=>{I(le,e(le).filter(re=>re.name.replaceAll(" ","_").toLowerCase()!==G.detail.replaceAll(" ","_").toLowerCase()))},add:G=>{I(le,[...e(le),{name:G.detail}])}}}),r(Z);var J=$(Z,2),X=s(J,!0);r(J),r(E),r(Ie),x((G,re,xe,L,ge)=>{Te(Ie,"id",`message-feedback-${i(q()),t(()=>q().id)??""}`),U(W,G),U(w,`1 - ${re??""}`),U(y,`10 - ${xe??""}`),Te(F,"placeholder",L),U(X,ge)},[()=>(f(),t(()=>f().t("How would you rate this response?"))),()=>(f(),t(()=>f().t("Awful"))),()=>(f(),t(()=>f().t("Amazing"))),()=>(f(),t(()=>f().t("Feel free to add specific details"))),()=>(f(),t(()=>f().t("Save")))]),Me("click",c,()=>{K(!1)}),Na(F,()=>e(j),G=>I(j,G)),Me("click",J,()=>{ie()}),a(Pe,_e),jt(),S()}var gs=m('<div class="flex items-center gap-2 text-gray-500 transition"><!> <!></div>'),us=m('<a target="_blank" class="flex w-full items-center p-1 px-3 group/item justify-between text-gray-800 dark:text-gray-300 font-normal! no-underline!"><div class="flex gap-2 items-center"><!> <div class=" line-clamp-1"> </div></div> <div class=" ml-1 text-white dark:text-gray-900 group-hover/item:text-gray-600 dark:group-hover/item:text-white transition"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg></div></a>'),fs=m('<a target="_blank" class="flex w-full items-center p-1 px-3 group/item justify-between text-gray-800 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-850 rounded-lg font-normal! no-underline! mb-1"><div class=" flex justify-center items-center gap-3"><div class="w-fit"><img alt="favicon" class="size-3.5"/></div> <div class="w-full text-sm line-clamp-1"> </div></div> <div class=" ml-1 text-white dark:text-gray-900 group-hover/item:text-gray-600 dark:group-hover/item:text-white transition"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg></div></a>'),ms=m('<a target="_blank" class="flex w-full items-center p-1 px-3 group/item justify-between text-gray-800 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-850 rounded-lg no-underline mb-1"><div class=" flex justify-center items-center gap-3"><div class="w-fit"><img alt="favicon" class="size-3.5"/></div> <div class="w-full text-sm line-clamp-1"> </div></div> <div class=" ml-1 text-white dark:text-gray-900 group-hover/item:text-gray-600 dark:group-hover/item:text-white transition"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg></div></a>'),hs=m('<div class="text-sm border border-gray-50 dark:border-gray-850 rounded-xl my-1.5 p-2 w-full" slot="content"><!> <!></div>');function _s(Pe,n){Rt(n,!1);let l=u(n,"status",24,()=>({urls:[],query:""})),f=$e(!1);zt(),jr(Pe,{grow:!0,className:"w-full",buttonClassName:"w-full",get open(){return e(f)},set open(z){I(f,z)},children:(z,S)=>{var b=gs(),R=s(b);hr(R,n,"default",{},null);var q=$(R,2);{var K=A=>{ts(A,{strokeWidth:"2.5",className:"size-3.5 "})},N=A=>{es(A,{strokeWidth:"2.5",className:"size-3.5 "})};g(q,A=>{e(f)?A(K):A(N,!1)})}r(b),a(z,b)},$$slots:{default:!0,content:(z,S)=>{var b=hs(),R=s(b);{var q=le=>{var d=us(),se=s(d),j=s(se);Da(j,{});var Q=$(j,2),oe=s(Q,!0);r(Q),r(se),Ta(2),r(d),x(()=>{Te(d,"href",`https://www.google.com/search?q=${i(l()),t(()=>l().query)??""}`),U(oe,(i(l()),t(()=>l().query)))}),a(le,d)};g(R,le=>{i(l()),t(()=>{var d;return(d=l())==null?void 0:d.query})&&le(q)})}var K=$(R,2);{var N=le=>{var d=we(),se=ee(d);Ct(se,1,()=>(i(l()),t(()=>l().items)),Wt,(j,Q)=>{var oe=fs(),o=s(oe),ie=s(o),_e=s(ie);r(ie);var he=$(ie,2),ce=s(he,!0);r(he),r(o),Ta(2),r(oe),x(()=>{Te(oe,"href",(e(Q),t(()=>e(Q).link))),Te(_e,"src",`https://www.google.com/s2/favicons?sz=32&domain=${e(Q),t(()=>e(Q).link)??""}`),U(ce,(e(Q),t(()=>{var Ie;return((Ie=e(Q))==null?void 0:Ie.title)??e(Q).link})))}),a(j,oe)}),a(le,d)},A=le=>{var d=we(),se=ee(d);{var j=Q=>{var oe=we(),o=ee(oe);Ct(o,1,()=>(i(l()),t(()=>l().urls)),Wt,(ie,_e)=>{var he=ms(),ce=s(he),Ie=s(ce),ve=s(Ie);r(Ie);var fe=$(Ie,2),W=s(fe,!0);r(fe),r(ce),Ta(2),r(he),x(()=>{Te(he,"href",e(_e)),Te(ve,"src",`https://www.google.com/s2/favicons?sz=32&domain=${e(_e)??""}`),U(W,e(_e))}),a(ie,he)}),a(Q,oe)};g(se,Q=>{i(l()),t(()=>{var oe;return(oe=l())==null?void 0:oe.urls})&&Q(j)},!0)}a(le,d)};g(K,le=>{i(l()),t(()=>{var d;return(d=l())==null?void 0:d.items})?le(N):le(A,!1)})}r(b),a(z,b)}},$$legacy:!0}),jt()}var ps=m('<div class="flex my-2 gap-2.5 border px-4 py-3 border-red-600/10 bg-red-600/10 rounded-lg"><div class=" self-start mt-0.5"><!></div> <div class=" self-center text-sm"><!></div></div>');function xs(Pe,n){Rt(n,!1);let l=u(n,"content",8,"");zt();var f=ps(),z=s(f),S=s(z);zr(S,{className:"size-5 text-red-700 dark:text-red-400"}),r(z);var b=$(z,2),R=s(b);{var q=N=>{var A=We();x(()=>U(A,l())),a(N,A)},K=N=>{var A=we(),le=ee(A);{var d=j=>{var Q=we(),oe=ee(Q);{var o=_e=>{var he=We();x(()=>U(he,(i(l()),t(()=>l().error.message)))),a(_e,he)},ie=_e=>{var he=we(),ce=ee(he);{var Ie=fe=>{var W=We();x(()=>U(W,(i(l()),t(()=>l().detail)))),a(fe,W)},ve=fe=>{var W=we(),c=ee(W);{var C=ae=>{var B=We();x(()=>U(B,(i(l()),t(()=>l().message)))),a(ae,B)},v=ae=>{var B=We();x(k=>U(B,k),[()=>(i(l()),t(()=>JSON.stringify(l())))]),a(ae,B)};g(c,ae=>{i(l()),t(()=>{var B;return(B=l())==null?void 0:B.message})?ae(C):ae(v,!1)},!0)}a(fe,W)};g(ce,fe=>{i(l()),t(()=>{var W;return(W=l())==null?void 0:W.detail})?fe(Ie):fe(ve,!1)},!0)}a(_e,he)};g(oe,_e=>{i(l()),t(()=>{var he,ce,Ie;return((he=l())==null?void 0:he.error)&&((Ie=(ce=l())==null?void 0:ce.error)==null?void 0:Ie.message)})?_e(o):_e(ie,!1)})}a(j,Q)},se=j=>{var Q=We();x(oe=>U(Q,oe),[()=>(i(l()),t(()=>JSON.stringify(l())))]),a(j,Q)};g(le,j=>{typeof l()=="object"&&l()!==null?j(d):j(se,!1)},!0)}a(N,A)};g(R,N=>{typeof l()=="string"?N(q):N(K,!1)})}r(b),r(f),a(Pe,f),jt()}var bs=m('<a class="hover:text-gray-500 dark:hover:text-gray-100 underline grow line-clamp-1" target="_blank"> </a>'),ws=m('<div><div class="text-sm font-medium dark:text-gray-300 mb-1"> </div> <!></div>'),ys=m("<span> </span>"),ks=m('<span class="text-gray-500 dark:text-gray-500"> </span>'),Ms=m('<div class="text-sm my-1 dark:text-gray-400 flex items-center gap-2 w-fit"><!></div>'),Is=m('<span class="text-sm text-gray-500 dark:text-gray-400"> </span>'),Cs=m('<iframe class="w-full border-0 h-auto rounded-none" sandbox="allow-scripts allow-forms allow-same-origin"></iframe>'),$s=m('<pre class="text-sm dark:text-gray-400 whitespace-pre-line"> </pre>'),Ss=m('<div class="flex flex-col w-full gap-2"><!> <div><div class=" text-sm font-medium dark:text-gray-300 flex items-center gap-2 w-fit mb-1"> <!> <!></div> <!></div></div>'),Es=m('<div><div class=" flex justify-between dark:text-gray-300 px-4.5 pt-3 pb-2"><div class=" text-lg font-medium self-center flex items-center"><!></div> <button class="self-center"><!></button></div> <div class="flex flex-col md:flex-row w-full px-5 pb-5 md:space-x-4"><div class="flex flex-col w-full dark:text-gray-200 overflow-y-scroll max-h-[22rem] scrollbar-thin gap-1"></div></div></div>');function Ns(Pe,n){Rt(n,!1);const l=()=>Ae(S,"$i18n",f),[f,z]=Zt(),S=Jt("i18n");let b=u(n,"show",12,!1),R=u(n,"citation",8),q=u(n,"showPercentage",8,!1),K=u(n,"showRelevance",8,!0),N=$e([]);function A(se){return typeof se!="number"?null:se<0?0:se>1?100:Math.round(se*1e4)/100}function le(se){return se>=80?"bg-green-200 dark:bg-green-800 text-green-800 dark:text-green-200":se>=60?"bg-yellow-200 dark:bg-yellow-800 text-yellow-800 dark:text-yellow-200":se>=40?"bg-orange-200 dark:bg-orange-800 text-orange-800 dark:text-orange-200":"bg-red-200 dark:bg-red-800 text-red-800 dark:text-red-200"}const d=se=>{try{return decodeURIComponent(se)}catch{return se}};Lt(()=>(i(R()),e(N)),()=>{var se;R()&&(I(N,(se=R().document)==null?void 0:se.map((j,Q)=>{var oe,o;return{source:R().source,document:j,metadata:(oe=R().metadata)==null?void 0:oe[Q],distance:(o=R().distances)==null?void 0:o[Q]}})),e(N).every(j=>j.distance!==void 0)&&I(N,e(N).sort((j,Q)=>(Q.distance??1/0)-(j.distance??1/0))))}),sa(),zt(),mr(Pe,{size:"lg",get show(){return b()},set show(se){b(se)},children:(se,j)=>{var Q=Es(),oe=s(Q),o=s(oe),ie=s(o);{var _e=W=>{const c=be(()=>(e(N),t(()=>{var k;return(k=e(N))==null?void 0:k[0]})));var C=we(),v=ee(C);{var ae=k=>{{let _=be(()=>(i(e(c)),l(),t(()=>{var w,H;return(H=(w=e(c).source)==null?void 0:w.url)!=null&&H.includes("http")?l().t("Open link"):l().t("Open file")})));Mt(k,{className:"w-fit",get content(){return e(_)},placement:"top-start",tippyOptions:{duration:[500,0]},children:(w,H)=>{var y=bs(),h=s(y,!0);r(y),x((p,D)=>{Te(y,"href",p),U(h,D)},[()=>(i(e(c)),i(Ka),t(()=>{var p,D,T,F,E,Z,O,J;return(D=(p=e(c))==null?void 0:p.metadata)!=null&&D.file_id?`${Ka}/files/${(F=(T=e(c))==null?void 0:T.metadata)==null?void 0:F.file_id}/content${((Z=(E=e(c))==null?void 0:E.metadata)==null?void 0:Z.page)!==void 0?`#page=${e(c).metadata.page+1}`:""}`:(J=(O=e(c).source)==null?void 0:O.url)!=null&&J.includes("http")?e(c).source.url:"#"})),()=>(i(R()),t(()=>{var p,D;return d((D=(p=R())==null?void 0:p.source)==null?void 0:D.name)}))]),a(w,y)},$$slots:{default:!0}})}},B=k=>{var _=We();x(w=>U(_,w),[()=>(i(R()),t(()=>{var w,H;return d((H=(w=R())==null?void 0:w.source)==null?void 0:H.name)}))]),a(k,_)};g(v,k=>{i(e(c)),t(()=>{var _,w,H,y;return((w=(_=e(c))==null?void 0:_.metadata)==null?void 0:w.file_id)||((y=(H=e(c).source)==null?void 0:H.url)==null?void 0:y.includes("http"))})?k(ae):k(B,!1)})}a(W,C)},he=W=>{var c=We();x(C=>U(c,C),[()=>(l(),t(()=>l().t("Citation")))]),a(W,c)};g(ie,W=>{i(R()),t(()=>{var c,C;return(C=(c=R())==null?void 0:c.source)==null?void 0:C.name})?W(_e):W(he,!1)})}r(o);var ce=$(o,2),Ie=s(ce);Oa(Ie,{className:"size-5"}),r(ce),r(oe);var ve=$(oe,2),fe=s(ve);Ct(fe,5,()=>e(N),Wt,(W,c)=>{var C=Ss(),v=s(C);{var ae=F=>{var E=ws(),Z=s(E),O=s(Z,!0);r(Z);var J=$(Z,2);{let X=be(()=>(e(c),t(()=>JSON.stringify(e(c).metadata.parameters,null,2))));Fr(J,{readonly:!0,get value(){return e(X)}})}r(E),x(X=>U(O,X),[()=>(l(),t(()=>l().t("Parameters")))]),a(F,E)};g(v,F=>{e(c),t(()=>{var E;return(E=e(c).metadata)==null?void 0:E.parameters})&&F(ae)})}var B=$(v,2),k=s(B),_=s(k),w=$(_);{var H=F=>{{let E=be(()=>(l(),t(()=>l().t("Relevance"))));Mt(F,{className:"w-fit",get content(){return e(E)},placement:"top-start",tippyOptions:{duration:[500,0]},children:(Z,O)=>{var J=Ms(),X=s(J);{var G=xe=>{const L=be(()=>(e(c),t(()=>A(e(c).distance))));var ge=we(),P=ee(ge);{var M=V=>{var pe=ys(),ue=s(pe);r(pe),x((Se,Ee)=>{Oe(pe,1,Se),U(ue,`${Ee??""}%`)},[()=>(i(e(L)),t(()=>`px-1 rounded-sm font-medium ${le(e(L))}`)),()=>(i(e(L)),t(()=>e(L).toFixed(2)))]),a(V,pe)};g(P,V=>{typeof e(L)=="number"&&V(M)})}a(xe,ge)},re=xe=>{var L=we(),ge=ee(L);{var P=M=>{var V=ks(),pe=s(V);r(V),x(ue=>U(pe,`(${ue??""})`),[()=>(e(c),t(()=>{var ue;return(((ue=e(c))==null?void 0:ue.distance)??0).toFixed(4)}))]),a(M,V)};g(ge,M=>{e(c),t(()=>{var V;return typeof((V=e(c))==null?void 0:V.distance)=="number"})&&M(P)},!0)}a(xe,L)};g(X,xe=>{q()?xe(G):xe(re,!1)})}r(J),a(Z,J)},$$slots:{default:!0}})}};g(w,F=>{i(K()),e(c),t(()=>K()&&e(c).distance!==void 0)&&F(H)})}var y=$(w,2);{var h=F=>{var E=Is(),Z=s(E);r(E),x(O=>U(Z,`(${O??""}
										${e(c),t(()=>e(c).metadata.page+1)??""})`),[()=>(l(),t(()=>l().t("page")))]),a(F,E)};g(y,F=>{e(c),t(()=>{var E,Z;return Number.isInteger((Z=(E=e(c))==null?void 0:E.metadata)==null?void 0:Z.page)})&&F(h)})}r(k);var p=$(k,2);{var D=F=>{var E=Cs();x(Z=>{Te(E,"srcdoc",(e(c),t(()=>e(c).document))),Te(E,"title",Z)},[()=>(l(),t(()=>l().t("Content")))]),a(F,E)},T=F=>{var E=$s(),Z=s(E);r(E),x(()=>U(Z,`
                ${e(c),t(()=>e(c).document)??""}
              `)),a(F,E)};g(p,F=>{e(c),t(()=>{var E;return(E=e(c).metadata)==null?void 0:E.html})?F(D):F(T,!1)})}r(B),r(C),x(F=>U(_,`${F??""} `),[()=>(l(),t(()=>l().t("Content")))]),a(W,C)}),r(fe),r(ve),r(Q),Me("click",ce,()=>{b(!1)}),a(se,Q)},$$slots:{default:!0},$$legacy:!0}),jt(),z()}var Ps=m('<img alt="favicon" class="size-4 rounded-full shrink-0 border border-white dark:border-gray-850 bg-white dark:bg-gray-900"/>'),Bs=m('<div class="flex -space-x-1 items-center"></div>'),Ts=m('<div class=" py-1 -mx-0.5 w-full flex gap-1 items-center flex-wrap"><button class="text-xs font-medium text-gray-600 dark:text-gray-300 px-3.5 h-8 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 transition flex items-center gap-1 border border-gray-50 dark:border-gray-850"><!> <div><!></div></button></div>'),Ls=m('<button class="no-toggle outline-hidden flex dark:text-gray-300 bg-transparent text-gray-600 rounded-xl gap-1.5 items-center"><div class=" font-medium bg-gray-50 dark:bg-gray-850 rounded-md px-1"></div> <div class="flex-1 truncate hover:text-black dark:text-white/60 dark:hover:text-white transition text-left"> </div></button>'),Os=m('<div class="py-1.5"><div class="text-xs gap-2 flex flex-col"></div></div>'),Rs=m("<!> <!> <!>",1);function js(Pe,n){Rt(n,!1);const l=()=>Ae(S,"$i18n",f),[f,z]=Zt(),S=Jt("i18n");let b=u(n,"id",8,""),R=u(n,"sources",24,()=>[]),q=u(n,"readOnly",8,!1),K=$e([]),N=$e(!1),A=$e(!0),le=$e(!1),d=$e(!1),se=$e(null);const j=c=>{var C,v,ae,B;if(e(K)[c])if(e(K)[c],(v=(C=e(K)[c])==null?void 0:C.source)!=null&&v.embed_url){const k=e(K)[c].source.embed_url;if(k)if(q()){window.open(k,"_blank");return}else Aa.set(!0),or.set(!0),yr.set({title:((B=(ae=e(K)[c])==null?void 0:ae.source)==null?void 0:B.name)||"Embedded Content",url:k});else I(se,e(K)[c]),I(d,!0)}else I(se,e(K)[c]),I(d,!0)};function Q(c){const C=c.flatMap(B=>B.distances??[]),v=C.filter(B=>B!==void 0&&B>=-1&&B<=1).length,ae=C.filter(B=>B!==void 0&&(B<-1||B>1)).length;return!(C.length===0||v===C.length-1&&ae===1||ae===C.length-1&&v===1)}function oe(c){return c.flatMap(v=>v.distances??[]).every(v=>v!==void 0&&v>=-1&&v<=1)}const o=c=>{try{return decodeURIComponent(c)}catch{return c}};Lt(()=>(e(K),i(R())),()=>{I(K,R().reduce((c,C)=>{var v;return Object.keys(C).length===0||(v=C==null?void 0:C.document)==null||v.forEach((ae,B)=>{var h,p,D;const k=(h=C==null?void 0:C.metadata)==null?void 0:h[B],_=(p=C==null?void 0:C.distances)==null?void 0:p[B],w=(k==null?void 0:k.source)??((D=C==null?void 0:C.source)==null?void 0:D.id)??"N/A";let H=C==null?void 0:C.source;k!=null&&k.name&&(H={...H,name:k.name}),(w.startsWith("http://")||w.startsWith("https://"))&&(H={...H,name:w,url:w});const y=c.find(T=>T.id===w);y?(y.document.push(ae),y.metadata.push(k),_!==void 0&&y.distances.push(_)):c.push({id:w,source:H,document:[ae],metadata:k?[k]:[],distances:_!==void 0?[_]:[]})}),c},[])),e(K),I(A,Q(e(K))),I(N,oe(e(K)))}),sa();var ie={showSourceModal:j};zt();var _e=Rs(),he=ee(_e);Ns(he,{get citation(){return e(se)},get showPercentage(){return e(N)},get showRelevance(){return e(A)},get show(){return e(d)},set show(c){I(d,c)},$$legacy:!0});var ce=$(he,2);{var Ie=c=>{const C=be(()=>(e(K),t(()=>e(K).filter(h=>{var p,D;return(D=(p=h==null?void 0:h.source)==null?void 0:p.name)==null?void 0:D.startsWith("http")}))));var v=Ts(),ae=s(v),B=s(ae);{var k=h=>{var p=Bs();Ct(p,5,()=>(i(e(C)),t(()=>e(C).slice(0,3))),Wt,(D,T)=>{var F=Ps();x(()=>Te(F,"src",`https://www.google.com/s2/favicons?sz=32&domain=${e(T),t(()=>e(T).source.name)??""}`)),a(D,F)}),r(p),a(h,p)};g(B,h=>{i(e(C)),t(()=>e(C).length>0)&&h(k)})}var _=$(B,2),w=s(_);{var H=h=>{var p=We();x(D=>U(p,D),[()=>(l(),t(()=>l().t("1 Source")))]),a(h,p)},y=h=>{var p=We();x(D=>U(p,D),[()=>(l(),e(K),t(()=>l().t("{{COUNT}} Sources",{COUNT:e(K).length})))]),a(h,p)};g(w,h=>{e(K),t(()=>e(K).length===1)?h(H):h(y,!1)})}r(_),r(ae),r(v),Me("click",ae,()=>{I(le,!e(le))}),a(c,v)};g(ce,c=>{e(K),t(()=>e(K).length>0)&&c(Ie)})}var ve=$(ce,2);{var fe=c=>{var C=Os(),v=s(C);Ct(v,5,()=>e(K),Wt,(ae,B,k)=>{var _=Ls(),w=s(_);w.textContent=k+1;var H=$(w,2),y=s(H,!0);r(H),r(_),x(h=>{Te(_,"id",`source-${b()}-${k+1}`),U(y,h)},[()=>(e(B),t(()=>o(e(B).source.name)))]),Me("click",_,()=>{I(d,!0),I(se,e(B))}),a(ae,_)}),r(v),r(C),a(c,C)};g(ve,c=>{e(le)&&c(fe)})}a(Pe,_e),fr(n,"showSourceModal",j);var W=jt(ie);return z(),W}var zs=m("<div><!></div>"),As=m("<div><!></div>"),Hs=m('<div><div class=" text-gray-500 text-xs mb-1"> </div> <div class="text-sm"> </div></div>'),qs=m('<div><div class=" text-gray-500 text-xs mb-1"> </div> <div class="text-sm"> </div></div>'),Ws=m('<div class="dark:bg-[#202123] dark:text-white px-4 py-4 rounded-b-lg flex flex-col gap-3"><!> <!></div>'),Ds=m('<li><a target="_blank"> </a></li>'),Us=m('<div class="flex flex-col w-full"><hr class="border-gray-100 dark:border-gray-850 my-2"/> <div class=" text-sm font-medium dark:text-gray-300"> </div> <ul class="mt-1 list-disc pl-4 text-xs"></ul></div>'),Fs=m('<div><div class="flex justify-between dark:text-gray-300 px-5 pt-4 pb-2"><div class="text-lg font-medium self-center flex flex-col gap-0.5 capitalize"><!> <div class="flex gap-2 items-center"><!> <div><!></div></div></div> <button class="self-center"><!></button></div> <div class="flex flex-col md:flex-row w-full px-4 pb-5"><div class="flex flex-col w-full dark:text-gray-200 overflow-y-scroll max-h-[22rem] scrollbar-hidden"><div class="flex flex-col w-full"><!></div> <!> <!></div></div></div>');function Js(Pe,n){Rt(n,!1);const l=()=>Ae(S,"$i18n",f),[f,z]=Zt(),S=Jt("i18n");let b=u(n,"show",12,!1),R=u(n,"codeExecution",12,null);zt(),mr(Pe,{size:"lg",get show(){return b()},set show(q){b(q)},children:(q,K)=>{var N=Fs(),A=s(N),le=s(A),d=s(le);{var se=k=>{var _=zs(),w=s(_);{var H=h=>{Ra(h,{type:"error",content:"error"})},y=h=>{var p=we(),D=ee(p);{var T=E=>{Ra(E,{type:"success",content:"success"})},F=E=>{Ra(E,{type:"warning",content:"incomplete"})};g(D,E=>{i(R()),t(()=>{var Z;return(Z=R().result)==null?void 0:Z.output})?E(T):E(F,!1)},!0)}a(h,p)};g(w,h=>{i(R()),t(()=>{var p;return(p=R().result)==null?void 0:p.error})?h(H):h(y,!1)})}r(_),a(k,_)};g(d,k=>{i(R()),t(()=>{var _;return(_=R())==null?void 0:_.result})&&k(se)})}var j=$(d,2),Q=s(j);{var oe=k=>{var _=As(),w=s(_);Ga(w,{className:"size-4"}),r(_),a(k,_)};g(Q,k=>{i(R()),t(()=>{var _;return!((_=R())!=null&&_.result)})&&k(oe)})}var o=$(Q,2),ie=s(o);{var _e=k=>{var _=We();x(w=>U(_,`${w??""}: ${i(R()),t(()=>{var H;return(H=R())==null?void 0:H.name})??""}`),[()=>(l(),t(()=>l().t("Code execution")))]),a(k,_)},he=k=>{var _=We();x(w=>U(_,w),[()=>(l(),t(()=>l().t("Code execution")))]),a(k,_)};g(ie,k=>{i(R()),t(()=>{var _;return(_=R())==null?void 0:_.name})?k(_e):k(he,!1)})}r(o),r(j),r(le);var ce=$(le,2),Ie=s(ce);Oa(Ie,{className:"size-5"}),r(ce),r(A);var ve=$(A,2),fe=s(ve),W=s(fe),c=s(W);{let k=be(()=>(i(R()),t(()=>{var y;return(y=R())==null?void 0:y.id}))),_=be(()=>(i(R()),t(()=>{var y;return((y=R())==null?void 0:y.language)??""}))),w=be(()=>(i(R()),t(()=>{var y;return((y=R())==null?void 0:y.code)??""}))),H=be(()=>(i(R()),t(()=>{var y,h,p,D,T;return(y=R())!=null&&y.result&&((p=(h=R())==null?void 0:h.result)!=null&&p.error||(T=(D=R())==null?void 0:D.result)!=null&&T.output)?"rounded-b-none":""})));Ar(c,{get id(){return`code-exec-${e(k)??""}-code`},get lang(){return e(_)},get code(){return e(w)},className:"",get editorClassName(){return e(H)},run:!1})}r(W);var C=$(W,2);{var v=k=>{var _=Ws(),w=s(_);{var H=p=>{var D=Hs(),T=s(D),F=s(T,!0);r(T);var E=$(T,2),Z=s(E,!0);r(E),r(D),x(O=>{U(F,O),U(Z,(i(R()),t(()=>{var J,X;return(X=(J=R())==null?void 0:J.result)==null?void 0:X.error})))},[()=>(l(),t(()=>l().t("ERROR")))]),a(p,D)};g(w,p=>{i(R()),t(()=>{var D,T;return(T=(D=R())==null?void 0:D.result)==null?void 0:T.error})&&p(H)})}var y=$(w,2);{var h=p=>{var D=qs(),T=s(D),F=s(T,!0);r(T);var E=$(T,2),Z=s(E,!0);r(E),r(D),x(O=>{U(F,O),U(Z,(i(R()),t(()=>{var J,X;return(X=(J=R())==null?void 0:J.result)==null?void 0:X.output})))},[()=>(l(),t(()=>l().t("OUTPUT")))]),a(p,D)};g(y,p=>{i(R()),t(()=>{var D,T;return(T=(D=R())==null?void 0:D.result)==null?void 0:T.output})&&p(h)})}r(_),a(k,_)};g(C,k=>{i(R()),t(()=>{var _,w,H,y,h;return((_=R())==null?void 0:_.result)&&(((H=(w=R())==null?void 0:w.result)==null?void 0:H.error)||((h=(y=R())==null?void 0:y.result)==null?void 0:h.output))})&&k(v)})}var ae=$(C,2);{var B=k=>{var _=Us(),w=$(s(_),2),H=s(w,!0);r(w);var y=$(w,2);Ct(y,5,()=>(i(R()),t(()=>{var h,p;return(p=(h=R())==null?void 0:h.result)==null?void 0:p.files})),Wt,(h,p)=>{var D=Ds(),T=s(D),F=s(T,!0);r(T),r(D),x(()=>{Te(T,"href",(e(p),t(()=>e(p).url))),U(F,(e(p),t(()=>e(p).name)))}),a(h,D)}),r(y),r(_),x(h=>U(H,h),[()=>(l(),t(()=>l().t("Files")))]),a(k,_)};g(ae,k=>{i(R()),t(()=>{var _,w,H,y;return((w=(_=R())==null?void 0:_.result)==null?void 0:w.files)&&((y=(H=R())==null?void 0:H.result)==null?void 0:y.files.length)>0})&&k(B)})}r(fe),r(ve),r(N),Me("click",ce,()=>{b(!1),R(null)}),a(q,N)},$$slots:{default:!0},$$legacy:!0}),jt(),z()}var Vs=m('<div class="flex gap-1 text-xs font-semibold svelte-tclqny"><button class="flex dark:text-gray-300 py-1 px-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-850 dark:hover:bg-gray-800 transition rounded-xl max-w-96 svelte-tclqny"><div class="bg-white dark:bg-gray-700 rounded-full size-4 flex items-center justify-center svelte-tclqny"><!></div> <div> </div></button></div>'),Zs=m('<div class="mt-1 mb-2 w-full flex gap-1 items-center flex-wrap svelte-tclqny"></div>'),Gs=m("<!> <!>",1);function Ks(Pe,n){Rt(n,!1);let l=u(n,"codeExecutions",24,()=>[]),f=$e(null),z=$e(!1);const S=()=>{e(f)&&I(f,l().find(N=>N.id===e(f).id))};Lt(()=>i(l()),()=>{l()&&S()}),sa(),zt();var b=Gs(),R=ee(b);Js(R,{get codeExecution(){return e(f)},get show(){return e(z)},set show(N){I(z,N)},$$legacy:!0});var q=$(R,2);{var K=N=>{var A=Zs();Ct(A,5,l,le=>le.id,(le,d)=>{var se=Vs(),j=s(se),Q=s(j),oe=s(Q);{var o=ce=>{var Ie=we(),ve=ee(Ie);{var fe=c=>{Oa(c,{})},W=c=>{var C=we(),v=ee(C);{var ae=k=>{Jr(k,{strokeWidth:"3",className:"size-3"})},B=k=>{Vr(k,{})};g(v,k=>{e(d),t(()=>{var _;return(_=e(d).result)==null?void 0:_.output})?k(ae):k(B,!1)},!0)}a(c,C)};g(ve,c=>{e(d),t(()=>{var C;return(C=e(d).result)==null?void 0:C.error})?c(fe):c(W,!1)})}a(ce,Ie)},ie=ce=>{Ga(ce,{className:"size-4"})};g(oe,ce=>{e(d),t(()=>{var Ie;return(Ie=e(d))==null?void 0:Ie.result})?ce(o):ce(ie,!1)})}r(Q);var _e=$(Q,2),he=s(_e,!0);r(_e),r(j),r(se),x(()=>{Oe(_e,1,`flex-1 mx-2 line-clamp-1 code-execution-name ${e(d),t(()=>{var ce;return(ce=e(d))!=null&&ce.result?"":"pulse"})??""}`,"svelte-tclqny"),U(he,(e(d),t(()=>e(d).name)))}),Me("click",j,()=>{I(f,e(d)),I(z,!0)}),a(le,se)}),r(A),a(N,A)};g(q,N=>{i(l()),t(()=>l().length>0)&&N(K)})}a(Pe,b),jt()}var Qs=m('<button class="px-1.5 py-[1px] hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl flex items-center gap-1 min-w-fit transition"><!> <div class="shrink-0"> </div></button>'),Ys=m('<div class="flex flex-row shrink-0 p-0.5 bg-white dark:bg-gray-850 dark:text-gray-100 text-medium rounded-xl shadow-xl border border-gray-100 dark:border-gray-800"></div>'),Xs=m('<div class="py-1 flex dark:text-gray-100 bg-white dark:bg-gray-850 border border-gray-100 dark:border-gray-800 w-72 rounded-full shadow-xl"><input type="text" id="floating-message-input" class="ml-5 bg-transparent outline-hidden w-full flex-1 text-sm"/> <div class="ml-1 mr-1"><button><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path fill-rule="evenodd" d="M8 14a.75.75 0 0 1-.75-.75V4.56L4.03 7.78a.75.75 0 0 1-1.06-1.06l4.5-4.5a.75.75 0 0 1 1.06 0l4.5 4.5a.75.75 0 0 1-1.06 1.06L8.75 4.56v8.69A.75.75 0 0 1 8 14Z" clip-rule="evenodd"></path></svg></button></div></div>'),en=m('<div class="flex justify-end pt-3 text-sm font-medium"><button class="px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full"> </button></div>'),tn=m('<div class="bg-white dark:bg-gray-850 dark:text-gray-100 rounded-3xl shadow-xl w-80 max-w-full border border-gray-100 dark:border-gray-800"><div class="bg-white dark:bg-gray-850 dark:text-gray-100 text-medium rounded-3xl px-3.5 pt-3 w-full"><div class="font-medium"><!></div></div> <div class="bg-white dark:bg-gray-850 dark:text-gray-100 text-medium rounded-4xl w-full"><div class=" max-h-80 overflow-y-auto w-full markdown-prose-xs px-3.5 py-3" id="response-container"><!> <!></div></div></div>'),an=m('<div class="absolute rounded-lg mt-1 text-xs z-9999" style="display: none"><!></div>');function rn(Pe,n){Rt(n,!1);const l=()=>Ae(q,"$i18n",b),f=()=>Ae(ba,"$models",b),z=()=>Ae(kr,"$socket",b),S=()=>Ae(ir,"$chatId",b),[b,R]=Zt(),q=Jt("i18n");let K=u(n,"id",8,""),N=u(n,"messageId",8,""),A=u(n,"model",8,null),le=u(n,"messages",24,()=>[]),d=u(n,"actions",28,()=>[]),se=u(n,"onAdd",8,w=>{}),j=$e(!1),Q=$e(null),oe=$e(""),o=$e(""),ie=$e(""),_e=$e(null),he=$e(!1),ce=null;const Ie=[{id:"ask",label:l().t("Ask"),icon:Kr,input:!0,prompt:`{{SELECTED_CONTENT}}


{{INPUT_CONTENT}}`},{id:"explain",label:l().t("Explain"),icon:Hr,prompt:`{{SELECTED_CONTENT}}


${l().t("Explain")}`}],ve=async()=>{const w=document.getElementById("response-container");w&&w.scrollHeight-w.clientHeight<=w.scrollTop+50&&(w.scrollTop=w.scrollHeight)},fe=async w=>{var Z;if(!A()){Ut.error(l().t("Model not selected"));return}let H=e(oe).split(`
`).map(O=>`> ${O}`).join(`
`),y=d().find(O=>O.id===w);if(!y){Ut.error(l().t("Action not found"));return}let h=(y==null?void 0:y.prompt)??"",p=[];const D=/\{\{(.*?)\|tool:id="([^"]+)"\}\}/g;h=h.replace(D,(O,J,X)=>(p.push(X),J));let T=/\{\{TOOL:([^\}]+)\}\}/g,F;for(;(F=T.exec(h))!==null;)p.push(F[1]);h=h.replace(T,""),h.includes("{{INPUT_CONTENT}}")&&e(j)&&(h=h.replace("{{INPUT_CONTENT}}",e(o)),I(o,"")),h=h.replace("{{CONTENT}}",e(oe)),h=h.replace("{{SELECTED_CONTENT}}",H),I(ie,h),I(_e,"");let E;if([E,ce]=await Gr(localStorage.token,{model:A(),model_item:f().find(O=>O.id===A()),session_id:(Z=z())==null?void 0:Z.id,chat_id:S(),messages:[...le(),{role:"user",content:e(ie)}].map(O=>({role:O.role,content:O.content})),...p.length>0?{tool_ids:p}:{},stream:!0}),E&&E.ok){const O=E.body.getReader(),J=new TextDecoder,X=async()=>{var G,re;for(;;){const{done:xe,value:L}=await O.read();if(xe)break;const P=J.decode(L,{stream:!0}).split(`
`).filter(M=>M.trim()!=="");for(const M of P)if(M.startsWith("data: "))if(M.startsWith("data: [DONE]")){I(he,!0),await at(),ve();continue}else try{const V=JSON.parse(M.slice(6));V.choices&&((re=(G=V.choices[0])==null?void 0:G.delta)!=null&&re.content)&&(I(_e,e(_e)+V.choices[0].delta.content),ve())}catch(V){}}};try{await X()}catch(G){G.name}}else Ut.error(l().t("An error occurred while fetching the explanation"))},W=async()=>{const w=[{role:"user",content:e(ie)},{role:"assistant",content:e(_e)}];se()({modelId:A(),parentId:N(),messages:w})},c=()=>{ce&&ce.abort(),I(Q,null),I(oe,""),I(_e,null),I(he,!1),I(j,!1),I(o,"")};nr(()=>{ce&&ce.abort()}),Lt(()=>i(d()),()=>{d().length===0&&d(Ie)}),sa();var C={closeHandler:c};zt();var v=an(),ae=s(v);{var B=w=>{var H=we(),y=ee(H);{var h=D=>{var T=Ys();Ct(T,5,d,Wt,(F,E)=>{var Z=Qs(),O=s(Z);{var J=re=>{var xe=we(),L=ee(xe);Zr(L,()=>e(E).icon,(ge,P)=>{P(ge,{className:"size-3 shrink-0"})}),a(re,xe)};g(O,re=>{e(E),t(()=>e(E).icon)&&re(J)})}var X=$(O,2),G=s(X,!0);r(X),r(Z),x(()=>U(G,(e(E),t(()=>e(E).label)))),Me("click",Z,async()=>{I(oe,window.getSelection().toString()),I(Q,e(E)),e(E).prompt.includes("{{INPUT_CONTENT}}")?(I(j,!0),I(o,""),await at(),setTimeout(()=>{const re=document.getElementById("floating-message-input");re&&re.focus()},0)):fe(e(E).id)}),a(F,Z)}),r(T),a(D,T)},p=D=>{var T=Xs(),F=s(T);Ca(F);var E=$(F,2),Z=s(E);r(E),r(T),x(O=>{Te(F,"placeholder",O),Oe(Z,1,`${e(o)!==""?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled"} transition rounded-full p-1.5 m-0.5 self-center`)},[()=>(l(),t(()=>l().t("Ask a question")))]),Na(F,()=>e(o),O=>I(o,O)),Me("keydown",F,O=>{var J;O.key==="Enter"&&fe((J=e(Q))==null?void 0:J.id)}),Me("click",Z,()=>{var O;fe((O=e(Q))==null?void 0:O.id)}),a(D,T)};g(y,D=>{e(j)?D(p,!1):D(h)})}a(w,H)},k=w=>{var H=tn(),y=s(H),h=s(y),p=s(h);{let X=be(()=>`${K()}-float-prompt`);$a(p,{get id(){return e(X)},get content(){return e(ie)}})}r(h),r(y);var D=$(y,2),T=s(D),F=s(T);{var E=X=>{Za(X,{size:"sm"})},Z=X=>{{let G=be(()=>`${K()}-float-response`);$a(X,{get id(){return e(G)},get content(){return e(_e)}})}};g(F,X=>{e(_e),t(()=>{var G;return!e(_e)||((G=e(_e))==null?void 0:G.trim())===""})?X(E):X(Z,!1)})}var O=$(F,2);{var J=X=>{var G=en(),re=s(G),xe=s(re,!0);r(re),r(G),x(L=>U(xe,L),[()=>(l(),t(()=>l().t("Add")))]),Me("click",re,W),a(X,G)};g(O,X=>{e(he)&&X(J)})}r(T),r(D),r(H),a(w,H)};g(ae,w=>{e(_e)===null?w(B):w(k,!1)})}r(v),x(()=>Te(v,"id",`floating-buttons-${K()}`)),a(Pe,v),fr(n,"closeHandler",c);var _=jt(C);return R(),_}var sn=m("<div><!></div> <!>",1);function nn(Pe,n){Rt(n,!1);const l=()=>Ae(lr,"$mobile",S),f=()=>Ae(fa,"$settings",S),z=()=>Ae(ir,"$chatId",S),[S,b]=Zt();Jt("i18n");let R=u(n,"id",8),q=u(n,"content",8),K=u(n,"history",8),N=u(n,"messageId",8),A=u(n,"selectedModels",24,()=>[]),le=u(n,"done",8,!0),d=u(n,"model",8,null),se=u(n,"sources",8,null),j=u(n,"save",8,!1),Q=u(n,"preview",8,!1),oe=u(n,"floatingButtons",8,!0),o=u(n,"editCodeBlock",8,!0),ie=u(n,"topPadding",8,!1),_e=u(n,"onSave",8,w=>{}),he=u(n,"onSourceClick",8,w=>{}),ce=u(n,"onTaskClick",8,w=>{}),Ie=u(n,"onAddMessages",8,w=>{}),ve=$e(),fe=$e();const W=w=>{var y;const H=document.getElementById(`floating-buttons-${R()}`);if(!((y=e(ve))!=null&&y.contains(w.target))&&!(H!=null&&H.contains(w.target))){c();return}setTimeout(async()=>{var p;if(await at(),!((p=e(ve))!=null&&p.contains(w.target)))return;let h=window.getSelection();if(h.toString().trim().length>0){const T=h.getRangeAt(0).getBoundingClientRect(),F=e(ve).getBoundingClientRect(),E=T.bottom-F.top,Z=T.left-F.left;if(H){H.style.display="block";const O=F.width-Z;let J=l()?window.innerWidth/2:window.innerWidth/3;if(O<J){const X=F.right-T.right;H.style.right=`${X}px`,H.style.left="auto"}else H.style.left=`${Z}px`,H.style.right="auto";H.style.top=`${E+5}px`}}else c()},0)},c=()=>{var H,y;const w=document.getElementById(`floating-buttons-${R()}`);w&&(w.style.display="none"),e(fe)&&typeof((H=e(fe))==null?void 0:H.closeHandler)=="function"&&((y=e(fe))==null||y.closeHandler())},C=w=>{w.key==="Escape"&&c()};xa(()=>{var w;oe()&&((w=e(ve))==null||w.addEventListener("mouseup",W),document.addEventListener("mouseup",W),document.addEventListener("keydown",C))}),nr(()=>{var w;oe()&&((w=e(ve))==null||w.removeEventListener("mouseup",W),document.removeEventListener("mouseup",W),document.removeEventListener("keydown",C))}),zt();var v=sn(),ae=ee(v),B=s(ae);{let w=be(()=>(i(se()),i(d()),t(()=>(se()??[]).reduce((H,y)=>{let h=[];return y.document.forEach((p,D)=>{var E,Z,O,J,X,G;if(((J=(O=(Z=(E=d())==null?void 0:E.info)==null?void 0:Z.meta)==null?void 0:O.capabilities)==null?void 0:J.citations)==!1)return h.push("N/A"),h;const T=(X=y.metadata)==null?void 0:X[D],F=(T==null?void 0:T.source)??"N/A";return T!=null&&T.name?(h.push(T.name),h):(F.startsWith("http://")||F.startsWith("https://")?h.push(F):h.push(((G=y==null?void 0:y.source)==null?void 0:G.name)??F),h)}),H=[...H,...h],H.filter((p,D)=>H.indexOf(p)===D)},[]))));$a(B,{get id(){return R()},get content(){return q()},get model(){return d()},get save(){return j()},get preview(){return Q()},get done(){return le()},get editCodeBlock(){return o()},get topPadding(){return ie()},get sourceIds(){return e(w)},get onSourceClick(){return he()},get onTaskClick(){return ce()},get onSave(){return _e()},onUpdate:async H=>{var p;const{lang:y,text:h}=H;(((p=f())==null?void 0:p.detectArtifacts)??!0)&&(["html","svg"].includes(y)||y==="xml"&&h.includes("svg"))&&!l()&&z()&&(await at(),Qa.set(!0),Aa.set(!0))},onPreview:async H=>{await Mr.set(H),await Aa.set(!0),await Qa.set(!0),await Ir.set(!1),await or.set(!1)}})}r(ae),pa(ae,w=>I(ve,w),()=>e(ve));var k=$(ae,2);{var _=w=>{{let H=be(()=>(f(),t(()=>{var p;return((p=f())==null?void 0:p.floatingActionButtons)??[]}))),y=be(()=>(i(A()),i(d()),t(()=>{var p,D,T;return(A()??[]).includes((p=d())==null?void 0:p.id)?(D=d())==null?void 0:D.id:(A()??[]).length>0?A().at(0):(T=d())==null?void 0:T.id}))),h=be(()=>(i(Ha),i(K()),i(N()),t(()=>Ha(K(),N()))));pa(rn(w,{get id(){return R()},get messageId(){return N()},get actions(){return e(H)},get model(){return e(y)},get messages(){return e(h)},onAdd:({modelId:p,parentId:D,messages:T})=>{Ie()({modelId:p,parentId:D,messages:T}),c()},$$legacy:!0}),p=>I(fe,p),()=>e(fe))}};g(k,w=>{oe()&&d()&&w(_)})}a(Pe,v),jt(),b()}function on(Pe){return new Worker(""+new URL("../workers/kokoro.worker-DH_kWnDg.js",import.meta.url).href,{type:"module",name:Pe==null?void 0:Pe.name})}class ln{constructor(n="fp32"){ma(this,"worker",null);ma(this,"initialized",!1);ma(this,"dtype");ma(this,"requestQueue",[]);ma(this,"processing",!1);this.dtype=n}async init(){if(this.worker){console.warn("KokoroWorker is already initialized.");return}return this.worker=new on,this.worker.onmessage=n=>{const{status:l,error:f,audioUrl:z}=n.data;if(l==="init:complete")this.initialized=!0;else if(l==="init:error")this.initialized=!1;else if(l==="generate:complete"){const S=this.requestQueue.shift();S&&(S.resolve(z),this.processNextRequest())}else if(l==="generate:error"){const S=this.requestQueue.shift();S&&(S.reject(new Error(f)),this.processNextRequest())}},new Promise((n,l)=>{this.worker.postMessage({type:"init",payload:{dtype:this.dtype}});const f=z=>{z.data.status==="init:complete"?(this.worker.removeEventListener("message",f),this.initialized=!0,n()):z.data.status==="init:error"&&(this.worker.removeEventListener("message",f),l(new Error(z.data.error)))};this.worker.addEventListener("message",f)})}async generate({text:n,voice:l}){if(!this.initialized||!this.worker)throw new Error("KokoroTTS Worker is not initialized yet.");return new Promise((f,z)=>{this.requestQueue.push({text:n,voice:l,resolve:f,reject:z}),this.processing||this.processNextRequest()})}processNextRequest(){if(this.requestQueue.length===0){this.processing=!1;return}this.processing=!0;const{text:n,voice:l}=this.requestQueue[0];this.worker.postMessage({type:"generate",payload:{text:n,voice:l}})}terminate(){this.worker&&(this.worker.terminate(),this.worker=null,this.initialized=!1,this.requestQueue=[],this.processing=!1)}}var dn=m('<div class=" py-1.5 bg-transparent text-left text-sm flex items-center gap-2 text-gray-500 dark:text-gray-400 hover:text-black dark:hover:text-white transition cursor-pointer"><div class="line-clamp-1"> </div></div>'),vn=m('<hr class="border-gray-50 dark:border-gray-850"/>'),cn=m("<!> <!>",1),gn=m('<div class="mt-4"><div class="text-sm font-medium"> </div> <div class="flex flex-col text-left gap-1 mt-1.5"></div></div>');function un(Pe,n){Rt(n,!1);const l=()=>Ae(S,"$i18n",f),[f,z]=Zt(),S=Jt("i18n");let b=u(n,"followUps",24,()=>[]),R=u(n,"onClick",8,()=>{});zt();var q=gn(),K=s(q),N=s(K,!0);r(K);var A=$(K,2);Ct(A,5,b,Wt,(le,d,se)=>{var j=cn(),Q=ee(j);Mt(Q,{get content(){return e(d)},placement:"top-start",className:"line-clamp-1",children:(ie,_e)=>{var he=dn(),ce=s(he),Ie=s(ce,!0);r(ce),r(he),x(()=>{Te(he,"aria-label",e(d)),U(Ie,e(d))}),Me("click",he,()=>R()(e(d))),a(ie,he)},$$slots:{default:!0}});var oe=$(Q,2);{var o=ie=>{var _e=vn();a(ie,_e)};g(oe,ie=>{i(b()),t(()=>se<b().length-1)&&ie(o)})}a(le,j)}),r(A),r(q),x(le=>U(N,le),[()=>(l(),t(()=>l().t("Follow up")))]),a(Pe,q),jt(),z()}var fn=ua('<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path d="M11 6H21" stroke-linecap="round" stroke-linejoin="round"></path><path d="M11 12H21" stroke-linecap="round" stroke-linejoin="round"></path><path d="M11 18H21" stroke-linecap="round" stroke-linejoin="round"></path><path d="M5 19V5M5 19L3 16.5M5 19L7 16.5M5 5L3 7M5 5L7 7" stroke-linecap="round" stroke-linejoin="round"></path></svg>');function mn(Pe,n){let l=u(n,"className",8,"size-4"),f=u(n,"strokeWidth",8,"1.5");var z=fn();x(()=>{Te(z,"stroke-width",f()),Oe(z,0,Ea(l()))}),a(Pe,z)}var hn=ua('<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path d="M11 6H21" stroke-linecap="round" stroke-linejoin="round"></path><path d="M11 12H21" stroke-linecap="round" stroke-linejoin="round"></path><path d="M11 18H21" stroke-linecap="round" stroke-linejoin="round"></path><path d="M5 19V5M5 10L3 8M5 10L7 8M5 14L3 16M5 14L7 16" stroke-linecap="round" stroke-linejoin="round"></path></svg>');function _n(Pe,n){let l=u(n,"className",8,"size-4"),f=u(n,"strokeWidth",8,"1.5");var z=hn();x(()=>{Te(z,"stroke-width",f()),Oe(z,0,Ea(l()))}),a(Pe,z)}var pn=m('<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" aria-hidden="true" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99"></path></svg> <div class="flex items-center"> </div>',1),xn=m('<!> <div class="flex items-center"> </div>',1),bn=m('<!> <div class="flex items-center"> </div>',1),wn=m('<div class="py-1.5 px-2.5 flex dark:text-gray-100"><input type="text" id="floating-message-input" class="bg-transparent outline-hidden w-full flex-1 text-sm" autocomplete="off"/> <div class="ml-2 self-center flex items-center"><button><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-3.5"><path fill-rule="evenodd" d="M8 14a.75.75 0 0 1-.75-.75V4.56L4.03 7.78a.75.75 0 0 1-1.06-1.06l4.5-4.5a.75.75 0 0 1 1.06 0l4.5 4.5a.75.75 0 0 1-1.06 1.06L8.75 4.56v8.69A.75.75 0 0 1 8 14Z" clip-rule="evenodd"></path></svg></button></div></div> <hr class="border-gray-50 dark:border-gray-800 my-1 mx-2"/> <!> <!> <!>',1),yn=m('<div slot="content"><!></div>');function kn(Pe,n){Rt(n,!1);const l=()=>Ae(S,"$i18n",f),[f,z]=Zt(),S=Jt("i18n");let b=u(n,"onRegenerate",8,(N=null)=>{}),R=u(n,"onClose",8,()=>{}),q=$e(!1),K=$e("");zt(),Xr(Pe,{align:"end",get show(){return e(q)},set show(N){I(q,N)},$$events:{change:N=>{N.detail===!1&&R()()}},children:(N,A)=>{var le=we(),d=ee(le);hr(d,n,"default",{},null),a(N,le)},$$slots:{default:!0,content:(N,A)=>{var le=yn(),d=s(le);Qr(d,{class:"w-full max-w-[200px] rounded-2xl px-1 py-1 border border-gray-100 dark:border-gray-800 z-50 bg-white dark:bg-gray-850 dark:text-white shadow-lg transition",sideOffset:-2,side:"bottom",align:"start",get transition(){return Yr},children:(se,j)=>{var Q=wn(),oe=ee(Q),o=s(oe);Ca(o);var ie=$(o,2),_e=s(ie);r(ie),r(oe);var he=$(oe,4);ja(he,{class:"flex  gap-2  items-center px-3 py-1.5 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl",$$events:{click:()=>{b()(),I(q,!1)}},children:(ve,fe)=>{var W=pn(),c=$(ee(W),2),C=s(c,!0);r(c),x(v=>U(C,v),[()=>(l(),t(()=>l().t("Try Again")))]),a(ve,W)},$$slots:{default:!0}});var ce=$(he,2);ja(ce,{class:"flex  gap-2  items-center px-3 py-1.5 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl",$$events:{click:()=>{b()(l().t("Add Details"))}},children:(ve,fe)=>{var W=xn(),c=ee(W);mn(c,{strokeWidth:"2"});var C=$(c,2),v=s(C,!0);r(C),x(ae=>U(v,ae),[()=>(l(),t(()=>l().t("Add Details")))]),a(ve,W)},$$slots:{default:!0}});var Ie=$(ce,2);ja(Ie,{class:"flex  gap-2  items-center px-3 py-1.5 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl",$$events:{click:()=>{b()(l().t("More Concise"))}},children:(ve,fe)=>{var W=bn(),c=ee(W);_n(c,{strokeWidth:"2"});var C=$(c,2),v=s(C,!0);r(C),x(ae=>U(v,ae),[()=>(l(),t(()=>l().t("More Concise")))]),a(ve,W)},$$slots:{default:!0}}),x(ve=>{Te(o,"placeholder",ve),Oe(_e,1,`${e(K)!==""?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled"} transition rounded-full p-1 self-center`)},[()=>(l(),t(()=>l().t("Suggest a change")))]),Na(o,()=>e(K),ve=>I(K,ve)),Me("keydown",o,ve=>{ve.key==="Enter"&&(b()(e(K)),I(q,!1))}),Me("click",_e,()=>{b()(e(K)),I(q,!1)}),a(se,Q)},$$slots:{default:!0}}),r(le),a(N,le)}},$$legacy:!0}),jt(),z()}var Mn=m('<div class="flex flex-col justify-center -space-y-0.5"><div><!></div></div>'),In=m('<div class="flex flex-col justify-center -space-y-0.5"><div> </div></div>'),Cn=m('<div class="bg-gray-50 dark:bg-gray-850 flex rounded-lg py-1 px-2 items-center gap-1 text-xs"><div><!></div> <span class="line-clamp-1"> </span></div>'),$n=m('<div class="flex flex-col justify-center -space-y-0.5"><div> </div> <div class=" flex gap-1 flex-wrap mt-2"></div></div>'),Sn=m('<div class="bg-gray-50 dark:bg-gray-850 flex rounded-lg py-1 px-2 items-center gap-1 text-xs"><div><!></div> <span class="line-clamp-1"> </span></div>'),En=m('<div class="flex flex-col justify-center -space-y-0.5"><div> </div> <div class=" flex gap-1 flex-wrap mt-2"></div></div>'),Nn=m('<div class="flex flex-col justify-center -space-y-0.5"><div><!></div></div>'),Pn=m('<div class="flex flex-col justify-center -space-y-0.5"><div><!></div></div>'),Bn=m('<div class="status-description flex items-center gap-2 py-0.5 w-full text-left"><!></div>');function sr(Pe,n){Rt(n,!1);const l=()=>Ae(S,"$i18n",f),[f,z]=Zt(),S=Jt("i18n");let b=u(n,"status",8,null),R=u(n,"done",8,!1);zt();var q=we(),K=ee(q);{var N=A=>{var le=Bn(),d=s(le);{var se=Q=>{_s(Q,{get status(){return b()},children:(oe,o)=>{var ie=Mn(),_e=s(ie),he=s(_e);{var ce=ve=>{var fe=We();x(W=>U(fe,W),[()=>(l(),i(b()),t(()=>{var W,c,C;return l().t((W=b())==null?void 0:W.description,{count:(((c=b())==null?void 0:c.urls)||((C=b())==null?void 0:C.items)).length})}))]),a(ve,fe)},Ie=ve=>{var fe=we(),W=ee(fe);{var c=v=>{var ae=We();x(B=>U(ae,B),[()=>(l(),t(()=>l().t("No search query generated")))]),a(v,ae)},C=v=>{var ae=we(),B=ee(ae);{var k=w=>{var H=We();x(y=>U(H,y),[()=>(l(),t(()=>l().t("Generating search query")))]),a(w,H)},_=w=>{var H=We();x(()=>U(H,(i(b()),t(()=>{var y;return(y=b())==null?void 0:y.description})))),a(w,H)};g(B,w=>{i(b()),t(()=>{var H;return((H=b())==null?void 0:H.description)==="Generating search query"})?w(k):w(_,!1)},!0)}a(v,ae)};g(W,v=>{i(b()),t(()=>{var ae;return((ae=b())==null?void 0:ae.description)==="No search query generated"})?v(c):v(C,!1)},!0)}a(ve,fe)};g(he,ve=>{i(b()),t(()=>{var fe,W;return(W=(fe=b())==null?void 0:fe.description)==null?void 0:W.includes("{{count}}")})?ve(ce):ve(Ie,!1)})}r(_e),r(ie),x(()=>Oe(_e,1,`${i(R()),i(b()),t(()=>{var ve;return(R()||((ve=b())==null?void 0:ve.done))===!1?"shimmer":""})??""} text-base line-clamp-1 text-wrap`)),a(oe,ie)},$$slots:{default:!0}})},j=Q=>{var oe=we(),o=ee(oe);{var ie=he=>{var ce=In(),Ie=s(ce),ve=s(Ie,!0);r(Ie),r(ce),x(fe=>{Oe(Ie,1,`${i(R()),i(b()),t(()=>{var W;return(R()||((W=b())==null?void 0:W.done))===!1?"shimmer":""})??""} text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap`),U(ve,fe)},[()=>(l(),i(b()),t(()=>l().t('Searching Knowledge for "{{searchQuery}}"',{searchQuery:b().query})))]),a(he,ce)},_e=he=>{var ce=we(),Ie=ee(ce);{var ve=W=>{var c=$n(),C=s(c),v=s(C,!0);r(C);var ae=$(C,2);Ct(ae,7,()=>(i(b()),t(()=>b().queries)),B=>B,(B,k)=>{var _=Cn(),w=s(_),H=s(w);Da(H,{className:"size-3"}),r(w);var y=$(w,2),h=s(y,!0);r(y),r(_),x(()=>U(h,e(k))),a(B,_)}),r(ae),r(c),x(B=>{Oe(C,1,`${i(R()),i(b()),t(()=>{var k;return(R()||((k=b())==null?void 0:k.done))===!1?"shimmer":""})??""} text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap`),U(v,B)},[()=>(l(),t(()=>l().t("Searching")))]),a(W,c)},fe=W=>{var c=we(),C=ee(c);{var v=B=>{var k=En(),_=s(k),w=s(_,!0);r(_);var H=$(_,2);Ct(H,7,()=>(i(b()),t(()=>b().queries)),y=>y,(y,h)=>{var p=Sn(),D=s(p),T=s(D);Da(T,{className:"size-3"}),r(D);var F=$(D,2),E=s(F,!0);r(F),r(p),x(()=>U(E,e(h))),a(y,p)}),r(H),r(k),x(y=>{Oe(_,1,`${i(R()),i(b()),t(()=>{var h;return(R()||((h=b())==null?void 0:h.done))===!1?"shimmer":""})??""} text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap`),U(w,y)},[()=>(l(),t(()=>l().t("Querying")))]),a(B,k)},ae=B=>{var k=we(),_=ee(k);{var w=y=>{var h=Nn(),p=s(h),D=s(p);{var T=E=>{var Z=We();x(O=>U(Z,O),[()=>(l(),t(()=>l().t("No sources found")))]),a(E,Z)},F=E=>{var Z=we(),O=ee(Z);{var J=G=>{var re=We();x(xe=>U(re,xe),[()=>(l(),t(()=>l().t("Retrieved 1 source")))]),a(G,re)},X=G=>{var re=We();x(xe=>U(re,xe),[()=>(l(),i(b()),t(()=>l().t("Retrieved {{count}} sources",{count:b().count})))]),a(G,re)};g(O,G=>{i(b()),t(()=>b().count===1)?G(J):G(X,!1)},!0)}a(E,Z)};g(D,E=>{i(b()),t(()=>b().count===0)?E(T):E(F,!1)})}r(p),r(h),x(()=>Oe(p,1,`${i(R()),i(b()),t(()=>{var E;return(R()||((E=b())==null?void 0:E.done))===!1?"shimmer":""})??""} text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap`)),a(y,h)},H=y=>{var h=Pn(),p=s(h),D=s(p);{var T=E=>{var Z=We();x(O=>U(Z,O),[()=>(l(),i(b()),t(()=>{var O,J;return l().t((O=b())==null?void 0:O.description,{searchQuery:(J=b())==null?void 0:J.query})}))]),a(E,Z)},F=E=>{var Z=we(),O=ee(Z);{var J=G=>{var re=We();x(xe=>U(re,xe),[()=>(l(),t(()=>l().t("No search query generated")))]),a(G,re)},X=G=>{var re=we(),xe=ee(re);{var L=P=>{var M=We();x(V=>U(M,V),[()=>(l(),t(()=>l().t("Generating search query")))]),a(P,M)},ge=P=>{var M=we(),V=ee(M);{var pe=Se=>{var Ee=We();x(Ce=>U(Ee,Ce),[()=>(l(),t(()=>l().t("Searching the web")))]),a(Se,Ee)},ue=Se=>{var Ee=We();x(()=>U(Ee,(i(b()),t(()=>{var Ce;return(Ce=b())==null?void 0:Ce.description})))),a(Se,Ee)};g(V,Se=>{i(b()),t(()=>{var Ee;return((Ee=b())==null?void 0:Ee.description)==="Searching the web"})?Se(pe):Se(ue,!1)},!0)}a(P,M)};g(xe,P=>{i(b()),t(()=>{var M;return((M=b())==null?void 0:M.description)==="Generating search query"})?P(L):P(ge,!1)},!0)}a(G,re)};g(O,G=>{i(b()),t(()=>{var re;return((re=b())==null?void 0:re.description)==="No search query generated"})?G(J):G(X,!1)},!0)}a(E,Z)};g(D,E=>{i(b()),t(()=>{var Z,O;return(O=(Z=b())==null?void 0:Z.description)==null?void 0:O.includes("{{searchQuery}}")})?E(T):E(F,!1)})}r(p),r(h),x(()=>Oe(p,1,`${i(R()),i(b()),t(()=>{var E;return(R()||((E=b())==null?void 0:E.done))===!1?"shimmer":""})??""} text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap`)),a(y,h)};g(_,y=>{i(b()),t(()=>{var h,p;return((h=b())==null?void 0:h.action)==="sources_retrieved"&&((p=b())==null?void 0:p.count)!==void 0})?y(w):y(H,!1)},!0)}a(B,k)};g(C,B=>{i(b()),t(()=>{var k,_;return((k=b())==null?void 0:k.action)==="queries_generated"&&((_=b())==null?void 0:_.queries)})?B(v):B(ae,!1)},!0)}a(W,c)};g(Ie,W=>{i(b()),t(()=>{var c,C;return((c=b())==null?void 0:c.action)==="web_search_queries_generated"&&((C=b())==null?void 0:C.queries)})?W(ve):W(fe,!1)},!0)}a(he,ce)};g(o,he=>{i(b()),t(()=>{var ce;return((ce=b())==null?void 0:ce.action)==="knowledge_search"})?he(ie):he(_e,!1)},!0)}a(Q,oe)};g(d,Q=>{i(b()),t(()=>{var oe,o,ie;return((oe=b())==null?void 0:oe.action)==="web_search"&&(((o=b())==null?void 0:o.urls)||((ie=b())==null?void 0:ie.items))})?Q(se):Q(j,!1)})}r(le),a(A,le)};g(K,A=>{i(b()),t(()=>{var le;return!((le=b())!=null&&le.hidden)})&&A(N)})}a(Pe,q),jt(),z()}var Tn=m('<div class="w-[0.5px] ml-[6.5px] h-[calc(100%-14px)] bg-gray-300 dark:bg-gray-700"></div>'),Ln=m('<div class="flex items-stretch gap-2 mb-1"><div class=" "><div class="pt-3 px-1 mb-1.5"><span class="relative flex size-1.5 rounded-full justify-center items-center"><span class="relative inline-flex size-1.5 rounded-full bg-gray-500 dark:bg-gray-400"></span></span></div> <!></div> <!></div>'),On=m('<div class="w-full"></div>'),Rn=m('<div class="flex flex-row"><!></div>'),jn=m('<div class="text-sm flex flex-col w-full"><button class="w-full"><div class="flex items-start gap-2"><!></div></button> <!></div>');function zn(Pe,n){Rt(n,!1),Jt("i18n");let l=u(n,"statusHistory",24,()=>[]),f=u(n,"expand",8,!1),z=$e(!0),S=$e([]),b=$e(null);Lt(()=>i(f()),()=>{f()?I(z,!0):I(z,!1)}),Lt(()=>(i(l()),e(S)),()=>{JSON.stringify(l())!==JSON.stringify(e(S))&&I(S,l())}),Lt(()=>e(S),()=>{e(S)&&e(S).length>0&&I(b,e(S).at(-1))}),sa(),zt();var R=we(),q=ee(R);{var K=N=>{var A=we(),le=ee(A);{var d=se=>{var j=jn(),Q=s(j),oe=s(Q),o=s(oe);sr(o,{get status(){return e(b)}}),r(oe),r(Q);var ie=$(Q,2);{var _e=he=>{var ce=Rn(),Ie=s(ce);{var ve=fe=>{var W=On();Ct(W,5,()=>e(S),Wt,(c,C,v,ae)=>{var B=Ln(),k=s(B),_=$(s(k),2);{var w=y=>{var h=Tn();a(y,h)};g(_,y=>{e(S),t(()=>v!==e(S).length-1)&&y(w)})}r(k);var H=$(k,2);sr(H,{get status(){return e(C)},done:!0}),r(B),a(c,B)}),r(W),a(fe,W)};g(Ie,fe=>{e(S),t(()=>e(S).length>1)&&fe(ve)})}r(ce),a(he,ce)};g(ie,he=>{e(z)&&he(_e)})}r(j),Me("click",Q,()=>{I(z,!e(z))}),a(se,j)};g(le,se=>{e(b),t(()=>{var j;return((j=e(b))==null?void 0:j.hidden)!==!0})&&se(d)})}a(N,A)};g(q,N=>{e(S),t(()=>e(S)&&e(S).length>0)&&N(K)})}a(Pe,R),jt()}var An=m('<span id="response-message-model-name" class="line-clamp-1 text-black dark:text-white"> </span>'),Hn=m('<span class="line-clamp-1"> </span>'),qn=m("<div><!></div>"),Wn=m("<!> <!>",1),Dn=m("<div><!></div>"),Un=m('<div class="my-1 w-full flex overflow-x-auto gap-2 flex-wrap"></div>'),Fn=m('<div class="my-2 w-full"><!></div>'),Jn=m('<div class="my-1 w-full flex overflow-x-auto gap-2 flex-wrap"></div>'),Vn=m('<div class="w-full bg-gray-50 dark:bg-gray-800 rounded-3xl px-5 py-3 my-2"><textarea class=" bg-transparent outline-hidden w-full resize-none"></textarea> <div class=" mt-2 mb-1 flex justify-between text-sm font-medium"><div><button id="save-new-message-button" class="px-3.5 py-1.5 bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 border border-gray-100 dark:border-gray-700 text-gray-700 dark:text-gray-200 transition rounded-3xl"> </button></div> <div class="flex space-x-1.5"><button id="close-edit-message-button" class="px-3.5 py-1.5 bg-white dark:bg-gray-900 hover:bg-gray-100 text-gray-800 dark:text-gray-100 transition rounded-3xl"> </button> <button id="confirm-edit-message-button" class="px-3.5 py-1.5 bg-gray-900 dark:bg-white hover:bg-gray-850 text-gray-100 dark:text-gray-800 transition rounded-3xl"> </button></div></div></div>'),Zn=m('<div class="w-full flex flex-col relative" id="response-content-container"><!> <!> <!> <!></div>'),Gn=m('<div class="text-sm flex justify-center font-semibold self-center dark:text-gray-100 min-w-fit"><input type="number" min="1" class="bg-transparent font-semibold self-center dark:text-gray-100 min-w-fit outline-hidden"/> </div>'),Kn=m('<div class="text-sm tracking-widest font-semibold self-center dark:text-gray-100 min-w-fit"> </div>'),Qn=m('<div class="flex self-center min-w-fit" dir="ltr"><button class="self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"><svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg></button> <!> <button class="self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"><svg xmlns="http://www.w3.org/2000/svg" fill="none" aria-hidden="true" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"></path></svg></button></div>'),Yn=m('<button><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.3" aria-hidden="true" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"></path></svg></button>'),Xn=m('<button><svg xmlns="http://www.w3.org/2000/svg" fill="none" aria-hidden="true" viewBox="0 0 24 24" stroke-width="2.3" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184"></path></svg></button>'),eo=ua(`<svg class=" w-4 h-4" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true" xmlns="http://www.w3.org/2000/svg"><style>.spinner_S1WN {
															animation: spinner_MGfb 0.8s linear infinite;
															animation-delay: -0.8s;
														}

														.spinner_Km9P {
															animation-delay: -0.65s;
														}

														.spinner_JApP {
															animation-delay: -0.5s;
														}

														@keyframes spinner_MGfb {
															93.75%,
															100% {
																opacity: 0.2;
															}
														}</style><circle class="spinner_S1WN" cx="4" cy="12" r="3"></circle><circle class="spinner_S1WN spinner_Km9P" cx="12" cy="12" r="3"></circle><circle class="spinner_S1WN spinner_JApP" cx="20" cy="12" r="3"></circle></svg>`),to=ua('<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" aria-hidden="true" stroke-width="2.3" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M17.25 9.75 19.5 12m0 0 2.25 2.25M19.5 12l2.25-2.25M19.5 12l-2.25 2.25m-10.5-6 4.72-4.72a.75.75 0 0 1 1.28.53v15.88a.75.75 0 0 1-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.009 9.009 0 0 1 2.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75Z"></path></svg>'),ao=ua('<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" aria-hidden="true" stroke-width="2.3" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M19.114 5.636a9 9 0 010 12.728M16.463 8.288a5.25 5.25 0 010 7.424M6.75 8.25l4.72-4.72a.75.75 0 011.28.53v15.88a.75.75 0 01-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.01 9.01 0 012.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75z"></path></svg>'),ro=m("<button><!></button>"),so=ua(`<svg aria-hidden="true" class=" w-4 h-4" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><style>.spinner_S1WN {
															animation: spinner_MGfb 0.8s linear infinite;
															animation-delay: -0.8s;
														}

														.spinner_Km9P {
															animation-delay: -0.65s;
														}

														.spinner_JApP {
															animation-delay: -0.5s;
														}

														@keyframes spinner_MGfb {
															93.75%,
															100% {
																opacity: 0.2;
															}
														}</style><circle class="spinner_S1WN" cx="4" cy="12" r="3"></circle><circle class="spinner_S1WN spinner_Km9P" cx="12" cy="12" r="3"></circle><circle class="spinner_S1WN spinner_JApP" cx="20" cy="12" r="3"></circle></svg>`),no=ua('<svg xmlns="http://www.w3.org/2000/svg" fill="none" aria-hidden="true" viewBox="0 0 24 24" stroke-width="2.3" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"></path></svg>'),oo=m("<button><!></button>"),io=m('<button aria-hidden="true"><svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.3" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"></path></svg></button>'),lo=m('<button><svg aria-hidden="true" stroke="currentColor" fill="none" stroke-width="2.3" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4" xmlns="http://www.w3.org/2000/svg"><path d="M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"></path></svg></button>'),vo=m('<button><svg aria-hidden="true" stroke="currentColor" fill="none" stroke-width="2.3" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4" xmlns="http://www.w3.org/2000/svg"><path d="M10 15v4a3 3 0 0 0 3 3l4-9V2H5.72a2 2 0 0 0-2 1.7l-1.38 9a2 2 0 0 0 2 2.3zm7-13h2.67A2.31 2.31 0 0 1 22 4v7a2.31 2.31 0 0 1-2.33 2H17"></path></svg></button>'),co=m("<!> <!>",1),go=m('<button type="button" id="continue-response-button"><svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.3" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"></path><path stroke-linecap="round" stroke-linejoin="round" d="M15.91 11.672a.375.375 0 0 1 0 .656l-5.603 3.113a.375.375 0 0 1-.557-.328V8.887c0-.286.307-.466.557-.327l5.603 3.112Z"></path></svg></button>'),uo=m('<div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.3" aria-hidden="true" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99"></path></svg></div>'),fo=m('<button type="button" class="hidden regenerate-response-button"></button> <!>',1),mo=m('<button type="button"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.3" aria-hidden="true" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99"></path></svg></button>'),ho=m('<button type="button" id="delete-response-button"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"></path></svg></button>'),_o=m('<div class="size-4"><img style="fill: currentColor;"/></div>'),po=m('<button type="button"><!></button>'),xo=m("<!> <!> <!> <!> <!>",1),bo=m("<!> <!> <!> <!> <!> <!>",1),wo=m("<!> <!>",1),yo=m('<div class="mt-2.5"><!></div>'),ko=m('<div class="flex justify-start overflow-x-auto buttons text-gray-600 dark:text-gray-500 mt-0.5 svelte-1qscqw6"><!></div> <!> <!>',1),Mo=m('<div><div><!></div> <div class="flex-auto w-0 pl-1 relative"><!> <div><div><div><!> <!> <!> <!></div></div> <!></div></div></div>'),Io=m("<!> <!>",1);function Ua(Pe,n){Rt(n,!1);const l=()=>Ae(ba,"$models",N),f=()=>Ae(dr,"$config",N),z=()=>Ae(fa,"$settings",N),S=()=>Ae(le,"$i18n",N),b=()=>Ae(Ya,"$audioQueue",N),R=()=>Ae(Xa,"$TTSWorker",N),q=()=>Ae(La,"$user",N),K=()=>Ae(Ja,"$temporaryChatEnabled",N),[N,A]=Zt(),le=Jt("i18n"),d=Sa();let se=u(n,"chatId",8,""),j=u(n,"history",12),Q=u(n,"messageId",8),oe=u(n,"selectedModels",24,()=>[]),o=$e(JSON.parse(JSON.stringify(j().messages[Q()]))),ie=u(n,"siblings",8),_e=u(n,"setInputText",8,()=>{}),he=u(n,"gotoMessage",8,()=>{}),ce=u(n,"showPreviousMessage",8),Ie=u(n,"showNextMessage",8),ve=u(n,"updateChat",8),fe=u(n,"editMessage",8),W=u(n,"saveMessage",8);u(n,"rateMessage",8);let c=u(n,"actionMessage",8),C=u(n,"deleteMessage",8),v=u(n,"submitMessage",8),ae=u(n,"continueResponse",8),B=u(n,"regenerateResponse",8),k=u(n,"addMessages",8),_=u(n,"isLastMessage",8,!0),w=u(n,"readOnly",8,!1),H=u(n,"editCodeBlock",8,!0),y=u(n,"topPadding",8,!1),h=$e(),p=$e(),D=$e(!1),T=$e(null),F=$e(!1),E=$e(""),Z=$e(),O=$e(!1),J=$e(!1),X=$e(!1),G=$e(!1),re=$e(!1);const xe=async ne=>{var te,me,Ne,je,lt;ne=tr(ne),(((me=(te=f())==null?void 0:te.ui)==null?void 0:me.response_watermark)??"").trim()!==""&&(ne=`${ne}

${(je=(Ne=f())==null?void 0:Ne.ui)==null?void 0:je.response_watermark}`),await vr(ne,null,((lt=z())==null?void 0:lt.copyFormatted)??!1)&&Ut.success(S().t("Copying to clipboard was successful!"))},L=()=>{try{speechSynthesis.cancel(),b().stop()}catch{}e(J)&&I(J,!1)},ge=async()=>{var de,te,me,Ne,je,lt,st,$t,ot,Ye,He,Ve,Be,St,Gt,ta,ea,ia,va,nt,Ge,qe,De,pt,Et,Ot,dt,gt,Xe;if(!(((de=e(o))==null?void 0:de.content)??"").trim().length){Ut.info(S().t("No content to speak"));return}I(J,!0);const ne=tr(e(o).content);if(f().audio.tts.engine===""){let Ue=[];const Ke=setInterval(()=>{var Le,Fe,ze;if(Ue=speechSynthesis.getVoices(),Ue.length>0){clearInterval(Ke);const et=((Le=Ue==null?void 0:Ue.filter(ht=>{var Dt,Vt,Xt,ft,tt,ct;return ht.voiceURI===(((Xt=(Vt=(Dt=z())==null?void 0:Dt.audio)==null?void 0:Vt.tts)==null?void 0:Xt.voice)??((ct=(tt=(ft=f())==null?void 0:ft.audio)==null?void 0:tt.tts)==null?void 0:ct.voice))}))==null?void 0:Le.at(0))??void 0,ut=new SpeechSynthesisUtterance(ne);ut.rate=((ze=(Fe=z().audio)==null?void 0:Fe.tts)==null?void 0:ze.playbackRate)??1,ut.onend=()=>{var ht;I(J,!1),z().conversationMode&&((ht=document.getElementById("voice-input-button"))==null||ht.click())},et&&(ut.voice=et),speechSynthesis.speak(ut)}},100)}else{b().setId(`${e(o).id}`),b().setPlaybackRate(((me=(te=z().audio)==null?void 0:te.tts)==null?void 0:me.playbackRate)??1),wr(Ya,t(b).onStopped=()=>{I(J,!1)},t(b)),I(X,!0);const Ue=Br(ne,((lt=(je=(Ne=f())==null?void 0:Ne.audio)==null?void 0:je.tts)==null?void 0:lt.split_on)??"punctuation");if(!Ue.length){Ut.info(S().t("No content to speak")),I(J,!1),I(X,!1);return}if((($t=(st=z().audio)==null?void 0:st.tts)==null?void 0:$t.engine)==="browser-kokoro"){R()||(await Xa.set(new ln({dtype:((He=(Ye=(ot=z().audio)==null?void 0:ot.tts)==null?void 0:Ye.engineConfig)==null?void 0:He.dtype)??"fp32"})),await R().init());for(const[Ke,Le]of Ue.entries()){const Fe=await R().generate({text:Le,voice:((St=(Be=(Ve=z())==null?void 0:Ve.audio)==null?void 0:Be.tts)==null?void 0:St.voice)??((ea=(ta=(Gt=f())==null?void 0:Gt.audio)==null?void 0:ta.tts)==null?void 0:ea.voice)}).catch(ze=>{Ut.error(`${ze}`),I(J,!1),I(X,!1)});if(Fe){const ze=URL.createObjectURL(Fe);b().enqueue(ze),I(X,!1)}}}else for(const[Ke,Le]of Ue.entries()){const Fe=await Or(localStorage.token,((nt=(va=(ia=z())==null?void 0:ia.audio)==null?void 0:va.tts)==null?void 0:nt.defaultVoice)===f().audio.tts.voice?((De=(qe=(Ge=z())==null?void 0:Ge.audio)==null?void 0:qe.tts)==null?void 0:De.voice)??((Ot=(Et=(pt=f())==null?void 0:pt.audio)==null?void 0:Et.tts)==null?void 0:Ot.voice):(Xe=(gt=(dt=f())==null?void 0:dt.audio)==null?void 0:gt.tts)==null?void 0:Xe.voice,Le).catch(ze=>{Ut.error(`${ze}`),I(J,!1),I(X,!1)});if(Fe){const ze=await Fe.blob(),et=URL.createObjectURL(ze);b().enqueue(et),I(X,!1)}}}};let P=[];function M(ne){const de=[];let te=0;return ne=ne.replace(/<details[\s\S]*?<\/details>/gi,me=>(de.push(me),`<details id="__DETAIL_${te++}__"/>`)),P=de,ne}function V(ne){return ne.replace(/<details id="__DETAIL_(\d+)__"\/>/g,(te,me)=>P[parseInt(me)]||"")}const pe=async()=>{I(F,!0),I(E,M(e(o).content)),await at(),la(Z,e(Z).style.height=""),la(Z,e(Z).style.height=`${e(Z).scrollHeight}px`)},ue=async()=>{const ne=V(e(E)?e(E):"");fe()(e(o).id,{content:ne},!1),I(F,!1),I(E,""),await at()},Se=async()=>{const ne=V(e(E)?e(E):"");fe()(e(o).id,{content:ne}),I(F,!1),I(E,""),await at()},Ee=async()=>{I(F,!1),I(E,""),await at()},Ce=async ne=>{I(G,!0);const de=await Rr(localStorage.token,ne.content).catch(te=>{Ut.error(`${te}`)});if(de){const te=de.map(me=>({type:"image",url:`${me.url}`}));W()(ne.id,{...ne,files:te})}I(G,!1)};let Re=$e(!1);const vt=async(ne=null,de=null)=>{var $t,ot,Ye,He,Ve;I(Re,!0);const te={...e(o),annotation:{...(($t=e(o))==null?void 0:$t.annotation)??{},...ne!==null?{rating:ne}:{},...de||{}}},me=await Er(localStorage.token,se()).catch(Be=>{Ut.error(`${Be}`)});if(!me)return;const Ne=Ha(j(),e(o).id);let je={type:"rating",data:{...te!=null&&te.annotation?te.annotation:{},model_id:((ot=e(o))==null?void 0:ot.selectedModelId)??e(o).model,...j().messages[e(o).parentId].childrenIds.length>1?{sibling_model_ids:j().messages[e(o).parentId].childrenIds.filter(Be=>Be!==e(o).id).map(Be=>{var St;return((St=j().messages[Be])==null?void 0:St.selectedModelId)??j().messages[Be].model})}:{}},meta:{arena:e(o)?e(o).arena:!1,model_id:e(o).model,message_id:e(o).id,message_index:Ne.length,chat_id:se()},snapshot:{chat:me}};const lt=[je.data.model_id,...je.data.sibling_model_ids??[]].reduce((Be,St)=>{var ta;const Gt=l().find(ea=>ea.id===St);return Gt?Be[Gt.id]=((ta=Gt==null?void 0:Gt.info)==null?void 0:ta.base_model_id)??null:console.warn(`Model with ID ${St} not found`),Be},{});je.meta.base_models=lt;let st=null;if((Ye=e(o))!=null&&Ye.feedbackId?st=await rr(localStorage.token,e(o).feedbackId,je).catch(Be=>{Ut.error(`${Be}`)}):(st=await Tr(localStorage.token,je).catch(Be=>{Ut.error(`${Be}`)}),st&&(te.feedbackId=st.id)),W()(e(o).id,te),await at(),!de&&(I(re,!0),!((He=te.annotation)!=null&&He.tags)&&(((Ve=e(o))==null?void 0:Ve.content)??"")!=="")){const Be=await Lr(localStorage.token,e(o).model,Ne,se()).catch(St=>[]);Be&&(te.annotation.tags=Be,je.data.tags=Be,W()(e(o).id,te),await rr(localStorage.token,te.feedbackId,je).catch(St=>{Ut.error(`${St}`)}))}I(Re,!1)},Qe=async()=>{C()(e(o).id)};xa(async()=>{await at(),e(p)&&e(p).addEventListener("wheel",function(ne){e(p).scrollWidth<=e(p).clientWidth||(ne.preventDefault(),ne.deltaY!==0&&la(p,e(p).scrollLeft+=ne.deltaY))})}),Lt(()=>(i(j()),e(o),i(Q())),()=>{j().messages&&JSON.stringify(e(o))!==JSON.stringify(j().messages[Q()])&&I(o,JSON.parse(JSON.stringify(j().messages[Q()])))}),Lt(()=>(l(),e(o)),()=>{I(T,l().find(ne=>ne.id===e(o).model))}),Lt(()=>(e(F),at),()=>{e(F)||(async()=>await at())()}),sa(),zt();var ye=Io(),Y=ee(ye);{let ne=be(()=>(S(),t(()=>S().t("Delete message?"))));ur(Y,{get title(){return e(ne)},get show(){return e(D)},set show(de){I(D,de)},$$events:{confirm:()=>{Qe()}},$$legacy:!0})}var ke=$(Y,2);Ia(ke,()=>(e(o),t(()=>e(o).id)),ne=>{var de=Mo(),te=s(de);Oe(te,1,"shrink-0 ltr:mr-3 rtl:ml-3 hidden @lg:flex mt-1 ","svelte-1qscqw6");var me=s(te);{let nt=be(()=>(e(T),S(),i(da),t(()=>{var Ge,qe,De;return((De=(qe=(Ge=e(T))==null?void 0:Ge.info)==null?void 0:qe.meta)==null?void 0:De.profile_image_url)??(S().language==="dg-DG"?`${da}/doge.png`:`${da}/favicon.png`)})));gr(me,{get src(){return e(nt)},className:"size-8 assistant-message-profile-image"})}r(te);var Ne=$(te,2),je=s(Ne);Va(je,{children:(nt,Ge)=>{var qe=Wn(),De=ee(qe);{let Ot=be(()=>(e(T),e(o),t(()=>{var dt;return((dt=e(T))==null?void 0:dt.name)??e(o).model})));Mt(De,{get content(){return e(Ot)},placement:"top-start",children:(dt,gt)=>{var Xe=An(),Ue=s(Xe,!0);r(Xe),x(()=>U(Ue,(e(T),e(o),t(()=>{var Ke;return((Ke=e(T))==null?void 0:Ke.name)??e(o).model})))),a(dt,Xe)},$$slots:{default:!0}})}var pt=$(De,2);{var Et=Ot=>{var dt=qn(),gt=s(dt);{let Xe=be(()=>(i(qt),e(o),t(()=>qt(e(o).timestamp*1e3).format("LLLL"))));Mt(gt,{get content(){return e(Xe)},children:(Ue,Ke)=>{var Le=Hn(),Fe=s(Le,!0);r(Le),x(ze=>U(Fe,ze),[()=>(S(),i(ha),e(o),i(qt),t(()=>S().t(ha(e(o).timestamp*1e3),{LOCALIZED_TIME:qt(e(o).timestamp*1e3).format("LT"),LOCALIZED_DATE:qt(e(o).timestamp*1e3).format("L")})))]),a(Ue,Le)},$$slots:{default:!0}})}r(dt),x(()=>Oe(dt,1,`self-center text-xs font-medium first-letter:capitalize ml-0.5 translate-y-[1px] ${z(),t(()=>{var Xe;return((Xe=z())==null?void 0:Xe.highContrastMode)??!1?"dark:text-gray-100 text-gray-900":"invisible group-hover:visible transition text-gray-400"})??""}`)),a(Ot,dt)};g(pt,Ot=>{e(o),t(()=>e(o).timestamp)&&Ot(Et)})}a(nt,qe)},$$slots:{default:!0}});var lt=$(je,2),st=s(lt),$t=s(st),ot=s($t);{var Ye=nt=>{{let Ge=be(()=>(e(o),t(()=>{var qe;return(qe=e(o))==null?void 0:qe.statusHistory})));zn(nt,{get statusHistory(){return e(Ge)}})}};g(ot,nt=>{e(T),t(()=>{var Ge,qe,De,pt;return((pt=(De=(qe=(Ge=e(T))==null?void 0:Ge.info)==null?void 0:qe.meta)==null?void 0:De.capabilities)==null?void 0:pt.status_updates)??!0})&&nt(Ye)})}var He=$(ot,2);{var Ve=nt=>{var Ge=Un();Ct(Ge,5,()=>(e(o),t(()=>e(o).files)),Wt,(qe,De)=>{var pt=Dn(),Et=s(pt);{var Ot=gt=>{qa(gt,{get src(){return e(De),t(()=>e(De).url)},get alt(){return e(o),t(()=>e(o).content)}})},dt=gt=>{{let Xe=be(()=>(e(De),t(()=>{var Ue;return(Ue=e(De))==null?void 0:Ue.size})));Wa(gt,{get item(){return e(De)},get url(){return e(De),t(()=>e(De).url)},get name(){return e(De),t(()=>e(De).name)},get type(){return e(De),t(()=>e(De).type)},get size(){return e(Xe)},small:!0})}};g(Et,gt=>{e(De),t(()=>e(De).type==="image")?gt(Ot):gt(dt,!1)})}r(pt),a(qe,pt)}),r(Ge),a(nt,Ge)};g(He,nt=>{e(o),t(()=>{var Ge,qe;return((Ge=e(o))==null?void 0:Ge.files)&&((qe=e(o).files)==null?void 0:qe.filter(De=>De.type==="image").length)>0})&&nt(Ve)})}var Be=$(He,2);{var St=nt=>{var Ge=Jn();Ct(Ge,5,()=>(e(o),t(()=>e(o).embeds)),Wt,(qe,De,pt)=>{var Et=Fn(),Ot=s(Et);qr(Ot,{get src(){return e(De)},allowScripts:!0,allowForms:!0,allowSameOrigin:!0,allowPopups:!0}),r(Et),x(()=>Te(Et,"id",(e(o),t(()=>`${e(o).id}-embeds-${pt}`)))),a(qe,Et)}),r(Ge),a(nt,Ge)};g(Be,nt=>{e(o),t(()=>{var Ge;return((Ge=e(o))==null?void 0:Ge.embeds)&&e(o).embeds.length>0})&&nt(St)})}var Gt=$(Be,2);{var ta=nt=>{var Ge=Vn(),qe=s(Ge);Fa(qe),pa(qe,Le=>I(Z,Le),()=>e(Z));var De=$(qe,2),pt=s(De),Et=s(pt),Ot=s(Et,!0);r(Et),r(pt);var dt=$(pt,2),gt=s(dt),Xe=s(gt,!0);r(gt);var Ue=$(gt,2),Ke=s(Ue,!0);r(Ue),r(dt),r(De),r(Ge),x((Le,Fe,ze)=>{Te(qe,"id",`message-edit-${e(o),t(()=>e(o).id)??""}`),U(Ot,Le),U(Xe,Fe),U(Ke,ze)},[()=>(S(),t(()=>S().t("Save As Copy"))),()=>(S(),t(()=>S().t("Cancel"))),()=>(S(),t(()=>S().t("Save")))]),Na(qe,()=>e(E),Le=>I(E,Le)),Me("input",qe,Le=>{Le.target.style.height="",Le.target.style.height=`${Le.target.scrollHeight}px`}),Me("keydown",qe,Le=>{var et,ut;Le.key==="Escape"&&((et=document.getElementById("close-edit-message-button"))==null||et.click());const Fe=Le.metaKey||Le.ctrlKey,ze=Le.key==="Enter";Fe&&ze&&((ut=document.getElementById("confirm-edit-message-button"))==null||ut.click())}),Me("click",Et,()=>{Se()}),Me("click",gt,()=>{Ee()}),Me("click",Ue,()=>{ue()}),a(nt,Ge)},ea=nt=>{var Ge=Zn(),qe=s(Ge);{var De=Ke=>{Za(Ke,{})},pt=Ke=>{var Le=we(),Fe=ee(Le);{var ze=et=>{{let ut=be(()=>(i(se()),e(o),t(()=>`${se()}-${e(o).id}`))),ht=be(()=>(e(o),i(w()),z(),t(()=>{var ft,tt;return((ft=e(o))==null?void 0:ft.done)&&!w()&&(((tt=z())==null?void 0:tt.showFloatingActionButtons)??!0)}))),Dt=be(()=>!w()),Vt=be(()=>!w()),Xt=be(()=>(z(),e(o),t(()=>{var ft,tt;return((ft=z())==null?void 0:ft.chatFadeStreamingText)??!0?((tt=e(o))==null?void 0:tt.done)??!1:!0})));nn(et,{get id(){return e(ut)},get messageId(){return e(o),t(()=>e(o).id)},get history(){return j()},get selectedModels(){return oe()},get content(){return e(o),t(()=>e(o).content)},get sources(){return e(o),t(()=>e(o).sources)},get floatingButtons(){return e(ht)},get save(){return e(Dt)},get preview(){return e(Vt)},get editCodeBlock(){return H()},get topPadding(){return y()},get done(){return e(Xt)},get model(){return e(T)},onTaskClick:async ft=>{},onSourceClick:async(ft,tt)=>{var ct;e(h)&&((ct=e(h))==null||ct.showSourceModal(tt-1))},onAddMessages:({modelId:ft,parentId:tt,messages:ct})=>{k()({modelId:ft,parentId:tt,messages:ct})},onSave:({raw:ft,oldContent:tt,newContent:ct})=>{j(j().messages[e(o).id].content=j().messages[e(o).id].content.replace(ft,ft.replace(tt,ct)),!0),ve()()}})}};g(Fe,et=>{e(o),t(()=>e(o).content&&e(o).error!==!0)&&et(ze)},!0)}a(Ke,Le)};g(qe,Ke=>{e(o),e(T),t(()=>{var Le,Fe,ze,et,ut,ht,Dt,Vt,Xt,ft;return e(o).content===""&&!e(o).error&&(((et=(ze=(Fe=(Le=e(T))==null?void 0:Le.info)==null?void 0:Fe.meta)==null?void 0:ze.capabilities)==null?void 0:et.status_updates)??!0?(((ut=e(o))==null?void 0:ut.statusHistory)??[...(ht=e(o))!=null&&ht.status?[(Dt=e(o))==null?void 0:Dt.status]:[]]).length===0||(((ft=(Xt=(Vt=e(o))==null?void 0:Vt.statusHistory)==null?void 0:Xt.at(-1))==null?void 0:ft.hidden)??!1):!0)})?Ke(De):Ke(pt,!1)})}var Et=$(qe,2);{var Ot=Ke=>{{let Le=be(()=>(e(o),t(()=>{var Fe,ze;return((ze=(Fe=e(o))==null?void 0:Fe.error)==null?void 0:ze.content)??e(o).content})));xs(Ke,{get content(){return e(Le)}})}};g(Et,Ke=>{e(o),t(()=>{var Le;return(Le=e(o))==null?void 0:Le.error})&&Ke(Ot)})}var dt=$(Et,2);{var gt=Ke=>{{let Le=be(()=>(e(o),t(()=>{var ze;return(ze=e(o))==null?void 0:ze.id}))),Fe=be(()=>(e(o),t(()=>{var ze,et;return((ze=e(o))==null?void 0:ze.sources)??((et=e(o))==null?void 0:et.citations)})));pa(js(Ke,{get id(){return e(Le)},get sources(){return e(Fe)},get readOnly(){return w()},$$legacy:!0}),ze=>I(h,ze),()=>e(h))}};g(dt,Ke=>{e(o),e(T),t(()=>{var Le,Fe,ze,et,ut,ht;return(((Le=e(o))==null?void 0:Le.sources)||((Fe=e(o))==null?void 0:Fe.citations))&&(((ht=(ut=(et=(ze=e(T))==null?void 0:ze.info)==null?void 0:et.meta)==null?void 0:ut.capabilities)==null?void 0:ht.citations)??!0)})&&Ke(gt)})}var Xe=$(dt,2);{var Ue=Ke=>{Ks(Ke,{get codeExecutions(){return e(o),t(()=>e(o).code_executions)}})};g(Xe,Ke=>{e(o),t(()=>e(o).code_executions)&&Ke(Ue)})}r(Ge),a(nt,Ge)};g(Gt,nt=>{e(F)===!0?nt(ta):nt(ea,!1)})}r($t),r(st);var ia=$(st,2);{var va=nt=>{var Ge=ko(),qe=ee(Ge),De=s(qe);{var pt=Xe=>{var Ue=wo(),Ke=ee(Ue);{var Le=et=>{var ut=Qn(),ht=s(ut),Dt=$(ht,2);{var Vt=tt=>{var ct=Gn(),Ft=s(ct);Ca(Ft);var na=$(Ft);r(ct),x(aa=>{Te(Ft,"id",`message-index-input-${e(o),t(()=>e(o).id)??""}`),za(Ft,aa),Te(Ft,"max",(i(ie()),t(()=>ie().length))),U(na,`/${i(ie()),t(()=>ie().length)??""}`)},[()=>(i(ie()),e(o),t(()=>ie().indexOf(e(o).id)+1))]),Me("focus",Ft,aa=>{aa.target.select()}),Me("blur",Ft,aa=>{he()(e(o),aa.target.value-1),I(O,!1)}),Me("keydown",Ft,aa=>{aa.key==="Enter"&&(he()(e(o),aa.target.value-1),I(O,!1))}),a(tt,ct)},Xt=tt=>{var ct=Kn(),Ft=s(ct);r(ct),x(na=>U(Ft,`${na??""}/${i(ie()),t(()=>ie().length)??""}`),[()=>(i(ie()),e(o),t(()=>ie().indexOf(e(o).id)+1))]),Me("dblclick",ct,async()=>{I(O,!0),await at();const na=document.getElementById(`message-index-input-${e(o).id}`);na&&(na.focus(),na.select())}),a(tt,ct)};g(Dt,tt=>{e(O)?tt(Vt):tt(Xt,!1)})}var ft=$(Dt,2);r(ut),x((tt,ct)=>{Te(ht,"aria-label",tt),Te(ft,"aria-label",ct),ut.dir=ut.dir},[()=>(S(),t(()=>S().t("Previous message"))),()=>(S(),t(()=>S().t("Next message")))]),Me("click",ht,()=>{ce()(e(o))}),Me("click",ft,()=>{Ie()(e(o))}),a(et,ut)};g(Ke,et=>{i(ie()),t(()=>ie().length>1)&&et(Le)})}var Fe=$(Ke,2);{var ze=et=>{var ut=bo(),ht=ee(ut);{var Dt=mt=>{var Nt=we(),xt=ee(Nt);{var At=Je=>{{let bt=be(()=>(S(),t(()=>S().t("Edit"))));Mt(Je,{get content(){return e(bt)},placement:"bottom",children:(Kt,oa)=>{var it=Yn();x(wt=>{Te(it,"aria-label",wt),Oe(it,1,`${i(_()),z(),t(()=>{var ra;return _()||(((ra=z())==null?void 0:ra.highContrastMode)??!1)?"visible":"invisible group-hover:visible"})??""} p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition`)},[()=>(S(),t(()=>S().t("Edit")))]),Me("click",it,()=>{pe()}),a(Kt,it)},$$slots:{default:!0}})}};g(xt,Je=>{q(),t(()=>{var bt,Kt,oa,it;return((bt=q())==null?void 0:bt.role)==="user"?((it=(oa=(Kt=q())==null?void 0:Kt.permissions)==null?void 0:oa.chat)==null?void 0:it.edit)??!0:!0})&&Je(At)})}a(mt,Nt)};g(ht,mt=>{w()||mt(Dt)})}var Vt=$(ht,2);{let mt=be(()=>(S(),t(()=>S().t("Copy"))));Mt(Vt,{get content(){return e(mt)},placement:"bottom",children:(Nt,xt)=>{var At=Xn();x(Je=>{Te(At,"aria-label",Je),Oe(At,1,`${i(_()),z(),t(()=>{var bt;return _()||(((bt=z())==null?void 0:bt.highContrastMode)??!1)?"visible":"invisible group-hover:visible"})??""} p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition copy-response-button`)},[()=>(S(),t(()=>S().t("Copy")))]),Me("click",At,()=>{xe(e(o).content)}),a(Nt,At)},$$slots:{default:!0}})}var Xt=$(Vt,2);{var ft=mt=>{{let Nt=be(()=>(S(),t(()=>S().t("Read Aloud"))));Mt(mt,{get content(){return e(Nt)},placement:"bottom",children:(xt,At)=>{var Je=ro(),bt=s(Je);{var Kt=it=>{var wt=eo();a(it,wt)},oa=it=>{var wt=we(),ra=ee(wt);{var wa=rt=>{var _t=to();a(rt,_t)},Bt=rt=>{var _t=ao();a(rt,_t)};g(ra,rt=>{e(J)?rt(wa):rt(Bt,!1)},!0)}a(it,wt)};g(bt,it=>{e(X)?it(Kt):it(oa,!1)})}r(Je),x(it=>{Te(Je,"aria-label",it),Te(Je,"id",`speak-button-${e(o),t(()=>e(o).id)??""}`),Oe(Je,1,`${i(_()),z(),t(()=>{var wt;return _()||(((wt=z())==null?void 0:wt.highContrastMode)??!1)?"visible":"invisible group-hover:visible"})??""} p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition`)},[()=>(S(),t(()=>S().t("Read Aloud")))]),Me("click",Je,()=>{e(X)||(e(J)?L():ge())}),a(xt,Je)},$$slots:{default:!0}})}};g(Xt,mt=>{q(),t(()=>{var Nt,xt,At,Je;return((Nt=q())==null?void 0:Nt.role)==="admin"||(((Je=(At=(xt=q())==null?void 0:xt.permissions)==null?void 0:At.chat)==null?void 0:Je.tts)??!0)})&&mt(ft)})}var tt=$(Xt,2);{var ct=mt=>{{let Nt=be(()=>(S(),t(()=>S().t("Generate Image"))));Mt(mt,{get content(){return e(Nt)},placement:"bottom",children:(xt,At)=>{var Je=oo(),bt=s(Je);{var Kt=it=>{var wt=so();a(it,wt)},oa=it=>{var wt=no();a(it,wt)};g(bt,it=>{e(G)?it(Kt):it(oa,!1)})}r(Je),x(it=>{Te(Je,"aria-label",it),Oe(Je,1,`${i(_()),z(),t(()=>{var wt;return _()||(((wt=z())==null?void 0:wt.highContrastMode)??!1)?"visible":"invisible group-hover:visible"})??""}  p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition`)},[()=>(S(),t(()=>S().t("Generate Image")))]),Me("click",Je,()=>{e(G)||Ce(e(o))}),a(xt,Je)},$$slots:{default:!0}})}};g(tt,mt=>{f(),q(),i(w()),t(()=>{var Nt,xt,At,Je,bt;return((Nt=f())==null?void 0:Nt.features.enable_image_generation)&&(((xt=q())==null?void 0:xt.role)==="admin"||((bt=(Je=(At=q())==null?void 0:At.permissions)==null?void 0:Je.features)==null?void 0:bt.image_generation))&&!w()})&&mt(ct)})}var Ft=$(tt,2);{var na=mt=>{{let Nt=be(()=>(e(o),i(_a),t(()=>e(o).usage?`<pre>${_a(JSON.stringify(e(o).usage,null,2).replace(/"([^(")"]+)":/g,"$1:").slice(1,-1).split(`
`).map(xt=>xt.slice(2)).map(xt=>xt.endsWith(",")?xt.slice(0,-1):xt).join(`
`))}</pre>`:"")));Mt(mt,{get content(){return e(Nt)},placement:"bottom",children:(xt,At)=>{var Je=io();x(()=>{Oe(Je,1,` ${i(_()),z(),t(()=>{var bt;return _()||(((bt=z())==null?void 0:bt.highContrastMode)??!1)?"visible":"invisible group-hover:visible"})??""} p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition whitespace-pre-wrap`),Te(Je,"id",`info-${e(o),t(()=>e(o).id)??""}`)}),Me("click",Je,()=>{e(o)}),a(xt,Je)},$$slots:{default:!0}})}};g(Ft,mt=>{e(o),t(()=>e(o).usage)&&mt(na)})}var aa=$(Ft,2);{var ca=mt=>{var Nt=xo(),xt=ee(Nt);{var At=Bt=>{var rt=co(),_t=ee(rt);{let Ze=be(()=>(S(),t(()=>S().t("Good Response"))));Mt(_t,{get content(){return e(Ze)},placement:"bottom",children:(Ht,Qt)=>{var It=lo();x((yt,kt)=>{Te(It,"aria-label",yt),Oe(It,1,`${i(_()),z(),t(()=>{var Tt;return _()||(((Tt=z())==null?void 0:Tt.highContrastMode)??!1)?"visible":"invisible group-hover:visible"})??""} p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg ${kt??""} dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent`),It.disabled=e(Re)},[()=>(S(),t(()=>S().t("Good Response"))),()=>(e(o),t(()=>{var yt,kt;return(((kt=(yt=e(o))==null?void 0:yt.annotation)==null?void 0:kt.rating)??"").toString()==="1"?"bg-gray-100 dark:bg-gray-800":""}))]),Me("click",It,async()=>{await vt(1),window.setTimeout(()=>{var yt;(yt=document.getElementById(`message-feedback-${e(o).id}`))==null||yt.scrollIntoView()},0)}),a(Ht,It)},$$slots:{default:!0}})}var Pt=$(_t,2);{let Ze=be(()=>(S(),t(()=>S().t("Bad Response"))));Mt(Pt,{get content(){return e(Ze)},placement:"bottom",children:(Ht,Qt)=>{var It=vo();x((yt,kt)=>{Te(It,"aria-label",yt),Oe(It,1,`${i(_()),z(),t(()=>{var Tt;return _()||(((Tt=z())==null?void 0:Tt.highContrastMode)??!1)?"visible":"invisible group-hover:visible"})??""} p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg ${kt??""} dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent`),It.disabled=e(Re)},[()=>(S(),t(()=>S().t("Bad Response"))),()=>(e(o),t(()=>{var yt,kt;return(((kt=(yt=e(o))==null?void 0:yt.annotation)==null?void 0:kt.rating)??"").toString()==="-1"?"bg-gray-100 dark:bg-gray-800":""}))]),Me("click",It,async()=>{await vt(-1),window.setTimeout(()=>{var yt;(yt=document.getElementById(`message-feedback-${e(o).id}`))==null||yt.scrollIntoView()},0)}),a(Ht,It)},$$slots:{default:!0}})}a(Bt,rt)};g(xt,Bt=>{K(),f(),q(),t(()=>{var rt,_t,Pt,Ze,Ht;return!K()&&(((rt=f())==null?void 0:rt.features.enable_message_rating)??!0)&&(((_t=q())==null?void 0:_t.role)==="admin"||(((Ht=(Ze=(Pt=q())==null?void 0:Pt.permissions)==null?void 0:Ze.chat)==null?void 0:Ht.rate_response)??!0))})&&Bt(At)})}var Je=$(xt,2);{var bt=Bt=>{{let rt=be(()=>(S(),t(()=>S().t("Continue Response"))));Mt(Bt,{get content(){return e(rt)},placement:"bottom",children:(_t,Pt)=>{var Ze=go();x(Ht=>{Te(Ze,"aria-label",Ht),Oe(Ze,1,`${i(_()),z(),t(()=>{var Qt;return _()||(((Qt=z())==null?void 0:Qt.highContrastMode)??!1)?"visible":"invisible group-hover:visible"})??""} p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition`)},[()=>(S(),t(()=>S().t("Continue Response")))]),Me("click",Ze,()=>{ae()()}),a(_t,Ze)},$$slots:{default:!0}})}};g(Je,Bt=>{i(_()),q(),t(()=>{var rt,_t,Pt,Ze;return _()&&(((rt=q())==null?void 0:rt.role)==="admin"||(((Ze=(Pt=(_t=q())==null?void 0:_t.permissions)==null?void 0:Pt.chat)==null?void 0:Ze.continue_response)??!0))})&&Bt(bt)})}var Kt=$(Je,2);{var oa=Bt=>{var rt=we(),_t=ee(rt);{var Pt=Ht=>{var Qt=fo(),It=ee(Qt),yt=$(It,2);kn(yt,{onRegenerate:(kt=null)=>{var Tt;I(re,!1),B()(e(o),kt),(((Tt=e(T))==null?void 0:Tt.actions)??[]).forEach(Yt=>{d("action",{id:Yt.id,event:{id:"regenerate-response",data:{messageId:e(o).id}}})})},children:(kt,Tt)=>{{let Yt=be(()=>(S(),t(()=>S().t("Regenerate"))));Mt(kt,{get content(){return e(Yt)},placement:"bottom",children:(ga,Pa)=>{var ya=uo();x(_r=>{Te(ya,"aria-label",_r),Oe(ya,1,`${_()?"visible":"invisible group-hover:visible"} p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition`)},[()=>(S(),t(()=>S().t("Regenerate")))]),a(ga,ya)},$$slots:{default:!0}})}},$$slots:{default:!0}}),Me("click",It,()=>{var kt;I(re,!1),B()(e(o)),(((kt=e(T))==null?void 0:kt.actions)??[]).forEach(Tt=>{d("action",{id:Tt.id,event:{id:"regenerate-response",data:{messageId:e(o).id}}})})}),a(Ht,Qt)},Ze=Ht=>{{let Qt=be(()=>(S(),t(()=>S().t("Regenerate"))));Mt(Ht,{get content(){return e(Qt)},placement:"bottom",children:(It,yt)=>{var kt=mo();x(Tt=>{Te(kt,"aria-label",Tt),Oe(kt,1,`${_()?"visible":"invisible group-hover:visible"} p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button`)},[()=>(S(),t(()=>S().t("Regenerate")))]),Me("click",kt,()=>{var Tt;I(re,!1),B()(e(o)),(((Tt=e(T))==null?void 0:Tt.actions)??[]).forEach(Yt=>{d("action",{id:Yt.id,event:{id:"regenerate-response",data:{messageId:e(o).id}}})})}),a(It,kt)},$$slots:{default:!0}})}};g(_t,Ht=>{z(),t(()=>{var Qt;return((Qt=z())==null?void 0:Qt.regenerateMenu)??!0})?Ht(Pt):Ht(Ze,!1)})}a(Bt,rt)};g(Kt,Bt=>{q(),t(()=>{var rt,_t,Pt,Ze;return((rt=q())==null?void 0:rt.role)==="admin"||(((Ze=(Pt=(_t=q())==null?void 0:_t.permissions)==null?void 0:Pt.chat)==null?void 0:Ze.regenerate_response)??!0)})&&Bt(oa)})}var it=$(Kt,2);{var wt=Bt=>{var rt=we(),_t=ee(rt);{var Pt=Ze=>{{let Ht=be(()=>(S(),t(()=>S().t("Delete"))));Mt(Ze,{get content(){return e(Ht)},placement:"bottom",children:(Qt,It)=>{var yt=ho();x(kt=>{Te(yt,"aria-label",kt),Oe(yt,1,`${i(_()),z(),t(()=>{var Tt;return _()||(((Tt=z())==null?void 0:Tt.highContrastMode)??!1)?"visible":"invisible group-hover:visible"})??""} p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition`)},[()=>(S(),t(()=>S().t("Delete")))]),Me("click",yt,()=>{I(D,!0)}),a(Qt,yt)},$$slots:{default:!0}})}};g(_t,Ze=>{i(ie()),t(()=>ie().length>1)&&Ze(Pt)})}a(Bt,rt)};g(it,Bt=>{q(),t(()=>{var rt,_t,Pt,Ze;return((rt=q())==null?void 0:rt.role)==="admin"||(((Ze=(Pt=(_t=q())==null?void 0:_t.permissions)==null?void 0:Pt.chat)==null?void 0:Ze.delete_message)??!0)})&&Bt(wt)})}var ra=$(it,2);{var wa=Bt=>{var rt=we(),_t=ee(rt);Ct(_t,1,()=>(e(T),t(()=>{var Pt;return((Pt=e(T))==null?void 0:Pt.actions)??[]})),Wt,(Pt,Ze)=>{Mt(Pt,{get content(){return e(Ze),t(()=>e(Ze).name)},placement:"bottom",children:(Ht,Qt)=>{var It=po(),yt=s(It);{var kt=Yt=>{var ga=_o(),Pa=s(ga);r(ga),x(ya=>{Te(Pa,"src",(e(Ze),t(()=>e(Ze).icon))),Oe(Pa,1,`w-4 h-4 ${ya??""}`),Te(Pa,"alt",(e(Ze),t(()=>e(Ze).name)))},[()=>(e(Ze),t(()=>e(Ze).icon.includes("svg")?"dark:invert-[80%]":""))]),a(Yt,ga)},Tt=Yt=>{Ur(Yt,{strokeWidth:"2.1",className:"size-4"})};g(yt,Yt=>{e(Ze),t(()=>{var ga;return(ga=e(Ze))==null?void 0:ga.icon})?Yt(kt):Yt(Tt,!1)})}r(It),x(()=>{Te(It,"aria-label",(e(Ze),t(()=>e(Ze).name))),Oe(It,1,`${i(_()),z(),t(()=>{var Yt;return _()||(((Yt=z())==null?void 0:Yt.highContrastMode)??!1)?"visible":"invisible group-hover:visible"})??""} p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition`)}),Me("click",It,()=>{c()(e(Ze).id,e(o))}),a(Ht,It)},$$slots:{default:!0}})}),a(Bt,rt)};g(ra,Bt=>{_()&&Bt(wa)})}a(mt,Nt)};g(aa,mt=>{w()||mt(ca)})}a(et,ut)};g(Fe,et=>{e(o),t(()=>e(o).done)&&et(ze)})}a(Xe,Ue)};g(De,Xe=>{e(o),i(ie()),t(()=>e(o).done||ie().length>1)&&Xe(pt)})}r(qe),pa(qe,Xe=>I(p,Xe),()=>e(p));var Et=$(qe,2);{var Ot=Xe=>{cs(Xe,{get message(){return e(o)},set message(Ue){I(o,Ue)},get show(){return e(re)},set show(Ue){I(re,Ue)},$$events:{save:async Ue=>{await vt(null,{...Ue.detail})}},$$legacy:!0})};g(Et,Xe=>{e(o),e(re),t(()=>e(o).done&&e(re))&&Xe(Ot)})}var dt=$(Et,2);{var gt=Xe=>{var Ue=yo(),Ke=s(Ue);{let Le=be(()=>(e(o),t(()=>{var Fe;return(Fe=e(o))==null?void 0:Fe.followUps})));un(Ke,{get followUps(){return e(Le)},onClick:Fe=>{var ze,et;((ze=z())==null?void 0:ze.insertFollowUpPrompt)??!1?_e()(Fe):v()((et=e(o))==null?void 0:et.id,Fe)}})}r(Ue),ka(1,Ue,()=>Ma,()=>({duration:100})),a(Xe,Ue)};g(dt,Xe=>{i(_()),z(),e(o),i(w()),t(()=>{var Ue,Ke;return(_()||(((Ue=z())==null?void 0:Ue.keepFollowUpPrompts)??!1))&&e(o).done&&!w()&&(((Ke=e(o))==null?void 0:Ke.followUps)??[]).length>0})&&Xe(gt)})}a(nt,Ge)};g(ia,nt=>{e(F)||nt(va)})}r(lt),r(Ne),r(de),x(()=>{Oe(de,1,` flex w-full message-${e(o),t(()=>e(o).id)??""}`,"svelte-1qscqw6"),Te(de,"id",`message-${e(o),t(()=>e(o).id)??""}`),Te(de,"dir",(z(),t(()=>z().chatDirection))),Oe(st,1,`chat-${e(o),t(()=>e(o).role)??""} w-full min-w-full markdown-prose`,"svelte-1qscqw6"),de.dir=de.dir}),a(ne,de)}),a(Pe,ye),jt(),A()}var Co=ua('<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M8 8v8m0-8a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm0 8a2 2 0 1 0 0 4 2 2 0 0 0 0-4Zm6-2a2 2 0 1 1 4 0 2 2 0 0 1-4 0Zm0 0h-1a5 5 0 0 1-5-5v-.5"></path></svg>');function $o(Pe,n){let l=u(n,"className",8,"w-4 h-4"),f=u(n,"strokeWidth",8,"1.5");var z=Co();x(()=>{Te(z,"stroke-width",f()),Oe(z,0,Ea(l()))}),a(Pe,z)}var So=m('<button><div class="flex items-center gap-1.5"><div class="-translate-y-[1px]"> </div></div></button>'),Eo=m('<div class="w-full"><div class=" flex w-full mb-4.5 border-b border-gray-200 dark:border-gray-850"><div class="flex gap-2 scrollbar-none overflow-x-auto w-fit text-center font-medium bg-transparent pt-1 text-sm"></div></div> <!></div>'),No=m("<div><!></div>"),Po=m('<span class=" self-center invisible group-hover:visible text-gray-400 text-xs font-medium uppercase ml-0.5 -mt-0.5"> </span>'),Bo=m(" <!>",1),To=m('<div class="w-full rounded-xl pl-5 pr-2 py-2 mt-2"><!> <div class="mt-1 markdown-prose w-full min-w-full"><!></div></div>'),Lo=m('<button type="button" id="merge-response-button"><!></button>'),Oo=m('<div class=" shrink-0 text-gray-600 dark:text-gray-500 mt-1"><!></div>'),Ro=m('<div class="flex justify-end"><div class="w-full"><!></div> <!></div>'),jo=m('<div><div class="flex snap-x snap-mandatory overflow-x-auto scrollbar-hidden"><!></div> <!></div>');function zo(Pe,n){Rt(n,!1);const l=()=>Ae(fa,"$settings",b),f=()=>Ae(ba,"$models",b),z=()=>Ae(lr,"$mobile",b),S=()=>Ae(q,"$i18n",b),[b,R]=Zt(),q=Jt("i18n");qt.extend(cr);let K=u(n,"chatId",8),N=u(n,"history",12),A=u(n,"messageId",8),le=u(n,"selectedModels",24,()=>[]),d=u(n,"isLastMessage",8),se=u(n,"readOnly",8,!1),j=u(n,"editCodeBlock",8,!0),Q=u(n,"setInputText",8,()=>{}),oe=u(n,"updateChat",8),o=u(n,"editMessage",8),ie=u(n,"saveMessage",8),_e=u(n,"rateMessage",8),he=u(n,"actionMessage",8),ce=u(n,"submitMessage",8),Ie=u(n,"deleteMessage",8),ve=u(n,"continueResponse",8),fe=u(n,"regenerateResponse",8),W=u(n,"mergeResponses",8),c=u(n,"addMessages",8),C=u(n,"triggerScroll",8),v=u(n,"topPadding",8,!1);Sa();let ae=$e(),B=$e({}),k=$e({}),_=$e(null),w=$e(JSON.parse(JSON.stringify(N().messages[A()])));const H=async(O,J)=>{la(k,e(k)[O]=Math.max(0,Math.min(J,e(B)[O].messageIds.length-1)));let X=e(B)[O].messageIds[e(k)[O]],G=N().messages[X].childrenIds;for(;G.length!==0;)X=G.at(-1),G=N().messages[X].childrenIds;N(N().currentId=X,!0),await at(),await oe()(),C()()},y=async O=>{la(k,e(k)[O]=Math.max(0,e(k)[O]-1));let J=e(B)[O].messageIds[e(k)[O]],X=N().messages[J].childrenIds;for(;X.length!==0;)J=X.at(-1),X=N().messages[J].childrenIds;N(N().currentId=J,!0),await at(),await oe()(),C()()},h=async O=>{la(k,e(k)[O]=Math.min(e(B)[O].messageIds.length-1,e(k)[O]+1));let J=e(B)[O].messageIds[e(k)[O]],X=N().messages[J].childrenIds;for(;X.length!==0;)J=X.at(-1),X=N().messages[J].childrenIds;N(N().currentId=J,!0),await at(),await oe()(),C()()},p=async()=>{var O,J,X;await at(),A(),I(ae,N().messages[A()].parentId?N().messages[N().messages[A()].parentId]:null),I(B,(O=e(ae))==null?void 0:O.models.reduce((G,re,xe)=>{var ge,P;let L=(ge=e(ae))==null?void 0:ge.childrenIds.map(M=>N().messages[M]).filter(M=>(M==null?void 0:M.modelIdx)===xe).map(M=>M.id);if(L.length===0){let M=(P=e(ae))==null?void 0:P.childrenIds.map(V=>N().messages[V]).filter(V=>(V==null?void 0:V.model)===re);M.forEach(V=>{V.modelIdx=xe}),L=M.map(V=>V.id)}return{...G,[xe]:{messageIds:L}}},{})),I(k,(J=e(ae))==null?void 0:J.models.reduce((G,re,xe)=>{const L=e(B)[xe].messageIds.findIndex(ge=>ge===A());return L!==-1?{...G,[xe]:L}:{...G,[xe]:e(B)[xe].messageIds.length-1}},{})),I(_,(X=N().messages[A()])==null?void 0:X.modelIdx),e(B),e(k),await at()},D=async(O,J)=>{if(A()!=O){let X=O,G=N().messages[X].childrenIds;for(;G.length!==0;)X=G.at(-1),G=N().messages[X].childrenIds;N(N().currentId=X,!0),I(_,J)}},T=async()=>{const O=Object.keys(e(B)).map(J=>{const{messageIds:X}=e(B)[J],G=X[e(k)[J]];return N().messages[G].content});W()(A(),O,K())};xa(async()=>{var O;if(await p(),await at(),((O=l())==null?void 0:O.scrollOnBranchChange)??!0){const J=document.getElementById(`message-${A()}`);J&&J.scrollIntoView({block:"start"})}}),Lt(()=>(i(N()),e(w),i(A())),()=>{N().messages&&JSON.stringify(e(w))!==JSON.stringify(N().messages[A()])&&I(w,JSON.parse(JSON.stringify(N().messages[A()])))}),sa(),zt();var F=we(),E=ee(F);{var Z=O=>{var J=jo(),X=s(J),G=s(X);{var re=P=>{var M=Eo(),V=s(M),pe=s(V);Ct(pe,5,()=>(e(B),t(()=>Object.keys(e(B)))),Wt,(Ee,Ce)=>{var Re=we(),vt=ee(Re);{var Qe=ye=>{const Y=be(()=>(e(B),e(Ce),e(k),t(()=>e(B)[e(Ce)].messageIds[e(k)[e(Ce)]]))),ke=be(()=>(f(),i(N()),i(e(Y)),t(()=>f().find(Ne=>{var je;return Ne.id===((je=N().messages[e(Y)])==null?void 0:je.model)}))));var ne=So(),de=s(ne),te=s(de),me=s(te,!0);r(te),r(de),r(ne),x(()=>{Oe(ne,1,`min-w-fit ${e(_)==e(Ce)?" dark:border-gray-300 ":" opacity-35 border-transparent"} pb-1.5 px-2.5 transition border-b-2`),U(me,(i(e(ke)),i(N()),i(e(Y)),t(()=>{var Ne;return e(ke)?`${e(ke).name}`:(Ne=N().messages[e(Y)])==null?void 0:Ne.model})))}),Me("click",ne,async()=>{e(_)!=e(Ce)&&I(_,e(Ce)),D(e(Y),e(Ce))}),a(ye,ne)};g(vt,ye=>{e(k),e(Ce),e(B),t(()=>e(k)[e(Ce)]!==void 0&&e(B)[e(Ce)].messageIds.length>0)&&ye(Qe)})}a(Ee,Re)}),r(pe),r(V);var ue=$(V,2);{var Se=Ee=>{const Ce=be(()=>(e(B),e(_),e(k),t(()=>e(B)[e(_)].messageIds[e(k)[e(_)]])));var Re=we(),vt=ee(Re);Ia(vt,()=>(i(N()),t(()=>N().currentId)),Qe=>{var ye=we(),Y=ee(ye);{var ke=ne=>{Ua(ne,{get chatId(){return K()},get history(){return N()},get messageId(){return e(Ce)},get selectedModels(){return le()},isLastMessage:!0,get siblings(){return e(B),e(_),t(()=>e(B)[e(_)].messageIds)},gotoMessage:(de,te)=>H(e(_),te),showPreviousMessage:()=>y(e(_)),showNextMessage:()=>h(e(_)),get setInputText(){return Q()},get updateChat(){return oe()},get editMessage(){return o()},get saveMessage(){return ie()},get rateMessage(){return _e()},get deleteMessage(){return Ie()},get actionMessage(){return he()},get submitMessage(){return ce()},get continueResponse(){return ve()},regenerateResponse:async(de,te=null)=>{fe()(de,te),await at(),la(k,e(k)[e(_)]=e(B)[e(_)].messageIds.length-1)},get addMessages(){return c()},get readOnly(){return se()},get topPadding(){return v()}})};g(Y,ne=>{e(w)&&ne(ke)})}a(Qe,ye)}),a(Ee,Re)};g(ue,Ee=>{e(_)!==null&&Ee(Se)})}r(M),a(P,M)},xe=P=>{var M=we(),V=ee(M);Ct(V,1,()=>(e(B),t(()=>Object.keys(e(B)))),Wt,(pe,ue)=>{var Se=we(),Ee=ee(Se);{var Ce=Re=>{const vt=be(()=>(e(B),e(ue),e(k),t(()=>e(B)[e(ue)].messageIds[e(k)[e(ue)]])));var Qe=No(),ye=s(Qe);Ia(ye,()=>(i(N()),t(()=>N().currentId)),Y=>{var ke=we(),ne=ee(ke);{var de=te=>{Ua(te,{get chatId(){return K()},get history(){return N()},get messageId(){return e(vt)},get selectedModels(){return le()},isLastMessage:!0,get siblings(){return e(B),e(ue),t(()=>e(B)[e(ue)].messageIds)},gotoMessage:(me,Ne)=>H(e(ue),Ne),showPreviousMessage:()=>y(e(ue)),showNextMessage:()=>h(e(ue)),get setInputText(){return Q()},get updateChat(){return oe()},get editMessage(){return o()},get saveMessage(){return ie()},get rateMessage(){return _e()},get deleteMessage(){return Ie()},get actionMessage(){return he()},get submitMessage(){return ce()},get continueResponse(){return ve()},regenerateResponse:async(me,Ne=null)=>{fe()(me,Ne),await at(),la(k,e(k)[e(ue)]=e(B)[e(ue)].messageIds.length-1)},get addMessages(){return c()},get readOnly(){return se()},get editCodeBlock(){return j()},get topPadding(){return v()}})};g(ne,te=>{e(w)&&te(de)})}a(Y,ke)}),r(Qe),x(()=>Oe(Qe,1,` snap-center w-full max-w-full m-1 border ${i(N()),i(A()),e(ue),z(),t(()=>{var Y;return((Y=N().messages[A()])==null?void 0:Y.modelIdx)==e(ue)?`bg-gray-50 dark:bg-gray-850 border-gray-100 dark:border-gray-800 border-2 ${z()?"min-w-full":"min-w-80"}`:`border-gray-100 dark:border-gray-850 border-dashed ${z()?"min-w-full":"min-w-80"}`})??""} transition-all p-5 rounded-2xl`)),Me("click",Qe,async()=>{D(e(vt),e(ue))}),a(Re,Qe)};g(Ee,Re=>{e(k),e(ue),e(B),t(()=>e(k)[e(ue)]!==void 0&&e(B)[e(ue)].messageIds.length>0)&&Re(Ce)})}a(pe,Se)}),a(P,M)};g(G,P=>{l(),t(()=>{var M;return((M=l())==null?void 0:M.displayMultiModelResponsesInTabs)??!1})?P(re):P(xe,!1)})}r(X);var L=$(X,2);{var ge=P=>{var M=we(),V=ee(M);{var pe=ue=>{var Se=Ro(),Ee=s(Se),Ce=s(Ee);{var Re=ye=>{const Y=be(()=>(i(N()),i(A()),t(()=>{var je;return(je=N().messages[A()])==null?void 0:je.merged})));var ke=To(),ne=s(ke);Va(ne,{children:(je,lt)=>{Ta();var st=Bo(),$t=ee(st),ot=$($t);{var Ye=He=>{var Ve=Po(),Be=s(Ve,!0);r(Ve),x(St=>U(Be,St),[()=>(i(qt),i(e(Y)),t(()=>qt(e(Y).timestamp*1e3).format("LT")))]),a(He,Ve)};g(ot,He=>{i(e(Y)),t(()=>e(Y).timestamp)&&He(Ye)})}x(He=>U($t,`${He??""} `),[()=>(S(),t(()=>S().t("Merged Response")))]),a(je,st)},$$slots:{default:!0}});var de=$(ne,2),te=s(de);{var me=je=>{Za(je,{})},Ne=je=>{{let lt=be(()=>(i(e(Y)),t(()=>e(Y).content??"")));$a(je,{id:"merged",get content(){return e(lt)}})}};g(te,je=>{i(e(Y)),t(()=>{var lt;return(((lt=e(Y))==null?void 0:lt.content)??"")===""})?je(me):je(Ne,!1)})}r(de),r(ke),a(ye,ke)};g(Ce,ye=>{i(N()),i(A()),t(()=>{var Y,ke;return(ke=(Y=N().messages[A()])==null?void 0:Y.merged)==null?void 0:ke.status})&&ye(Re)})}r(Ee);var vt=$(Ee,2);{var Qe=ye=>{var Y=Oo(),ke=s(Y);{let ne=be(()=>(S(),t(()=>S().t("Merge Responses"))));Mt(ke,{get content(){return e(ne)},placement:"bottom",children:(de,te)=>{var me=Lo();Oe(me,1,"visible p-1 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition");var Ne=s(me);$o(Ne,{className:" size-5 "}),r(me),Me("click",me,()=>{T()}),a(de,me)},$$slots:{default:!0}})}r(Y),a(ye,Y)};g(vt,ye=>{d()&&ye(Qe)})}r(Se),a(ue,Se)};g(V,ue=>{e(B),e(k),i(N()),t(()=>!Object.keys(e(B)).find(Se=>{var Re;const{messageIds:Ee}=e(B)[Se],Ce=Ee[e(k)[Se]];return!((Re=N().messages[Ce])!=null&&Re.done)}))&&ue(pe)})}a(P,M)};g(L,P=>{se()||P(ge)})}r(J),x(()=>Te(X,"id",`responses-container-${K()??""}-${e(ae),t(()=>e(ae).id)??""}`)),a(O,J)};g(E,O=>{e(ae)&&O(Z)})}a(Pe,F),jt(),R()}var Ao=m("<div><!></div>"),Ho=m(' <span class=" text-gray-500 text-sm font-medium"> </span>',1),qo=m('<span class="line-clamp-1"> </span>'),Wo=m("<div><!></div>"),Do=m("<!> <!>",1),Uo=m("<div><!></div>"),Fo=m('<span class="line-clamp-1"> </span>'),Jo=m('<div class="flex justify-end pr-2 text-xs"><div><!></div></div>'),Vo=m("<div><!></div>"),Zo=m('<div class="mb-1 w-full flex flex-col justify-end overflow-x-auto gap-1 flex-wrap"></div>'),Go=m('<div class=" relative group"><div class="relative flex items-center"><!></div> <div class=" absolute -top-1 -right-1"><button type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-4"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"></path></svg></button></div></div>'),Ko=m('<div class="flex items-center flex-wrap gap-2 -mx-2 mb-1"></div>'),Qo=m('<div class=" w-full bg-gray-50 dark:bg-gray-800 rounded-3xl px-5 py-3 mb-2"><!> <div class="max-h-96 overflow-auto"><textarea class=" bg-transparent outline-hidden w-full resize-none"></textarea></div> <div class=" mt-2 mb-1 flex justify-between text-sm font-medium"><div><button id="save-edit-message-button" class="px-3.5 py-1.5 bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 border border-gray-100 dark:border-gray-700 text-gray-700 dark:text-gray-200 transition rounded-3xl"> </button></div> <div class="flex space-x-1.5"><button id="close-edit-message-button" class="px-3.5 py-1.5 bg-white dark:bg-gray-900 hover:bg-gray-100 text-gray-800 dark:text-gray-100 transition rounded-3xl"> </button> <button id="confirm-edit-message-button" class="px-3.5 py-1.5 bg-gray-900 dark:bg-white hover:bg-gray-850 text-gray-100 dark:text-gray-800 transition rounded-3xl"> </button></div></div></div>'),Yo=m('<div class="w-full"><div><div><!></div></div></div>'),Xo=m('<div class="text-sm flex justify-center font-semibold self-center dark:text-gray-100 min-w-fit"><input type="number" min="1" class="bg-transparent font-semibold self-center dark:text-gray-100 min-w-fit outline-hidden"/> </div>'),ei=m('<div class="text-sm tracking-widest font-semibold self-center dark:text-gray-100 min-w-fit"> </div>'),ti=m('<div class="flex self-center" dir="ltr"><button class="self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg></button> <!> <button class="self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"></path></svg></button></div>'),ai=m('<button><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.3" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"></path></svg></button>'),ri=m('<button><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.3" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184"></path></svg></button>'),si=m('<button><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"></path></svg></button>'),ni=m('<div class="text-sm flex justify-center font-semibold self-center dark:text-gray-100 min-w-fit"><input type="number" min="1" class="bg-transparent font-semibold self-center dark:text-gray-100 min-w-fit outline-hidden"/> </div>'),oi=m('<div class="text-sm tracking-widest font-semibold self-center dark:text-gray-100 min-w-fit"> </div>'),ii=m('<div class="flex self-center" dir="ltr"><button class="self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg></button> <!> <button class="self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"></path></svg></button></div>'),li=m("<div><!> <!> <!> <!> <!></div>"),di=m('<!> <div class=" flex w-full user-message group"><!> <div class="flex-auto w-0 max-w-full pl-1"><!> <div><!> <!> <!></div></div></div>',1);function vi(Pe,n){Rt(n,!1);const l=()=>Ae(q,"$i18n",b),f=()=>Ae(fa,"$settings",b),z=()=>Ae(ba,"$models",b),S=()=>Ae(La,"$_user",b),[b,R]=Zt(),q=Jt("i18n");qt.extend(cr);let K=u(n,"user",8),N=u(n,"chatId",8),A=u(n,"history",8),le=u(n,"messageId",8),d=u(n,"siblings",8),se=u(n,"gotoMessage",8),j=u(n,"showPreviousMessage",8),Q=u(n,"showNextMessage",8),oe=u(n,"editMessage",8),o=u(n,"deleteMessage",8),ie=u(n,"isFirstMessage",8),_e=u(n,"readOnly",8),he=u(n,"editCodeBlock",8,!0),ce=u(n,"topPadding",8,!1),Ie=$e(!1),ve=$e(!1),fe=$e(!1),W=$e(""),c=$e([]),C=$e(),v=$e(JSON.parse(JSON.stringify(A().messages[le()])));const ae=async P=>{await vr(P)&&Ut.success(l().t("Copying to clipboard was successful!"))},B=async()=>{var P,M;I(fe,!0),I(W,((P=e(v))==null?void 0:P.content)??""),I(c,e(v).files),await at(),e(C)&&(la(C,e(C).style.height=""),la(C,e(C).style.height=`${e(C).scrollHeight}px`),(M=e(C))==null||M.focus())},k=async(P=!0)=>{if(!e(W)&&(e(c)??[]).length===0){Ut.error(l().t("Please enter a message or attach a file."));return}oe()(e(v).id,{content:e(W),files:e(c)},P),I(fe,!1),I(W,""),I(c,[])},_=()=>{I(fe,!1),I(W,""),I(c,[])},w=async()=>{o()(e(v).id)};xa(()=>{}),Lt(()=>(i(A()),e(v),i(le())),()=>{A().messages&&JSON.stringify(e(v))!==JSON.stringify(A().messages[le()])&&I(v,JSON.parse(JSON.stringify(A().messages[le()])))}),sa(),zt();var H=di(),y=ee(H);{let P=be(()=>(l(),t(()=>l().t("Delete message?"))));ur(y,{get title(){return e(P)},get show(){return e(Ie)},set show(M){I(Ie,M)},$$events:{confirm:()=>{w()}},$$legacy:!0})}var h=$(y,2),p=s(h);{var D=P=>{var M=Ao();Oe(M,1,"shrink-0 ltr:mr-3 rtl:ml-3 mt-1");var V=s(M);{let pe=be(()=>(e(v),z(),i(da),i(K()),t(()=>{var ue,Se,Ee,Ce;return e(v).user?((Ee=(Se=(ue=z().find(Re=>Re.id===e(v).user))==null?void 0:ue.info)==null?void 0:Se.meta)==null?void 0:Ee.profile_image_url)??`${da}/user.png`:((Ce=K())==null?void 0:Ce.profile_image_url)??`${da}/user.png`})));gr(V,{get src(){return e(pe)},className:"size-8 user-message-profile-image"})}r(M),a(P,M)};g(p,P=>{f(),t(()=>{var M;return!(((M=f())==null?void 0:M.chatBubble)??!0)})&&P(D)})}var T=$(p,2),F=s(T);{var E=P=>{var M=Uo(),V=s(M);Va(V,{children:(pe,ue)=>{var Se=Do(),Ee=ee(Se);{var Ce=ye=>{var Y=Ho(),ke=ee(Y),ne=$(ke),de=s(ne,!0);r(ne),x(te=>{U(ke,`${te??""} `),U(de,(e(v),t(()=>{var me;return((me=e(v))==null?void 0:me.user)??""})))},[()=>(l(),t(()=>l().t("You")))]),a(ye,Y)},Re=ye=>{var Y=we(),ke=ee(Y);{var ne=te=>{var me=We();x(()=>U(me,(i(K()),t(()=>K().name)))),a(te,me)},de=te=>{var me=We();x(Ne=>U(me,Ne),[()=>(l(),t(()=>l().t("You")))]),a(te,me)};g(ke,te=>{f(),S(),i(K()),t(()=>f().showUsername||S().name!==K().name)?te(ne):te(de,!1)},!0)}a(ye,Y)};g(Ee,ye=>{e(v),t(()=>e(v).user)?ye(Ce):ye(Re,!1)})}var vt=$(Ee,2);{var Qe=ye=>{var Y=Wo(),ke=s(Y);{let ne=be(()=>(i(qt),e(v),t(()=>qt(e(v).timestamp*1e3).format("LLLL"))));Mt(ke,{get content(){return e(ne)},children:(de,te)=>{var me=qo(),Ne=s(me,!0);r(me),x(je=>U(Ne,je),[()=>(l(),i(ha),e(v),i(qt),t(()=>l().t(ha(e(v).timestamp*1e3),{LOCALIZED_TIME:qt(e(v).timestamp*1e3).format("LT"),LOCALIZED_DATE:qt(e(v).timestamp*1e3).format("L")})))]),a(de,me)},$$slots:{default:!0}})}r(Y),x(()=>Oe(Y,1,`self-center text-xs font-medium first-letter:capitalize ml-0.5 translate-y-[1px] ${f(),t(()=>{var ne;return((ne=f())==null?void 0:ne.highContrastMode)??!1?"dark:text-gray-900 text-gray-100":"invisible group-hover:visible transition"})??""}`)),a(ye,Y)};g(vt,ye=>{e(v),t(()=>e(v).timestamp)&&ye(Qe)})}a(pe,Se)},$$slots:{default:!0}}),r(M),a(P,M)},Z=P=>{var M=we(),V=ee(M);{var pe=ue=>{var Se=Jo(),Ee=s(Se),Ce=s(Ee);{let Re=be(()=>(i(qt),e(v),t(()=>qt(e(v).timestamp*1e3).format("LLLL"))));Mt(Ce,{get content(){return e(Re)},children:(vt,Qe)=>{var ye=Fo(),Y=s(ye,!0);r(ye),x(ke=>U(Y,ke),[()=>(l(),i(ha),e(v),i(qt),t(()=>l().t(ha(e(v).timestamp*1e3),{LOCALIZED_TIME:qt(e(v).timestamp*1e3).format("LT"),LOCALIZED_DATE:qt(e(v).timestamp*1e3).format("L")})))]),a(vt,ye)},$$slots:{default:!0}})}r(Ee),r(Se),x(()=>Oe(Ee,1,`text-[0.65rem] font-medium first-letter:capitalize mb-0.5 ${f(),t(()=>{var Re;return((Re=f())==null?void 0:Re.highContrastMode)??!1?"dark:text-gray-100 text-gray-900":"invisible group-hover:visible transition text-gray-400"})??""}`)),a(ue,Se)};g(V,ue=>{e(v),t(()=>e(v).timestamp)&&ue(pe)},!0)}a(P,M)};g(F,P=>{f(),t(()=>{var M;return!(((M=f())==null?void 0:M.chatBubble)??!0)})?P(E):P(Z,!1)})}var O=$(F,2),J=s(O);{var X=P=>{var M=we(),V=ee(M);{var pe=ue=>{var Se=Zo();Ct(Se,5,()=>(e(v),t(()=>e(v).files)),Wt,(Ee,Ce)=>{var Re=Vo(),vt=s(Re);{var Qe=Y=>{qa(Y,{get src(){return e(Ce),t(()=>e(Ce).url)},imageClassName:" max-h-96 rounded-lg"})},ye=Y=>{{let ke=be(()=>(e(Ce),t(()=>{var ne;return(ne=e(Ce))==null?void 0:ne.size})));Wa(Y,{get item(){return e(Ce)},get url(){return e(Ce),t(()=>e(Ce).url)},get name(){return e(Ce),t(()=>e(Ce).name)},get type(){return e(Ce),t(()=>e(Ce).type)},get size(){return e(ke)},small:!0})}};g(vt,Y=>{e(Ce),t(()=>e(Ce).type==="image")?Y(Qe):Y(ye,!1)})}r(Re),x(()=>Oe(Re,1,Ea((f(),t(()=>{var Y;return((Y=f())==null?void 0:Y.chatBubble)??!0?"self-end":""}))))),a(Ee,Re)}),r(Se),a(ue,Se)};g(V,ue=>{e(v),t(()=>e(v).files)&&ue(pe)})}a(P,M)};g(J,P=>{e(fe)!==!0&&P(X)})}var G=$(J,2);{var re=P=>{var M=Qo(),V=s(M);{var pe=de=>{var te=Ko();Ct(te,5,()=>e(c),Wt,(me,Ne,je)=>{var lt=we(),st=ee(lt);{var $t=Ye=>{var He=Go(),Ve=s(He),Be=s(Ve);qa(Be,{get src(){return e(Ne),t(()=>e(Ne).url)},alt:"input",imageClassName:" size-14 rounded-xl object-cover"}),r(Ve);var St=$(Ve,2),Gt=s(St);r(St),r(He),x(()=>Oe(Gt,1,` bg-white text-black border border-white rounded-full ${f(),t(()=>{var ta;return((ta=f())==null?void 0:ta.highContrastMode)??!1?"":"group-hover:visible invisible transition"})??""}`)),Me("click",Gt,()=>{e(c).splice(je,1),I(c,e(c))}),a(Ye,He)},ot=Ye=>{{let He=be(()=>(e(Ne),t(()=>{var Be;return(Be=e(Ne))==null?void 0:Be.size}))),Ve=be(()=>(e(Ne),t(()=>e(Ne).status==="uploading")));Wa(Ye,{get item(){return e(Ne)},get name(){return e(Ne),t(()=>e(Ne).name)},get type(){return e(Ne),t(()=>e(Ne).type)},get size(){return e(He)},get loading(){return e(Ve)},dismissible:!0,edit:!0,$$events:{dismiss:async()=>{e(c).splice(je,1),I(c,e(c))},click:()=>{e(Ne)}}})}};g(st,Ye=>{e(Ne),t(()=>e(Ne).type==="image")?Ye($t):Ye(ot,!1)})}a(me,lt)}),r(te),a(de,te)};g(V,de=>{e(c),t(()=>(e(c)??[]).length>0)&&de(pe)})}var ue=$(V,2),Se=s(ue);Fa(Se),pa(Se,de=>I(C,de),()=>e(C)),r(ue);var Ee=$(ue,2),Ce=s(Ee),Re=s(Ce),vt=s(Re,!0);r(Re),r(Ce);var Qe=$(Ce,2),ye=s(Qe),Y=s(ye,!0);r(ye);var ke=$(ye,2),ne=s(ke,!0);r(ke),r(Qe),r(Ee),r(M),x((de,te,me)=>{Te(Se,"id",`message-edit-${e(v),t(()=>e(v).id)??""}`),U(vt,de),U(Y,te),U(ne,me)},[()=>(l(),t(()=>l().t("Save"))),()=>(l(),t(()=>l().t("Cancel"))),()=>(l(),t(()=>l().t("Send")))]),Na(Se,()=>e(W),de=>I(W,de)),Me("input",Se,de=>{de.target.style.height="",de.target.style.height=`${de.target.scrollHeight}px`}),Me("keydown",Se,de=>{var Ne,je;de.key==="Escape"&&((Ne=document.getElementById("close-edit-message-button"))==null||Ne.click());const te=de.metaKey||de.ctrlKey,me=de.key==="Enter";te&&me&&((je=document.getElementById("confirm-edit-message-button"))==null||je.click())}),Me("click",Re,()=>{k(!1)}),Me("click",ye,()=>{_()}),Me("click",ke,()=>{k()}),a(P,M)},xe=P=>{var M=we(),V=ee(M);{var pe=ue=>{var Se=Yo(),Ee=s(Se),Ce=s(Ee),Re=s(Ce);{var vt=Qe=>{{let ye=be(()=>(i(N()),e(v),t(()=>`${N()}-${e(v).id}`)));$a(Qe,{get id(){return e(ye)},get content(){return e(v),t(()=>e(v).content)},get editCodeBlock(){return he()},get topPadding(){return ce()}})}};g(Re,Qe=>{e(v),t(()=>e(v).content)&&Qe(vt)})}r(Ce),r(Ee),r(Se),x(()=>{Oe(Ee,1,`flex ${f(),t(()=>{var Qe;return((Qe=f())==null?void 0:Qe.chatBubble)??!0?"justify-end pb-1":"w-full"})??""}`),Oe(Ce,1,`rounded-3xl ${f(),e(v),t(()=>{var Qe;return((Qe=f())==null?void 0:Qe.chatBubble)??!0?`max-w-[90%] px-4 py-1.5  bg-gray-50 dark:bg-gray-850 ${e(v).files?"rounded-tr-lg":""}`:" w-full"})??""}`)}),a(ue,Se)};g(V,ue=>{e(v),t(()=>e(v).content!=="")&&ue(pe)},!0)}a(P,M)};g(G,P=>{e(fe)===!0?P(re):P(xe,!1)})}var L=$(G,2);{var ge=P=>{var M=li(),V=s(M);{var pe=Y=>{var ke=we(),ne=ee(ke);{var de=te=>{var me=ti(),Ne=s(me),je=$(Ne,2);{var lt=ot=>{var Ye=Xo(),He=s(Ye);Ca(He);var Ve=$(He);r(Ye),x(Be=>{Te(He,"id",`message-index-input-${e(v),t(()=>e(v).id)??""}`),za(He,Be),Te(He,"max",(i(d()),t(()=>d().length))),U(Ve,`/${i(d()),t(()=>d().length)??""}`)},[()=>(i(d()),e(v),t(()=>d().indexOf(e(v).id)+1))]),Me("focus",He,Be=>{Be.target.select()}),Me("blur",He,Be=>{se()(e(v),Be.target.value-1),I(ve,!1)}),Me("keydown",He,Be=>{Be.key==="Enter"&&(se()(e(v),Be.target.value-1),I(ve,!1))}),a(ot,Ye)},st=ot=>{var Ye=ei(),He=s(Ye);r(Ye),x(Ve=>U(He,`${Ve??""}/${i(d()),t(()=>d().length)??""}`),[()=>(i(d()),e(v),t(()=>d().indexOf(e(v).id)+1))]),Me("dblclick",Ye,async()=>{I(ve,!0),await at();const Ve=document.getElementById(`message-index-input-${e(v).id}`);Ve&&(Ve.focus(),Ve.select())}),a(ot,Ye)};g(je,ot=>{e(ve)?ot(lt):ot(st,!1)})}var $t=$(je,2);r(me),x(()=>me.dir=me.dir),Me("click",Ne,()=>{j()(e(v))}),Me("click",$t,()=>{Q()(e(v))}),a(te,me)};g(ne,te=>{i(d()),t(()=>d().length>1)&&te(de)})}a(Y,ke)};g(V,Y=>{f(),t(()=>{var ke;return!(((ke=f())==null?void 0:ke.chatBubble)??!0)})&&Y(pe)})}var ue=$(V,2);{var Se=Y=>{{let ke=be(()=>(l(),t(()=>l().t("Edit"))));Mt(Y,{get content(){return e(ke)},placement:"bottom",children:(ne,de)=>{var te=ai();x(()=>Oe(te,1,`${f(),t(()=>{var me;return((me=f())==null?void 0:me.highContrastMode)??!1?"":"invisible group-hover:visible"})??""} p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition edit-user-message-button`)),Me("click",te,()=>{B()}),a(ne,te)},$$slots:{default:!0}})}};g(ue,Y=>{_e()||Y(Se)})}var Ee=$(ue,2);{var Ce=Y=>{{let ke=be(()=>(l(),t(()=>l().t("Copy"))));Mt(Y,{get content(){return e(ke)},placement:"bottom",children:(ne,de)=>{var te=ri();x(()=>Oe(te,1,`${f(),t(()=>{var me;return((me=f())==null?void 0:me.highContrastMode)??!1?"":"invisible group-hover:visible"})??""} p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition`)),Me("click",te,()=>{ae(e(v).content)}),a(ne,te)},$$slots:{default:!0}})}};g(Ee,Y=>{e(v),t(()=>{var ke;return(ke=e(v))==null?void 0:ke.content})&&Y(Ce)})}var Re=$(Ee,2);{var vt=Y=>{var ke=we(),ne=ee(ke);{var de=te=>{{let me=be(()=>(l(),t(()=>l().t("Delete"))));Mt(te,{get content(){return e(me)},placement:"bottom",children:(Ne,je)=>{var lt=si();x(()=>Oe(lt,1,`${f(),t(()=>{var st;return((st=f())==null?void 0:st.highContrastMode)??!1?"":"invisible group-hover:visible"})??""} p-1 rounded-sm dark:hover:text-white hover:text-black transition`)),Me("click",lt,()=>{I(Ie,!0)}),a(Ne,lt)},$$slots:{default:!0}})}};g(ne,te=>{i(_e()),i(ie()),i(d()),t(()=>!_e()&&(!ie()||d().length>1))&&te(de)})}a(Y,ke)};g(Re,Y=>{S(),t(()=>{var ke,ne,de,te;return((ke=S())==null?void 0:ke.role)==="admin"||(((te=(de=(ne=S())==null?void 0:ne.permissions)==null?void 0:de.chat)==null?void 0:te.delete_message)??!1)})&&Y(vt)})}var Qe=$(Re,2);{var ye=Y=>{var ke=we(),ne=ee(ke);{var de=te=>{var me=ii(),Ne=s(me),je=$(Ne,2);{var lt=ot=>{var Ye=ni(),He=s(Ye);Ca(He);var Ve=$(He);r(Ye),x(Be=>{Te(He,"id",`message-index-input-${e(v),t(()=>e(v).id)??""}`),za(He,Be),Te(He,"max",(i(d()),t(()=>d().length))),U(Ve,`/${i(d()),t(()=>d().length)??""}`)},[()=>(i(d()),e(v),t(()=>d().indexOf(e(v).id)+1))]),Me("focus",He,Be=>{Be.target.select()}),Me("blur",He,Be=>{se()(e(v),Be.target.value-1),I(ve,!1)}),Me("keydown",He,Be=>{Be.key==="Enter"&&(se()(e(v),Be.target.value-1),I(ve,!1))}),a(ot,Ye)},st=ot=>{var Ye=oi(),He=s(Ye);r(Ye),x(Ve=>U(He,`${Ve??""}/${i(d()),t(()=>d().length)??""}`),[()=>(i(d()),e(v),t(()=>d().indexOf(e(v).id)+1))]),Me("dblclick",Ye,async()=>{I(ve,!0),await at();const Ve=document.getElementById(`message-index-input-${e(v).id}`);Ve&&(Ve.focus(),Ve.select())}),a(ot,Ye)};g(je,ot=>{e(ve)?ot(lt):ot(st,!1)})}var $t=$(je,2);r(me),x(()=>me.dir=me.dir),Me("click",Ne,()=>{j()(e(v))}),Me("click",$t,()=>{Q()(e(v))}),a(te,me)};g(ne,te=>{i(d()),t(()=>d().length>1)&&te(de)})}a(Y,ke)};g(Qe,Y=>{f(),t(()=>{var ke;return((ke=f())==null?void 0:ke.chatBubble)??!0})&&Y(ye)})}r(M),x(()=>Oe(M,1,` flex ${f(),t(()=>{var Y;return((Y=f())==null?void 0:Y.chatBubble)??!0?"justify-end":""})??""}  text-gray-600 dark:text-gray-500`)),a(P,M)};g(L,P=>{e(fe)!==!0&&P(ge)})}r(O),r(T),r(h),x(()=>{Te(h,"dir",(f(),t(()=>f().chatDirection))),Te(h,"id",`message-${e(v),t(()=>e(v).id)??""}`),Oe(O,1,`chat-${e(v),t(()=>e(v).role)??""} w-full min-w-full markdown-prose`),h.dir=h.dir}),a(Pe,H),jt(),R()}var ci=m('<div role="listitem"><!></div>');function gi(Pe,n){Rt(n,!1);const l=()=>Ae(fa,"$settings",f),[f,z]=Zt();Sa(),Jt("i18n");let S=u(n,"chatId",8),b=u(n,"selectedModels",24,()=>[]),R=u(n,"idx",8,0),q=u(n,"history",12),K=u(n,"messageId",8),N=u(n,"user",8),A=u(n,"setInputText",8,()=>{}),le=u(n,"gotoMessage",8),d=u(n,"showPreviousMessage",8),se=u(n,"showNextMessage",8),j=u(n,"updateChat",8),Q=u(n,"editMessage",8),oe=u(n,"saveMessage",8),o=u(n,"deleteMessage",8),ie=u(n,"rateMessage",8),_e=u(n,"actionMessage",8),he=u(n,"submitMessage",8),ce=u(n,"regenerateResponse",8),Ie=u(n,"continueResponse",8),ve=u(n,"mergeResponses",8),fe=u(n,"addMessages",8),W=u(n,"triggerScroll",8),c=u(n,"readOnly",8,!1),C=u(n,"editCodeBlock",8,!0),v=u(n,"topPadding",8,!1);zt();var ae=ci(),B=s(ae);{var k=_=>{var w=we(),H=ee(w);{var y=p=>{{let D=be(()=>R()===0),T=be(()=>(i(q()),i(K()),t(()=>{var F;return q().messages[K()].parentId!==null?((F=q().messages[q().messages[K()].parentId])==null?void 0:F.childrenIds)??[]:Object.values(q().messages).filter(E=>E.parentId===null).map(E=>E.id)??[]})));vi(p,{get user(){return N()},get chatId(){return S()},get history(){return q()},get messageId(){return K()},get isFirstMessage(){return e(D)},get siblings(){return e(T)},get gotoMessage(){return le()},get showPreviousMessage(){return d()},get showNextMessage(){return se()},get editMessage(){return Q()},get deleteMessage(){return o()},get readOnly(){return c()},get editCodeBlock(){return C()},get topPadding(){return v()}})}},h=p=>{var D=we(),T=ee(D);{var F=Z=>{{let O=be(()=>(i(K()),i(q()),t(()=>K()===q().currentId))),J=be(()=>(i(q()),i(K()),t(()=>{var X;return((X=q().messages[q().messages[K()].parentId])==null?void 0:X.childrenIds)??[]})));Ua(Z,{get chatId(){return S()},get history(){return q()},get messageId(){return K()},get selectedModels(){return b()},get isLastMessage(){return e(O)},get siblings(){return e(J)},get setInputText(){return A()},get gotoMessage(){return le()},get showPreviousMessage(){return d()},get showNextMessage(){return se()},get updateChat(){return j()},get editMessage(){return Q()},get saveMessage(){return oe()},get rateMessage(){return ie()},get actionMessage(){return _e()},get submitMessage(){return he()},get deleteMessage(){return o()},get continueResponse(){return Ie()},get regenerateResponse(){return ce()},get addMessages(){return fe()},get readOnly(){return c()},get editCodeBlock(){return C()},get topPadding(){return v()}})}},E=Z=>{{let O=be(()=>(i(K()),i(q()),t(()=>{var J;return K()===((J=q())==null?void 0:J.currentId)})));zo(Z,{get chatId(){return S()},get messageId(){return K()},get selectedModels(){return b()},get isLastMessage(){return e(O)},get setInputText(){return A()},get updateChat(){return j()},get editMessage(){return Q()},get saveMessage(){return oe()},get rateMessage(){return ie()},get actionMessage(){return _e()},get submitMessage(){return he()},get deleteMessage(){return o()},get continueResponse(){return Ie()},get regenerateResponse(){return ce()},get mergeResponses(){return ve()},get triggerScroll(){return W()},get addMessages(){return fe()},get readOnly(){return c()},get editCodeBlock(){return C()},get topPadding(){return v()},get history(){return q()},set history(J){q(J)},$$legacy:!0})}};g(T,Z=>{i(q()),i(K()),t(()=>{var O,J;return(((J=(O=q().messages[q().messages[K()].parentId])==null?void 0:O.models)==null?void 0:J.length)??1)===1})?Z(F):Z(E,!1)},!0)}a(p,D)};g(H,p=>{i(q()),i(K()),t(()=>q().messages[K()].role==="user")?p(y):p(h,!1)})}a(_,w)};g(B,_=>{i(q()),i(K()),t(()=>q().messages[K()])&&_(k)})}r(ae),x(()=>Oe(ae,1,`flex flex-col justify-between px-5 mb-3 w-full ${l(),t(()=>{var _;return((_=l())==null?void 0:_.widescreenMode)??null?"max-w-full":"max-w-5xl"})??""} mx-auto rounded-lg group`)),a(Pe,ae),jt(),z()}var ui=m("<!> ",1),fi=m("<div> </div>"),mi=m('<div class="font-medium dark:text-gray-300 dark:group-hover:text-gray-200 transition line-clamp-1 svelte-6tnq1o"> </div> <div class="text-xs text-gray-600 dark:text-gray-400 font-normal line-clamp-1 svelte-6tnq1o"> </div>',1),hi=m('<div class="font-medium dark:text-gray-300 dark:group-hover:text-gray-200 transition line-clamp-1 svelte-6tnq1o"> </div> <div class="text-xs text-gray-600 dark:text-gray-400 font-normal line-clamp-1 svelte-6tnq1o"> </div>',1),_i=m(`<button role="listitem" class="waterfall flex flex-col flex-1 shrink-0 w-full justify-between
				       px-3 py-2 rounded-xl bg-transparent hover:bg-black/5
				       dark:hover:bg-white/5 transition group svelte-6tnq1o"><div class="flex flex-col text-left svelte-6tnq1o"><!></div></button>`),pi=m('<div role="list"></div>'),xi=m('<div class="mb-1 flex gap-1 text-xs font-medium items-center text-gray-600 dark:text-gray-400 svelte-6tnq1o"><!></div> <div class="h-40 w-full svelte-6tnq1o"><!></div>',1);function bi(Pe,n){Rt(n,!1);const l=()=>Ae(R,"$i18n",S),f=()=>Ae(fa,"$settings",S),z=()=>Ae($r,"$WEBUI_NAME",S),[S,b]=Zt(),R=Jt("i18n");let q=u(n,"suggestionPrompts",24,()=>[]),K=u(n,"className",8,""),N=u(n,"inputValue",8,""),A=u(n,"onSelect",8,W=>{}),le=$e([]);const d={keys:["content","title"],threshold:.5};let se=$e(),j=$e([]);function Q(W,c){if(W.length!==c.length)return!1;for(let C=0;C<W.length;C++)if((W[C].id??W[C].content)!==(c[C].id??c[C].content))return!1;return!0}const oe=W=>{if(W.length>500)I(j,[]);else{const c=W.trim()&&e(se)?e(se).search(W.trim()).map(C=>C.item):e(le);Q(e(j),c)||I(j,c)}};Lt(()=>(i(q()),i(N())),()=>{q()&&(I(le,[...q()??[]].sort(()=>Math.random()-.5)),oe(N()))}),Lt(()=>e(le),()=>{I(se,new ss(e(le),d))}),Lt(()=>i(N()),()=>{oe(N())}),sa(),zt();var o=xi(),ie=ee(o),_e=s(ie);{var he=W=>{var c=ui(),C=ee(c);Wr(C,{});var v=$(C);x(ae=>U(v,` ${ae??""}`),[()=>(l(),t(()=>l().t("Suggested")))]),a(W,c)},ce=W=>{var c=fi(),C=s(c);r(c),x(()=>{Oe(c,1,`flex w-full ${f(),t(()=>{var v;return((v=f())==null?void 0:v.landingPageMode)==="chat"?" -mt-1":"text-center items-center justify-center"})??""}  self-start text-gray-600 dark:text-gray-400`,"svelte-6tnq1o"),U(C,`${z()??""}  v${Cr}`)}),a(W,c)};g(_e,W=>{e(j),t(()=>e(j).length>0)?W(he):W(ce,!1)})}r(ie);var Ie=$(ie,2),ve=s(Ie);{var fe=W=>{var c=pi();Ct(c,7,()=>e(j),(C,v)=>C.id||`${C.content}-${v}`,(C,v,ae)=>{var B=_i(),k=s(B),_=s(k);{var w=y=>{var h=mi(),p=ee(h),D=s(p,!0);r(p);var T=$(p,2),F=s(T,!0);r(T),x(()=>{U(D,(e(v),t(()=>e(v).title[0]))),U(F,(e(v),t(()=>e(v).title[1])))}),a(y,h)},H=y=>{var h=hi(),p=ee(h),D=s(p,!0);r(p);var T=$(p,2),F=s(T,!0);r(T),x(E=>{U(D,(e(v),t(()=>e(v).content))),U(F,E)},[()=>(l(),t(()=>l().t("Prompt")))]),a(y,h)};g(_,y=>{e(v),t(()=>e(v).title&&e(v).title[0]!=="")?y(w):y(H,!1)})}r(k),r(B),x(()=>br(B,`animation-delay: ${e(ae)*60}ms`)),Me("click",B,()=>A()({type:"prompt",data:e(v).content})),a(C,B)}),r(c),x(()=>Oe(c,1,`max-h-40 overflow-auto scrollbar-none items-start ${K()??""}`,"svelte-6tnq1o")),a(W,c)};g(ve,W=>{e(j),t(()=>e(j).length>0)&&W(fe)})}r(Ie),a(Pe,o),jt(),b()}var wi=m('<img crossorigin="anonymous" class=" size-[2.7rem] rounded-full border-[1px] border-gray-100 dark:border-none" alt="logo" draggable="false"/>'),yi=m("<button><!></button>"),ki=m('<div class="flex items-center gap-2 text-gray-500 text-lg mt-2 w-fit"><!> </div>'),Mi=m("<a> </a>"),Ii=m('<div class="mt-0.5 text-sm font-normal text-gray-400 dark:text-gray-500">By <!></div>'),Ci=m('<div class="mt-0.5 text-base font-normal text-gray-500 dark:text-gray-400 line-clamp-3 markdown"><!></div> <!>',1),$i=m('<div class=" text-gray-400 dark:text-gray-500 line-clamp-1 font-p"> </div>'),Si=m('<div class="m-auto w-full max-w-6xl px-8 lg:px-20"><div class="flex justify-start"><div class="flex -space-x-4 mb-0.5"></div></div> <!> <div class=" mt-2 mb-4 text-3xl text-gray-800 dark:text-gray-100 text-left flex items-center gap-4 font-primary"><div><div class=" capitalize line-clamp-1"><!></div> <div><!></div></div></div> <div class=" w-full font-primary"><!></div></div>');function Ei(Pe,n){Rt(n,!1);const l=()=>Ae(ba,"$_models",R),f=()=>Ae(K,"$i18n",R),z=()=>Ae(Ja,"$temporaryChatEnabled",R),S=()=>Ae(La,"$user",R),b=()=>Ae(dr,"$config",R),[R,q]=Zt(),K=Jt("i18n");let N=u(n,"modelIds",24,()=>[]),A=u(n,"models",28,()=>[]),le=u(n,"atSelectedModel",8),d=u(n,"onSelect",8,o=>{}),se=$e(!1),j=$e(0);xa(()=>{I(se,!0)}),Lt(()=>(i(N()),l()),()=>{A(N().map(o=>l().find(ie=>ie.id===o)))}),Lt(()=>(i(N()),i(A())),()=>{N().length>0&&I(j,A().length-1)}),sa(),zt();var Q=we(),oe=ee(Q);Ia(oe,()=>e(se),o=>{var ie=Si(),_e=s(ie),he=s(_e);Ct(he,5,A,Wt,(y,h,p)=>{var D=yi(),T=s(D);{let F=be(()=>(i(Ba),i(_a),i(A()),e(j),t(()=>{var E,Z,O;return Ba.parse(_a(((O=(Z=(E=A()[e(j)])==null?void 0:E.info)==null?void 0:Z.meta)==null?void 0:O.description)??"").replaceAll(`
`,"<br>"))})));Mt(T,{get content(){return e(F)},placement:"right",children:(E,Z)=>{var O=wi();x(()=>Te(O,"src",(e(h),f(),i(da),t(()=>{var J,X,G;return((G=(X=(J=e(h))==null?void 0:J.info)==null?void 0:X.meta)==null?void 0:G.profile_image_url)??(f().language==="dg-DG"?`${da}/doge.png`:`${da}/static/favicon.png`)})))),a(E,O)},$$slots:{default:!0}})}r(D),Me("click",D,()=>{I(j,p)}),a(y,D)}),r(he),r(_e);var ce=$(_e,2);{var Ie=y=>{{let h=be(()=>(f(),t(()=>f().t("This chat won't appear in history and your messages will not be saved."))));Mt(y,{get content(){return e(h)},className:"w-full flex justify-start mb-0.5",placement:"top",children:(p,D)=>{var T=ki(),F=s(T);ns(F,{strokeWidth:"2.5",className:"size-5"});var E=$(F,1,!0);r(T),x(Z=>U(E,Z),[()=>(f(),t(()=>f().t("Temporary Chat")))]),a(p,T)},$$slots:{default:!0}})}};g(ce,y=>{z()&&y(Ie)})}var ve=$(ce,2),fe=s(ve),W=s(fe),c=s(W);{var C=y=>{var h=We();x(()=>U(h,(i(A()),e(j),t(()=>{var p;return(p=A()[e(j)])==null?void 0:p.name})))),a(y,h)},v=y=>{var h=We();x(p=>U(h,p),[()=>(f(),S(),t(()=>{var p;return f().t("Hello, {{name}}",{name:(p=S())==null?void 0:p.name})}))]),a(y,h)};g(c,y=>{i(A()),e(j),t(()=>{var h;return(h=A()[e(j)])==null?void 0:h.name})?y(C):y(v,!1)})}r(W);var ae=$(W,2),B=s(ae);{var k=y=>{var h=Ci(),p=ee(h),D=s(p);rs(D,()=>(i(Ba),i(_a),i(A()),e(j),t(()=>{var E,Z,O;return Ba.parse(_a((O=(Z=(E=A()[e(j)])==null?void 0:E.info)==null?void 0:Z.meta)==null?void 0:O.description).replaceAll(`
`,"<br>"))}))),r(p);var T=$(p,2);{var F=E=>{var Z=Ii(),O=$(s(Z));{var J=G=>{var re=Mi(),xe=s(re,!0);r(re),x(()=>{Te(re,"href",`https://openwebui.com/m/${i(A()),e(j),t(()=>{var L,ge,P;return(P=(ge=(L=A()[e(j)])==null?void 0:L.info)==null?void 0:ge.meta)==null?void 0:P.user.username})??""}`),U(xe,(i(A()),e(j),t(()=>{var L,ge,P,M,V,pe,ue,Se,Ee;return(P=(ge=(L=A()[e(j)])==null?void 0:L.info)==null?void 0:ge.meta)!=null&&P.user.name?(pe=(V=(M=A()[e(j)])==null?void 0:M.info)==null?void 0:V.meta)==null?void 0:pe.user.name:`@${(Ee=(Se=(ue=A()[e(j)])==null?void 0:ue.info)==null?void 0:Se.meta)==null?void 0:Ee.user.username}`})))}),a(G,re)},X=G=>{var re=We();x(()=>U(re,(i(A()),e(j),t(()=>{var xe,L,ge;return(ge=(L=(xe=A()[e(j)])==null?void 0:xe.info)==null?void 0:L.meta)==null?void 0:ge.user.name})))),a(G,re)};g(O,G=>{i(A()),e(j),t(()=>{var re,xe,L;return(L=(xe=(re=A()[e(j)])==null?void 0:re.info)==null?void 0:xe.meta)==null?void 0:L.user.community})?G(J):G(X,!1)})}r(Z),a(E,Z)};g(T,E=>{i(A()),e(j),t(()=>{var Z,O,J;return(J=(O=(Z=A()[e(j)])==null?void 0:Z.info)==null?void 0:O.meta)==null?void 0:J.user})&&E(F)})}a(y,h)},_=y=>{var h=$i(),p=s(h,!0);r(h),x(D=>U(p,D),[()=>(f(),t(()=>f().t("How can I help you today?")))]),a(y,h)};g(B,y=>{i(A()),e(j),t(()=>{var h,p,D;return((D=(p=(h=A()[e(j)])==null?void 0:h.info)==null?void 0:p.meta)==null?void 0:D.description)??null})?y(k):y(_,!1)})}r(ae),r(fe),r(ve);var w=$(ve,2),H=s(w);{let y=be(()=>(i(le()),i(A()),e(j),b(),t(()=>{var h,p,D,T,F,E,Z;return((D=(p=(h=le())==null?void 0:h.info)==null?void 0:p.meta)==null?void 0:D.suggestion_prompts)??((E=(F=(T=A()[e(j)])==null?void 0:T.info)==null?void 0:F.meta)==null?void 0:E.suggestion_prompts)??((Z=b())==null?void 0:Z.default_prompt_suggestions)??[]})));bi(H,{className:"grid grid-cols-2",get suggestionPrompts(){return e(y)},get onSelect(){return d()}})}r(w),r(ie),ka(1,he,()=>Ma,()=>({duration:200})),ka(1,W,()=>Ma,()=>({duration:200})),ka(1,ae,()=>Ma,()=>({duration:200,delay:200})),ka(1,w,()=>Ma,()=>({duration:200,delay:300})),a(o,ie)}),a(Pe,Q),jt(),q()}var Ni=m('<div class="w-full flex justify-center py-1 text-xs animate-pulse items-center gap-2"><!> <div class=" "> </div></div>'),Pi=m('<div class="  pb-6"></div>'),Bi=m('<section class="w-full" aria-labelledby="chat-conversation"><h2 class="sr-only" id="chat-conversation"> </h2> <!> <ul role="log" aria-live="polite" aria-relevant="additions" aria-atomic="false"></ul></section> <div class="pb-18"></div> <!>',1),Ti=m('<div class="w-full pt-2"><!></div>'),Li=m("<div><!></div>");function ql(Pe,n){Rt(n,!1);const l=()=>Ae(La,"$_user",R),f=()=>Ae(Ja,"$temporaryChatEnabled",R),z=()=>Ae(er,"$currentChatPage",R),S=()=>Ae(fa,"$settings",R),b=()=>Ae(K,"$i18n",R),[R,q]=Zt();Sa();const K=Jt("i18n");let N=u(n,"className",8,"h-full flex pt-8"),A=u(n,"chatId",8,""),le=u(n,"user",24,l);u(n,"prompt",8);let d=u(n,"history",28,()=>({})),se=u(n,"selectedModels",8),j=u(n,"atSelectedModel",8),Q=$e([]),oe=u(n,"setInputText",8,()=>{}),o=u(n,"sendMessage",8),ie=u(n,"continueResponse",8),_e=u(n,"regenerateResponse",8),he=u(n,"mergeResponses",8),ce=u(n,"chatActionHandler",8),Ie=u(n,"showMessage",8,()=>{}),ve=u(n,"submitMessage",8,()=>{}),fe=u(n,"addMessages",8,()=>{}),W=u(n,"readOnly",8,!1),c=u(n,"editCodeBlock",8,!0),C=u(n,"topPadding",8,!1),v=u(n,"bottomPadding",8,!1),ae=u(n,"autoScroll",12),B=u(n,"onSelect",8,L=>{}),k=u(n,"messagesCount",12,20),_=$e(!1);const w=async()=>{const L=document.getElementById("messages-container");L.scrollTop=L.scrollTop+100,I(_,!0),k(k()+20),await at(),I(_,!1)},H=()=>{const L=document.getElementById("messages-container");L.scrollTop=L.scrollHeight},y=async()=>{f()||(d(d()),await at(),await Nr(localStorage.token,A(),{history:d(),messages:e(Q)}),er.set(1),await Sr.set(await Pr(localStorage.token,z())))},h=async(L,ge)=>{var V;let P;L.parentId!==null?P=d().messages[L.parentId].childrenIds:P=Object.values(d().messages).filter(pe=>pe.parentId===null).map(pe=>pe.id),ge=Math.max(0,Math.min(ge,P.length-1));let M=P[ge];if(L.id!==M){let pe=d().messages[M].childrenIds;for(;pe.length!==0;)M=pe.at(-1),pe=d().messages[M].childrenIds;d(d().currentId=M,!0)}if(await at(),((V=S())==null?void 0:V.scrollOnBranchChange)??!0){const pe=document.getElementById("messages-container");ae(pe.scrollHeight-pe.scrollTop<=pe.clientHeight+50),setTimeout(()=>{H()},100)}},p=async L=>{var ge;if(L.parentId!==null){let P=d().messages[L.parentId].childrenIds[Math.max(d().messages[L.parentId].childrenIds.indexOf(L.id)-1,0)];if(L.id!==P){let M=d().messages[P].childrenIds;for(;M.length!==0;)P=M.at(-1),M=d().messages[P].childrenIds;d(d().currentId=P,!0)}}else{let P=Object.values(d().messages).filter(V=>V.parentId===null).map(V=>V.id),M=P[Math.max(P.indexOf(L.id)-1,0)];if(L.id!==M){let V=d().messages[M].childrenIds;for(;V.length!==0;)M=V.at(-1),V=d().messages[M].childrenIds;d(d().currentId=M,!0)}}if(await at(),((ge=S())==null?void 0:ge.scrollOnBranchChange)??!0){const P=document.getElementById("messages-container");ae(P.scrollHeight-P.scrollTop<=P.clientHeight+50),setTimeout(()=>{H()},100)}},D=async L=>{var ge;if(L.parentId!==null){let P=d().messages[L.parentId].childrenIds[Math.min(d().messages[L.parentId].childrenIds.indexOf(L.id)+1,d().messages[L.parentId].childrenIds.length-1)];if(L.id!==P){let M=d().messages[P].childrenIds;for(;M.length!==0;)P=M.at(-1),M=d().messages[P].childrenIds;d(d().currentId=P,!0)}}else{let P=Object.values(d().messages).filter(V=>V.parentId===null).map(V=>V.id),M=P[Math.min(P.indexOf(L.id)+1,P.length-1)];if(L.id!==M){let V=d().messages[M].childrenIds;for(;V.length!==0;)M=V.at(-1),V=d().messages[M].childrenIds;d(d().currentId=M,!0)}}if(await at(),((ge=S())==null?void 0:ge.scrollOnBranchChange)??!0){const P=document.getElementById("messages-container");ae(P.scrollHeight-P.scrollTop<=P.clientHeight+50),setTimeout(()=>{H()},100)}},T=async(L,ge)=>{d(d().messages[L].annotation={...d().messages[L].annotation,rating:ge},!0),await y()},F=async(L,{content:ge,files:P},M=!0)=>{if((se()??[]).filter(V=>V).length===0){Ut.error(b().t("Model not selected"));return}if(d().messages[L].role==="user")if(M){let V=ge,pe=ar(),ue={id:pe,parentId:d().messages[L].parentId,childrenIds:[],role:"user",content:V,...P&&{files:P},models:se(),timestamp:Math.floor(Date.now()/1e3)},Se=d().messages[L].parentId;Se!==null&&d(d().messages[Se].childrenIds=[...d().messages[Se].childrenIds,pe],!0),d(d().messages[pe]=ue,!0),d(d().currentId=pe,!0),await at(),await o()(d(),pe)}else d(d().messages[L].content=ge,!0),d(d().messages[L].files=P,!0),await y();else if(M){const V=ar(),pe=d().messages[L],ue=pe.parentId,Se={...pe,id:V,parentId:ue,childrenIds:[],files:void 0,content:ge,timestamp:Math.floor(Date.now()/1e3)};d(d().messages[V]=Se,!0),d(d().currentId=V,!0),ue!==null&&d(d().messages[ue].childrenIds=[...d().messages[ue].childrenIds,V],!0),await y()}else d(d().messages[L].originalContent=d().messages[L].content,!0),d(d().messages[L].content=ge,!0),await y()},E=async(L,ge,P=null)=>{await ce()(A(),L,ge.model,ge.id,P)},Z=async(L,ge)=>{d(d().messages[L]=ge,!0),await y()},O=async L=>{const ge=d().messages[L],P=ge.parentId,M=ge.childrenIds??[],V=M.flatMap(pe=>{var ue;return((ue=d().messages[pe])==null?void 0:ue.childrenIds)??[]});P&&d().messages[P]&&d(d().messages[P].childrenIds=[...d().messages[P].childrenIds.filter(pe=>pe!==L),...V],!0),V.forEach(pe=>{d().messages[pe]&&d(d().messages[pe].parentId=P,!0)}),[L,...M].forEach(pe=>{delete d().messages[pe]}),await at(),Ie()({id:P}),await y()},J=()=>{if(ae()){const L=document.getElementById("messages-container");ae(L.scrollHeight-L.scrollTop<=L.clientHeight+50),setTimeout(()=>{H()},100)}};Lt(()=>(i(d()),i(k())),()=>{if(d().currentId){let L=[],ge=d().messages[d().currentId];for(;ge&&(k()===null||L.length<=k());)L.unshift({...ge}),ge=ge.parentId!==null?d().messages[ge.parentId]:null;I(Q,L)}else I(Q,[])}),Lt(()=>(i(ae()),i(v()),at),()=>{ae()&&v()&&(async()=>(await at(),H()))()}),sa(),zt();var X=Li(),G=s(X);{var re=L=>{Ei(L,{get modelIds(){return se()},get atSelectedModel(){return j()},get onSelect(){return B()}})},xe=L=>{var ge=Ti(),P=s(ge);Ia(P,A,M=>{var V=Bi(),pe=ee(V),ue=s(pe),Se=s(ue,!0);r(ue);var Ee=$(ue,2);{var Ce=ye=>{as(ye,{$$events:{visible:Y=>{e(_)||w()}},children:(Y,ke)=>{var ne=Ni(),de=s(ne);Ga(de,{className:" size-4"});var te=$(de,2),me=s(te,!0);r(te),r(ne),x(Ne=>U(me,Ne),[()=>(b(),t(()=>b().t("Loading...")))]),a(Y,ne)},$$slots:{default:!0}})};g(Ee,ye=>{e(Q),t(()=>{var Y;return((Y=e(Q).at(0))==null?void 0:Y.parentId)!==null})&&ye(Ce)})}var Re=$(Ee,2);Ct(Re,7,()=>e(Q),ye=>ye.id,(ye,Y,ke)=>{gi(ye,{get chatId(){return A()},get selectedModels(){return se()},get messageId(){return e(Y),t(()=>e(Y).id)},get idx(){return e(ke)},get user(){return le()},get setInputText(){return oe()},gotoMessage:h,showPreviousMessage:p,showNextMessage:D,updateChat:y,editMessage:F,deleteMessage:O,rateMessage:T,actionMessage:E,saveMessage:Z,get submitMessage(){return ve()},get regenerateResponse(){return _e()},get continueResponse(){return ie()},get mergeResponses(){return he()},get addMessages(){return fe()},triggerScroll:J,get readOnly(){return W()},get editCodeBlock(){return c()},get topPadding(){return C()},get history(){return d()},set history(ne){d(ne)},$$legacy:!0})}),r(Re),r(pe);var vt=$(pe,4);{var Qe=ye=>{var Y=Pi();a(ye,Y)};g(vt,ye=>{v()&&ye(Qe)})}x(ye=>U(Se,ye),[()=>(b(),t(()=>b().t("Chat Conversation")))]),a(M,V)}),r(ge),a(L,ge)};g(G,L=>{i(d()),t(()=>{var ge;return Object.keys(((ge=d())==null?void 0:ge.messages)??{}).length==0})?L(re):L(xe,!1)})}r(X),x(()=>Oe(X,1,Ea(N()))),a(Pe,X),jt(),q()}export{ln as K,ql as M,bi as S};
//# sourceMappingURL=DnLyDyZf.js.map
