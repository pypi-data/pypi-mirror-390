import"./CWj6FrbW.js";import"./CN51-NxK.js";import{b as Et,g as Tt,q as Pt,i as S,j as o,u as pt,v as Ut,c as e,r as a,k as v,t as B,w as c,s as _,l as R,a as w,p as Ft,f as P,m as ot,e as vt,A as Rt,z as mt,y as Jt,n as Mt,aX as bt,x as Gt}from"./CvTLsZlf.js";import{i as Y}from"./B3D73U8p.js";import{a as Dt,r as Wt,s as Kt}from"./CPzR4-ix.js";import{i as At}from"./CNVL70pO.js";import{p as D}from"./DBxQAEQJ.js";import{a as st,s as zt}from"./DzS5ldT-.js";import{e as H,c as Xt,b as qt,u as Yt}from"./BhUNH95W.js";import{t as wt}from"./Cqe-NRGo.js";import{a as It,s as Ht,b as Qt}from"./CckZ7x42.js";import{i as Vt}from"./1mkyv6O_.js";import{M as Ot}from"./B1Io5-Zn.js";import{L as Zt}from"./8hQqhvif.js";import{X as Lt}from"./BFL0NFeS.js";import{s as te}from"./D4SMs5q_.js";import"./CXLK5pxB.js";import{b as ee,c as Bt}from"./DM-96xXi.js";import{f as ae}from"./BjO3HhBo.js";import{D as re}from"./BggWuidE.js";import{G as oe}from"./BiTNgcEp.js";import{P as se}from"./B0L9ton2.js";import{T as ne}from"./k6hQMChD.js";import{D as le}from"./dsq8o_n-.js";import{b as ie}from"./BpTtYi1u.js";import{p as de}from"./Bfc47y5P.js";import{S as ce}from"./DD1zKOTk.js";import"./B3JesTH8.js";import{T as ue}from"./VKbJuFMC.js";import{K as fe}from"./Q7nrsjzz.js";const oa=async(x,l)=>{let t=null;const s=await fetch(`${H}/folders/`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",authorization:`Bearer ${x}`},body:JSON.stringify(l)}).then(async r=>{if(!r.ok)throw await r.json();return r.json()}).catch(r=>(t=r.detail,null));if(t)throw t;return s},sa=async(x="")=>{let l=null;const t=await fetch(`${H}/folders/`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",authorization:`Bearer ${x}`}}).then(async s=>{if(!s.ok)throw await s.json();return s.json()}).then(s=>s).catch(s=>(l=s.detail,null));if(l)throw l;return t},ve=async(x,l)=>{let t=null;const s=await fetch(`${H}/folders/${l}`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",authorization:`Bearer ${x}`}}).then(async r=>{if(!r.ok)throw await r.json();return r.json()}).then(r=>r).catch(r=>(t=r.detail,null));if(t)throw t;return s},na=async(x,l,t)=>{let s=null;const r=await fetch(`${H}/folders/${l}/update`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",authorization:`Bearer ${x}`},body:JSON.stringify(t)}).then(async i=>{if(!i.ok)throw await i.json();return i.json()}).then(i=>i).catch(i=>(s=i.detail,null));if(s)throw s;return r},la=async(x,l,t)=>{let s=null;const r=await fetch(`${H}/folders/${l}/update/expanded`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",authorization:`Bearer ${x}`},body:JSON.stringify({is_expanded:t})}).then(async i=>{if(!i.ok)throw await i.json();return i.json()}).then(i=>i).catch(i=>(s=i.detail,null));if(s)throw s;return r},ia=async(x,l,t)=>{let s=null;const r=await fetch(`${H}/folders/${l}/update/parent`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",authorization:`Bearer ${x}`},body:JSON.stringify({parent_id:t})}).then(async i=>{if(!i.ok)throw await i.json();return i.json()}).then(i=>i).catch(i=>(s=i.detail,null));if(s)throw s;return r},da=async(x,l)=>{let t=null;const s=await fetch(`${H}/folders/${l}`,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json",authorization:`Bearer ${x}`}}).then(async r=>{if(!r.ok)throw await r.json();return r.json()}).then(r=>r).catch(r=>(t=r.detail,null));if(t)throw t;return s};var pe=P('<a target="_blank"> <span class=" underline"> </span>.</a> <button class="underline"> </button> ',1),me=P('<button class="self-center flex items-center gap-1 px-3.5 py-2 text-sm font-medium bg-gray-100 hover:bg-gray-200 text-gray-800 dark:bg-gray-850 dark:text-white dark:hover:bg-gray-800 transition rounded-full" type="button"> </button>'),ge=P('<div class="px-5 pt-4 pb-5 w-full flex flex-col justify-center"><div class=" text-sm dark:text-gray-300 mb-1"><!></div> <div class="flex justify-end"><div class="flex flex-col items-end space-x-1 mt-3"><div class="flex gap-1"><!> <button class="self-center flex items-center gap-1 px-3.5 py-2 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full" type="button" id="copy-and-share-chat-button"><!> <!></button></div></div></div></div>'),he=P('<div><div class=" flex justify-between dark:text-gray-300 px-5 pt-4 pb-0.5"><div class=" text-lg font-medium self-center"> </div> <button class="self-center"><!></button></div> <!></div>');function ca(x,l){Et(l,!1);const t=()=>st(K,"$i18n",i),s=()=>st(qt,"$models",i),r=()=>st(Xt,"$config",i),[i,nt]=zt();let $=D(l,"chatId",8),m=ot(null),J=null;const K=Tt("i18n"),A=async()=>{o(m);const u=await Ht(localStorage.token,$());return J=`${window.location.origin}/s/${u.id}`,S(m,await It(localStorage.token,$())),J},C=async()=>{const u=o(m).chat;wt.success(t().t("Redirecting you to Open WebUI Community"));const G="https://openwebui.com",E=await window.open(`${G}/chats/upload`,"_blank");window.addEventListener("message",T=>{T.origin===G&&T.data==="loaded"&&E.postMessage(JSON.stringify({chat:u,models:s().filter(p=>u.models.includes(p.id))}),"*")},!1)};let y=D(l,"show",12,!1);const k=u=>o(m)?u?o(m).id!==u.id||o(m).share_id!==u.share_id:!1:!0;Pt(()=>(pt(y()),pt($()),o(m)),()=>{y()&&(async()=>{if($()){const u=await It(localStorage.token,$());k(u)&&S(m,u)}else S(m,null),o(m)})()}),Ut(),At(),Ot(x,{size:"md",get show(){return y()},set show(u){y(u)},children:(u,G)=>{var E=he(),T=e(E),p=e(T),X=e(p,!0);a(p);var O=v(p,2),U=e(O);Lt(U,{className:"size-5"}),a(O),a(T);var W=v(T,2);{var z=j=>{var I=ge(),F=e(I),L=e(F);{var gt=g=>{var f=pe(),b=vt(f),tt=e(b),ct=v(tt),kt=e(ct,!0);a(ct),Rt(),a(b);var et=v(b),at=v(et),xt=e(at,!0);a(at);var rt=v(at);B((ut,jt,St,n,d)=>{Dt(b,"href",`/s/${o(m),c(()=>o(m).share_id)??""}`),_(tt,`${ut??""} `),_(kt,jt),_(et,` ${St??""} `),_(xt,n),_(rt,` ${d??""}`)},[()=>(t(),c(()=>t().t("You have shared this chat"))),()=>(t(),c(()=>t().t("before"))),()=>(t(),c(()=>t().t("Click here to"))),()=>(t(),c(()=>t().t("delete this link"))),()=>(t(),c(()=>t().t("and create a new shared link.")))]),R("click",at,async()=>{await Qt(localStorage.token,$())&&S(m,await It(localStorage.token,$()))}),w(g,f)},ht=g=>{var f=mt();B(b=>_(f,b),[()=>(t(),c(()=>t().t("Messages you send after creating your link won't be shared. Users with the URL will be able to view the shared chat.")))]),w(g,f)};Y(L,g=>{o(m),c(()=>o(m).share_id)?g(gt):g(ht,!1)})}a(F);var Q=v(F,2),V=e(Q),Z=e(V),_t=e(Z);{var yt=g=>{var f=me(),b=e(f,!0);a(f),B(tt=>_(b,tt),[()=>(t(),c(()=>t().t("Share to Open WebUI Community")))]),R("click",f,()=>{C(),y(!1)}),w(g,f)};Y(_t,g=>{r(),c(()=>{var f;return(f=r())==null?void 0:f.features.enable_community_sharing})&&g(yt)})}var q=v(_t,2),lt=e(q);Zt(lt,{});var it=v(lt,2);{var dt=g=>{var f=mt();B(b=>_(f,b),[()=>(t(),c(()=>t().t("Update and Copy Link")))]),w(g,f)},$t=g=>{var f=mt();B(b=>_(f,b),[()=>(t(),c(()=>t().t("Copy Link")))]),w(g,f)};Y(it,g=>{o(m),c(()=>o(m).share_id)?g(dt):g($t,!1)})}a(q),a(Z),a(V),a(Q),a(I),R("click",q,async()=>{if(/^((?!chrome|android).)*safari/i.test(navigator.userAgent)){const f=async()=>{const b=await A();return new Blob([b],{type:"text/plain"})};navigator.clipboard.write([new ClipboardItem({"text/plain":f()})]).then(()=>!0).catch(b=>!1)}else Vt(await A());wt.success(t().t("Copied shared chat URL to clipboard!")),y(!1)}),w(j,I)};Y(W,j=>{o(m)&&j(z)})}a(E),B(j=>_(X,j),[()=>(t(),c(()=>t().t("Share Chat")))]),R("click",O,()=>{y(!1)}),w(u,E)},$$slots:{default:!0},$$legacy:!0}),Ft(),nt()}var _e=P("<button><!></button>"),ye=P('<!> <div class="flex items-center"> </div>',1),xe=P('<!> <div class="flex items-center"> </div>',1),be=P('<!> <div class="flex items-center"> </div>',1),we=P("<!> <!> <!>",1),$e=P('<div slot="content"><!></div>');function ua(x,l){Et(l,!1);const t=()=>st(i,"$i18n",s),[s,r]=zt(),i=Tt("i18n"),nt=Jt();let $=D(l,"align",8,"start"),m=D(l,"onEdit",8,()=>{}),J=D(l,"onExport",8,()=>{}),K=D(l,"onDelete",8,()=>{}),A=ot(!1);At(),re(x,{get show(){return o(A)},set show(C){S(A,C)},$$events:{change:C=>{C.detail===!1&&nt("close")}},children:(C,y)=>{{let k=Mt(()=>(t(),c(()=>t().t("More"))));ne(C,{get content(){return o(k)},children:(u,G)=>{var E=_e(),T=e(E);te(T,l,"default",{},null),a(E),R("click",E,p=>{p.stopPropagation(),S(A,!o(A))}),w(u,E)},$$slots:{default:!0}})}},$$slots:{default:!0,content:(C,y)=>{var k=$e(),u=e(k);ee(u,{class:"w-full max-w-[170px] rounded-2xl px-1 py-1 border border-gray-100  dark:border-gray-800   z-50 bg-white dark:bg-gray-850 dark:text-white shadow-lg",sideOffset:-2,side:"bottom",get align(){return $()},get transition(){return ae},children:(G,E)=>{var T=we(),p=vt(T);Bt(p,{class:"flex gap-2 items-center px-3 py-1.5 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl",$$events:{click:()=>{m()()}},children:(U,W)=>{var z=ye(),j=vt(z);se(j,{});var I=v(j,2),F=e(I,!0);a(I),B(L=>_(F,L),[()=>(t(),c(()=>t().t("Edit")))]),w(U,z)},$$slots:{default:!0}});var X=v(p,2);Bt(X,{class:"flex gap-2 items-center px-3 py-1.5 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl",$$events:{click:()=>{J()()}},children:(U,W)=>{var z=xe(),j=vt(z);le(j,{});var I=v(j,2),F=e(I,!0);a(I),B(L=>_(F,L),[()=>(t(),c(()=>t().t("Export")))]),w(U,z)},$$slots:{default:!0}});var O=v(X,2);Bt(O,{class:"flex  gap-2  items-center px-3 py-1.5 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl",$$events:{click:()=>{K()()}},children:(U,W)=>{var z=be(),j=vt(z);oe(j,{});var I=v(j,2),F=e(I,!0);a(I),B(L=>_(F,L),[()=>(t(),c(()=>t().t("Delete")))]),w(U,z)},$$slots:{default:!0}}),w(G,T)},$$slots:{default:!0}}),a(k),w(C,k)}},$$legacy:!0}),Ft(),r()}var ke=P('<div class="my-1"><div class="mb-2 text-xs text-gray-500"> </div> <div><!></div></div>'),je=P('<div slot="label"><div class="flex w-full justify-between"><div class=" mb-2 text-xs text-gray-500"> </div></div></div>'),Se=P('<div class="ml-2 self-center"><!></div>'),Ce=P('<div><div class=" flex justify-between dark:text-gray-300 px-5 pt-4 pb-1"><div class=" text-lg font-medium self-center"><!></div> <button class="self-center"><!></button></div> <div class="flex flex-col md:flex-row w-full px-5 pb-4 md:space-x-4 dark:text-gray-200"><div class=" flex flex-col w-full sm:flex-row sm:justify-center sm:space-x-6"><form class="flex flex-col w-full"><div class="flex flex-col w-full mt-1"><div class=" mb-1 text-xs text-gray-500"> </div> <div class="flex-1"><input id="folder-name" class="w-full text-sm bg-transparent placeholder:text-gray-300 dark:placeholder:text-gray-700 outline-hidden" type="text" autocomplete="off"/></div></div> <input id="folder-background-image-input" type="file" hidden="" accept="image/*"/> <div class="flex justify-between w-full mt-1 items-center"><div class="text-xs text-gray-500"> </div> <div><button aria-labelledby="chat-background-label background-image-url-state" class="p-1 px-3 text-xs flex rounded-sm transition" type="button"><span class="ml-2 self-center" id="background-image-url-state"> </span></button></div></div> <hr class=" border-gray-50 dark:border-gray-850 my-2.5 w-full"/> <!> <div class="my-2"><!></div> <div class="flex justify-end pt-3 text-sm font-medium gap-1.5"><button type="submit"> <!></button></div></form></div></div></div>');function fa(x,l){Et(l,!1);const t=()=>st(nt,"$i18n",r),s=()=>st(Yt,"$user",r),[r,i]=zt(),nt=Tt("i18n");let $=D(l,"show",12,!1),m=D(l,"onSubmit",8,p=>{}),J=D(l,"folderId",8,null),K=D(l,"edit",8,!1),A=null,C=ot(""),y=ot({background_image_url:null}),k=ot({system_prompt:"",files:[]}),u=ot(!1);const G=async()=>{var p;if(S(u,!0),(((p=o(k))==null?void 0:p.files)??[]).some(X=>X.status==="uploading")){wt.error(t().t("Please wait until all files are uploaded.")),S(u,!1);return}await m()({name:o(C),meta:o(y),data:o(k)}),$(!1),S(u,!1)},E=async()=>{J()&&(A=await ve(localStorage.token,J()).catch(p=>(wt.error(`${p}`),null)),S(C,A.name),S(y,A.meta||{background_image_url:null}),S(k,A.data||{system_prompt:"",files:[]})),T()},T=async()=>{await Gt();const p=document.getElementById("folder-name");p&&(p.focus(),p.select())};Pt(()=>pt($()),()=>{$()&&E()}),Pt(()=>(pt($()),pt(K())),()=>{!$()&&!K()&&(S(C,""),S(y,{background_image_url:null}),S(k,{system_prompt:"",files:[]}))}),Ut(),At(),Ot(x,{size:"md",get show(){return $()},set show(p){$(p)},children:(p,X)=>{var O=Ce(),U=e(O),W=e(U),z=e(W);{var j=n=>{var d=mt();B(h=>_(d,h),[()=>(t(),c(()=>t().t("Edit Folder")))]),w(n,d)},I=n=>{var d=mt();B(h=>_(d,h),[()=>(t(),c(()=>t().t("Create Folder")))]),w(n,d)};Y(z,n=>{K()?n(j):n(I,!1)})}a(W);var F=v(W,2),L=e(F);Lt(L,{className:"size-5"}),a(F),a(U);var gt=v(U,2),ht=e(gt),Q=e(ht),V=e(Q),Z=e(V),_t=e(Z,!0);a(Z);var yt=v(Z,2),q=e(yt);Wt(q),a(yt),a(V);var lt=v(V,2),it=v(lt,2),dt=e(it),$t=e(dt,!0);a(dt);var g=v(dt,2),f=e(g),b=e(f),tt=e(b,!0);a(b),a(f),a(g),a(it);var ct=v(it,4);{var kt=n=>{var d=ke(),h=e(d),M=e(h,!0);a(h);var N=v(h,2),Ct=e(N);{let ft=Mt(()=>(t(),c(()=>t().t(`Write your model system prompt content here
e.g.) You are Mario from Super Mario Bros, acting as an assistant.`))));ue(Ct,{className:" text-sm w-full bg-transparent outline-hidden ",get placeholder(){return o(ft)},maxSize:200,get value(){return o(k).system_prompt},set value(Nt){bt(k,o(k).system_prompt=Nt)},$$legacy:!0})}a(N),a(d),B(ft=>_(M,ft),[()=>(t(),c(()=>t().t("System Prompt")))]),w(n,d)};Y(ct,n=>{s(),c(()=>{var d,h,M;return((d=s())==null?void 0:d.role)==="admin"||(((M=(h=s())==null?void 0:h.permissions.chat)==null?void 0:M.system_prompt)??!0)})&&n(kt)})}var et=v(ct,2),at=e(et);fe(at,{get selectedItems(){return o(k).files},set selectedItems(n){bt(k,o(k).files=n)},$$slots:{label:(n,d)=>{var h=je(),M=e(h),N=e(M),Ct=e(N,!0);a(N),a(M),a(h),B(ft=>_(Ct,ft),[()=>(t(),c(()=>t().t("Knowledge")))]),w(n,h)}},$$legacy:!0}),a(et);var xt=v(et,2),rt=e(xt),ut=e(rt),jt=v(ut);{var St=n=>{var d=Se(),h=e(d);ce(h,{}),a(d),w(n,d)};Y(jt,n=>{o(u)&&n(St)})}a(rt),a(xt),a(Q),a(ht),a(gt),a(O),B((n,d,h,M,N)=>{_(_t,n),Dt(q,"placeholder",d),_($t,h),_(tt,M),Kt(rt,1,`px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-950 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full flex flex-row space-x-1 items-center ${o(u)?" cursor-not-allowed":""}`),rt.disabled=o(u),_(ut,`${N??""} `)},[()=>(t(),c(()=>t().t("Folder Name"))),()=>(t(),c(()=>t().t("Enter folder name"))),()=>(t(),c(()=>t().t("Folder Background Image"))),()=>(o(y),t(),c(()=>{var n;return(((n=o(y))==null?void 0:n.background_image_url)??null)===null?t().t("Upload"):t().t("Reset")})),()=>(t(),c(()=>t().t("Save")))]),R("click",F,()=>{$(!1)}),ie(q,()=>o(C),n=>S(C,n)),R("change",lt,n=>{const d=n.target.files;let h=new FileReader;h.onload=M=>{let N=`${M.target.result}`;bt(y,o(y).background_image_url=N)},d&&d.length>0&&["image/gif","image/webp","image/jpeg","image/png"].includes(d[0].type)?h.readAsDataURL(d[0]):(`${d[0].type}`,n.target.value="")}),R("click",f,()=>{var n;if(((n=o(y))==null?void 0:n.background_image_url)!==null)bt(y,o(y).background_image_url=null);else{const d=document.getElementById("folder-background-image-input");d&&d.click()}}),R("submit",Q,de(()=>{G()})),w(p,O)},$$slots:{default:!0},$$legacy:!0}),Ft(),i()}export{fa as F,ca as S,ua as a,ia as b,la as c,da as d,oa as e,sa as f,ve as g,na as u};
//# sourceMappingURL=DOKbeA8A.js.map
