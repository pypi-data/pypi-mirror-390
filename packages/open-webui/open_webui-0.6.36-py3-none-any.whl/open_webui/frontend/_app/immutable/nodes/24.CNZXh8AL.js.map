{"version":3,"file":"24.CNZXh8AL.js","sources":["../../../../../../src/lib/components/notes/Notes.svelte","../../../../../../src/routes/(app)/notes/+page.svelte"],"sourcesContent":["<script lang=\"ts\">\n\timport { marked } from 'marked';\n\n\timport { toast } from 'svelte-sonner';\n\timport fileSaver from 'file-saver';\n\timport Fuse from 'fuse.js';\n\n\tconst { saveAs } = fileSaver;\n\n\timport dayjs from '$lib/dayjs';\n\timport duration from 'dayjs/plugin/duration';\n\timport relativeTime from 'dayjs/plugin/relativeTime';\n\n\tdayjs.extend(duration);\n\tdayjs.extend(relativeTime);\n\n\tasync function loadLocale(locales) {\n\t\tfor (const locale of locales) {\n\t\t\ttry {\n\t\t\t\tdayjs.locale(locale);\n\t\t\t\tbreak; // Stop after successfully loading the first available locale\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error(`Could not load locale '${locale}':`, error);\n\t\t\t}\n\t\t}\n\t}\n\n\t// Assuming $i18n.languages is an array of language codes\n\t$: loadLocale($i18n.languages);\n\n\timport { page } from '$app/stores';\n\timport { goto } from '$app/navigation';\n\timport { onMount, getContext, onDestroy } from 'svelte';\n\timport { WEBUI_NAME, config, prompts as _prompts, user } from '$lib/stores';\n\n\timport { createNewNote, deleteNoteById, getNotes } from '$lib/apis/notes';\n\timport { capitalizeFirstLetter, copyToClipboard, getTimeRange } from '$lib/utils';\n\n\timport { downloadPdf } from './utils';\n\n\timport EllipsisHorizontal from '../icons/EllipsisHorizontal.svelte';\n\timport DeleteConfirmDialog from '$lib/components/common/ConfirmDialog.svelte';\n\timport Search from '../icons/Search.svelte';\n\timport Plus from '../icons/Plus.svelte';\n\timport ChevronRight from '../icons/ChevronRight.svelte';\n\timport Spinner from '../common/Spinner.svelte';\n\timport Tooltip from '../common/Tooltip.svelte';\n\timport NoteMenu from './Notes/NoteMenu.svelte';\n\timport FilesOverlay from '../chat/MessageInput/FilesOverlay.svelte';\n\timport XMark from '../icons/XMark.svelte';\n\n\tconst i18n = getContext('i18n');\n\tlet loaded = false;\n\n\tlet importFiles = '';\n\tlet query = '';\n\n\tlet noteItems = [];\n\tlet fuse = null;\n\n\tlet selectedNote = null;\n\tlet notes = {};\n\t$: if (fuse) {\n\t\tnotes = groupNotes(\n\t\t\tquery\n\t\t\t\t? fuse.search(query).map((e) => {\n\t\t\t\t\t\treturn e.item;\n\t\t\t\t\t})\n\t\t\t\t: noteItems\n\t\t);\n\t}\n\n\tlet showDeleteConfirm = false;\n\n\tconst groupNotes = (res) => {\n\t\tconsole.log(res);\n\t\tif (!Array.isArray(res)) {\n\t\t\treturn {}; // or throw new Error(\"Notes response is not an array\")\n\t\t}\n\n\t\t// Build the grouped object\n\t\tconst grouped: Record<string, any[]> = {};\n\t\tfor (const note of res) {\n\t\t\tconst timeRange = getTimeRange(note.updated_at / 1000000000);\n\t\t\tif (!grouped[timeRange]) {\n\t\t\t\tgrouped[timeRange] = [];\n\t\t\t}\n\t\t\tgrouped[timeRange].push({\n\t\t\t\t...note,\n\t\t\t\ttimeRange\n\t\t\t});\n\t\t}\n\t\treturn grouped;\n\t};\n\n\tconst init = async () => {\n\t\tnoteItems = await getNotes(localStorage.token, true);\n\n\t\tfuse = new Fuse(noteItems, {\n\t\t\tkeys: ['title']\n\t\t});\n\t};\n\n\tconst createNoteHandler = async (content?: string) => {\n\t\t//  $i18n.t('New Note'),\n\t\tconst res = await createNewNote(localStorage.token, {\n\t\t\t// YYYY-MM-DD\n\t\t\ttitle: dayjs().format('YYYY-MM-DD'),\n\t\t\tdata: {\n\t\t\t\tcontent: {\n\t\t\t\t\tjson: null,\n\t\t\t\t\thtml: content ?? '',\n\t\t\t\t\tmd: content ?? ''\n\t\t\t\t}\n\t\t\t},\n\t\t\tmeta: null,\n\t\t\taccess_control: {}\n\t\t}).catch((error) => {\n\t\t\ttoast.error(`${error}`);\n\t\t\treturn null;\n\t\t});\n\n\t\tif (res) {\n\t\t\tgoto(`/notes/${res.id}`);\n\t\t}\n\t};\n\n\tconst downloadHandler = async (type) => {\n\t\tif (type === 'txt') {\n\t\t\tconst blob = new Blob([selectedNote.data.content.md], { type: 'text/plain' });\n\t\t\tsaveAs(blob, `${selectedNote.title}.txt`);\n\t\t} else if (type === 'md') {\n\t\t\tconst blob = new Blob([selectedNote.data.content.md], { type: 'text/markdown' });\n\t\t\tsaveAs(blob, `${selectedNote.title}.md`);\n\t\t} else if (type === 'pdf') {\n\t\t\ttry {\n\t\t\t\tawait downloadPdf(selectedNote);\n\t\t\t} catch (error) {\n\t\t\t\ttoast.error(`${error}`);\n\t\t\t}\n\t\t}\n\t};\n\n\tconst deleteNoteHandler = async (id) => {\n\t\tconst res = await deleteNoteById(localStorage.token, id).catch((error) => {\n\t\t\ttoast.error(`${error}`);\n\t\t\treturn null;\n\t\t});\n\n\t\tif (res) {\n\t\t\tinit();\n\t\t}\n\t};\n\n\tconst inputFilesHandler = async (inputFiles) => {\n\t\t// Check if all the file is a markdown file and extract name and content\n\n\t\tfor (const file of inputFiles) {\n\t\t\tif (file.type !== 'text/markdown') {\n\t\t\t\ttoast.error($i18n.t('Only markdown files are allowed'));\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst reader = new FileReader();\n\t\t\treader.onload = async (event) => {\n\t\t\t\tconst content = event.target.result;\n\t\t\t\tlet name = file.name.replace(/\\.md$/, '');\n\n\t\t\t\tif (typeof content !== 'string') {\n\t\t\t\t\ttoast.error($i18n.t('Invalid file content'));\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// Create a new note with the content\n\t\t\t\tconst res = await createNewNote(localStorage.token, {\n\t\t\t\t\ttitle: name,\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tcontent: {\n\t\t\t\t\t\t\tjson: null,\n\t\t\t\t\t\t\thtml: marked.parse(content ?? ''),\n\t\t\t\t\t\t\tmd: content\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tmeta: null,\n\t\t\t\t\taccess_control: {}\n\t\t\t\t}).catch((error) => {\n\t\t\t\t\ttoast.error(`${error}`);\n\t\t\t\t\treturn null;\n\t\t\t\t});\n\n\t\t\t\tif (res) {\n\t\t\t\t\tinit();\n\t\t\t\t}\n\t\t\t};\n\n\t\t\treader.readAsText(file);\n\t\t}\n\t};\n\n\tlet dragged = false;\n\n\tconst onDragOver = (e) => {\n\t\te.preventDefault();\n\n\t\t// Check if a file is being dragged.\n\t\tif (e.dataTransfer?.types?.includes('Files')) {\n\t\t\tdragged = true;\n\t\t} else {\n\t\t\tdragged = false;\n\t\t}\n\t};\n\n\tconst onDragLeave = () => {\n\t\tdragged = false;\n\t};\n\n\tconst onDrop = async (e) => {\n\t\te.preventDefault();\n\t\tconsole.log(e);\n\n\t\tif (e.dataTransfer?.files) {\n\t\t\tconst inputFiles = Array.from(e.dataTransfer?.files);\n\t\t\tif (inputFiles && inputFiles.length > 0) {\n\t\t\t\tconsole.log(inputFiles);\n\t\t\t\tinputFilesHandler(inputFiles);\n\t\t\t}\n\t\t}\n\n\t\tdragged = false;\n\t};\n\n\tonDestroy(() => {\n\t\tconsole.log('destroy');\n\t\tconst dropzoneElement = document.getElementById('notes-container');\n\n\t\tif (dropzoneElement) {\n\t\t\tdropzoneElement?.removeEventListener('dragover', onDragOver);\n\t\t\tdropzoneElement?.removeEventListener('drop', onDrop);\n\t\t\tdropzoneElement?.removeEventListener('dragleave', onDragLeave);\n\t\t}\n\t});\n\n\tonMount(async () => {\n\t\tif ($page.url.searchParams.get('content') !== null) {\n\t\t\tconst content = $page.url.searchParams.get('content') ?? '';\n\t\t\tcreateNoteHandler(content);\n\t\t\treturn;\n\t\t}\n\n\t\tawait init();\n\t\tloaded = true;\n\n\t\tconst dropzoneElement = document.getElementById('notes-container');\n\n\t\tdropzoneElement?.addEventListener('dragover', onDragOver);\n\t\tdropzoneElement?.addEventListener('drop', onDrop);\n\t\tdropzoneElement?.addEventListener('dragleave', onDragLeave);\n\t});\n</script>\n\n<svelte:head>\n\t<title>\n\t\t{$i18n.t('Notes')} â€¢ {$WEBUI_NAME}\n\t</title>\n</svelte:head>\n\n<FilesOverlay show={dragged} />\n\n<div id=\"notes-container\" class=\"w-full min-h-full h-full\">\n\t{#if loaded}\n\t\t<DeleteConfirmDialog\n\t\t\tbind:show={showDeleteConfirm}\n\t\t\ttitle={$i18n.t('Delete note?')}\n\t\t\ton:confirm={() => {\n\t\t\t\tdeleteNoteHandler(selectedNote.id);\n\t\t\t\tshowDeleteConfirm = false;\n\t\t\t}}\n\t\t>\n\t\t\t<div class=\" text-sm text-gray-500 truncate\">\n\t\t\t\t{$i18n.t('This will delete')} <span class=\"  font-semibold\">{selectedNote.title}</span>.\n\t\t\t</div>\n\t\t</DeleteConfirmDialog>\n\n\t\t<div class=\"flex flex-col gap-1 px-3.5\">\n\t\t\t<div class=\" flex flex-1 items-center w-full space-x-2\">\n\t\t\t\t<div class=\"flex flex-1 items-center\">\n\t\t\t\t\t<div class=\" self-center ml-1 mr-3\">\n\t\t\t\t\t\t<Search className=\"size-3.5\" />\n\t\t\t\t\t</div>\n\t\t\t\t\t<input\n\t\t\t\t\t\tclass=\" w-full text-sm py-1 rounded-r-xl outline-hidden bg-transparent\"\n\t\t\t\t\t\tbind:value={query}\n\t\t\t\t\t\tplaceholder={$i18n.t('Search Notes')}\n\t\t\t\t\t/>\n\n\t\t\t\t\t{#if query}\n\t\t\t\t\t\t<div class=\"self-center pl-1.5 translate-y-[0.5px] rounded-l-xl bg-transparent\">\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclass=\"p-0.5 rounded-full hover:bg-gray-100 dark:hover:bg-gray-900 transition\"\n\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\tquery = '';\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<XMark className=\"size-3\" strokeWidth=\"2\" />\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class=\"px-4.5 @container h-full pt-2\">\n\t\t\t{#if Object.keys(notes).length > 0}\n\t\t\t\t<div class=\"pb-10\">\n\t\t\t\t\t{#each Object.keys(notes) as timeRange}\n\t\t\t\t\t\t<div class=\"w-full text-xs text-gray-500 dark:text-gray-500 font-medium pb-2.5\">\n\t\t\t\t\t\t\t{$i18n.t(timeRange)}\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclass=\"mb-5 gap-2.5 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{#each notes[timeRange] as note, idx (note.id)}\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tclass=\" flex space-x-4 cursor-pointer w-full px-4.5 py-4 border border-gray-50 dark:border-gray-850 bg-transparent dark:hover:bg-gray-850 hover:bg-white rounded-2xl transition\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<div class=\" flex flex-1 space-x-4 cursor-pointer w-full\">\n\t\t\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\t\t\thref={`/notes/${note.id}`}\n\t\t\t\t\t\t\t\t\t\t\tclass=\"w-full -translate-y-0.5 flex flex-col justify-between\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"flex-1\">\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"  flex items-center gap-2 self-center mb-1 justify-between\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\" font-semibold line-clamp-1 capitalize\">{note.title}</div>\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<NoteMenu\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonDownload={(type) => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselectedNote = note;\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdownloadHandler(type);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonCopyLink={async () => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst baseUrl = window.location.origin;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst res = await copyToClipboard(`${baseUrl}/notes/${note.id}`);\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (res) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttoast.success($i18n.t('Copied link to clipboard'));\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttoast.error($i18n.t('Failed to copy link'));\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonDelete={() => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselectedNote = note;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tshowDeleteConfirm = true;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"self-center w-fit text-sm p-1 dark:text-gray-300 dark:hover:text-white hover:bg-black/5 dark:hover:bg-white/5 rounded-xl\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<EllipsisHorizontal className=\"size-5\" />\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</NoteMenu>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\" text-xs text-gray-500 dark:text-gray-500 mb-3 line-clamp-3 min-h-10\"\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{#if note.data?.content?.md}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{note.data?.content?.md}\n\t\t\t\t\t\t\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{$i18n.t('No content')}\n\t\t\t\t\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t\t\t<div class=\" text-xs px-0.5 w-full flex justify-between items-center\">\n\t\t\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{dayjs(note.updated_at / 1000000).fromNow()}\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<Tooltip\n\t\t\t\t\t\t\t\t\t\t\t\t\tcontent={note?.user?.email ?? $i18n.t('Deleted User')}\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"flex shrink-0\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tplacement=\"top-start\"\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"shrink-0 text-gray-500\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{$i18n.t('By {{name}}', {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname: capitalizeFirstLetter(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tnote?.user?.name ?? note?.user?.email ?? $i18n.t('Deleted User')\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/each}\n\t\t\t\t</div>\n\t\t\t{:else}\n\t\t\t\t<div class=\"w-full h-full flex flex-col items-center justify-center\">\n\t\t\t\t\t<div class=\"pb-20 text-center\">\n\t\t\t\t\t\t<div class=\" text-xl font-medium text-gray-400 dark:text-gray-600\">\n\t\t\t\t\t\t\t{$i18n.t('No Notes')}\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class=\"mt-1 text-sm text-gray-300 dark:text-gray-700\">\n\t\t\t\t\t\t\t{$i18n.t('Create your first note by clicking on the plus button below.')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t{/if}\n\t\t</div>\n\n\t\t<div class=\"absolute bottom-0 left-0 right-0 p-5 max-w-full flex justify-end\">\n\t\t\t<div class=\"flex gap-0.5 justify-end w-full\">\n\t\t\t\t<Tooltip content={$i18n.t('Create Note')}>\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\"cursor-pointer p-2.5 flex rounded-full border border-gray-50 bg-white dark:border-none dark:bg-gray-850 hover:bg-gray-50 dark:hover:bg-gray-800 transition shadow-xl\"\n\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\ton:click={async () => {\n\t\t\t\t\t\t\tcreateNoteHandler();\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<Plus className=\"size-4.5\" strokeWidth=\"2.5\" />\n\t\t\t\t\t</button>\n\t\t\t\t</Tooltip>\n\n\t\t\t\t<!-- <button\n\t\t\t\tclass=\"cursor-pointer p-2.5 flex rounded-full hover:bg-gray-100 dark:hover:bg-gray-850 transition shadow-xl\"\n\t\t\t>\n\t\t\t\t<SparklesSolid className=\"size-4\" />\n\t\t\t</button> -->\n\t\t\t</div>\n\t\t</div>\n\n\t\t<!-- {#if $user?.role === 'admin'}\n\t\t<div class=\" flex justify-end w-full mb-3\">\n\t\t\t<div class=\"flex space-x-2\">\n\t\t\t\t<input\n\t\t\t\t\tid=\"notes-import-input\"\n\t\t\t\t\tbind:files={importFiles}\n\t\t\t\t\ttype=\"file\"\n\t\t\t\t\taccept=\".md\"\n\t\t\t\t\thidden\n\t\t\t\t\ton:change={() => {\n\t\t\t\t\t\tconsole.log(importFiles);\n\n\t\t\t\t\t\tconst reader = new FileReader();\n\t\t\t\t\t\treader.onload = async (event) => {\n\t\t\t\t\t\t\tconsole.log(event.target.result);\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\treader.readAsText(importFiles[0]);\n\t\t\t\t\t}}\n\t\t\t\t/>\n\n\t\t\t\t<button\n\t\t\t\t\tclass=\"flex text-xs items-center space-x-1 px-3 py-1.5 rounded-xl bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 dark:text-gray-200 transition\"\n\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\tconst notesImportInputElement = document.getElementById('notes-import-input');\n\t\t\t\t\t\tif (notesImportInputElement) {\n\t\t\t\t\t\t\tnotesImportInputElement.click();\n\t\t\t\t\t\t}\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<div class=\" self-center mr-2 font-medium line-clamp-1\">{$i18n.t('Import Notes')}</div>\n\n\t\t\t\t\t<div class=\" self-center\">\n\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\tviewBox=\"0 0 16 16\"\n\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\tclass=\"w-4 h-4\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\t\t\t\t\td=\"M4 2a1.5 1.5 0 0 0-1.5 1.5v9A1.5 1.5 0 0 0 4 14h8a1.5 1.5 0 0 0 1.5-1.5V6.621a1.5 1.5 0 0 0-.44-1.06L9.94 2.439A1.5 1.5 0 0 0 8.878 2H4Zm4 9.5a.75.75 0 0 1-.75-.75V8.06l-.72.72a.75.75 0 0 1-1.06-1.06l2-2a.75.75 0 0 1 1.06 0l2 2a.75.75 0 1 1-1.06 1.06l-.72-.72v2.69a.75.75 0 0 1-.75.75Z\"\n\t\t\t\t\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</div>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</div>\n\t{/if} -->\n\t{:else}\n\t\t<div class=\"w-full h-full flex justify-center items-center\">\n\t\t\t<Spinner className=\"size-5\" />\n\t\t</div>\n\t{/if}\n</div>\n","<script>\n\timport { mobile, showArchivedChats, showSidebar, user } from '$lib/stores';\n\timport { getContext } from 'svelte';\n\n\tconst i18n = getContext('i18n');\n\n\timport UserMenu from '$lib/components/layout/Sidebar/UserMenu.svelte';\n\timport Notes from '$lib/components/notes/Notes.svelte';\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\n\timport Sidebar from '$lib/components/icons/Sidebar.svelte';\n</script>\n\n<div\n\tclass=\" flex flex-col w-full h-screen max-h-[100dvh] transition-width duration-200 ease-in-out {$showSidebar\n\t\t? 'md:max-w-[calc(100%-260px)]'\n\t\t: ''} max-w-full\"\n>\n\t<nav class=\"   px-2 pt-1.5 backdrop-blur-xl w-full drag-region\">\n\t\t<div class=\" flex items-center\">\n\t\t\t{#if $mobile}\n\t\t\t\t<div class=\"{$showSidebar ? 'md:hidden' : ''} flex flex-none items-center\">\n\t\t\t\t\t<Tooltip\n\t\t\t\t\t\tcontent={$showSidebar ? $i18n.t('Close Sidebar') : $i18n.t('Open Sidebar')}\n\t\t\t\t\t\tinteractive={true}\n\t\t\t\t\t>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tid=\"sidebar-toggle-button\"\n\t\t\t\t\t\t\tclass=\" cursor-pointer flex rounded-lg hover:bg-gray-100 dark:hover:bg-gray-850 transition cursor-\"\n\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\tshowSidebar.set(!$showSidebar);\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div class=\" self-center p-1.5\">\n\t\t\t\t\t\t\t\t<Sidebar />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</Tooltip>\n\t\t\t\t</div>\n\t\t\t{/if}\n\n\t\t\t<div class=\"ml-2 py-0.5 self-center flex items-center justify-between w-full\">\n\t\t\t\t<div class=\"\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"flex gap-1 scrollbar-none overflow-x-auto w-fit text-center text-sm font-medium bg-transparent py-1 touch-auto pointer-events-auto\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<a class=\"min-w-fit transition\" href=\"/notes\">\n\t\t\t\t\t\t\t{$i18n.t('Notes')}\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\" self-center flex items-center gap-1\">\n\t\t\t\t\t{#if $user !== undefined && $user !== null}\n\t\t\t\t\t\t<UserMenu\n\t\t\t\t\t\t\tclassName=\"max-w-[240px]\"\n\t\t\t\t\t\t\trole={$user?.role}\n\t\t\t\t\t\t\thelp={true}\n\t\t\t\t\t\t\ton:show={(e) => {\n\t\t\t\t\t\t\t\tif (e.detail === 'archived-chat') {\n\t\t\t\t\t\t\t\t\tshowArchivedChats.set(true);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclass=\"select-none flex rounded-xl p-1.5 w-full hover:bg-gray-50 dark:hover:bg-gray-850 transition\"\n\t\t\t\t\t\t\t\taria-label=\"User Menu\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div class=\" self-center\">\n\t\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\t\tsrc={$user?.profile_image_url}\n\t\t\t\t\t\t\t\t\t\tclass=\"size-6 object-cover rounded-full\"\n\t\t\t\t\t\t\t\t\t\talt=\"User profile\"\n\t\t\t\t\t\t\t\t\t\tdraggable=\"false\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</UserMenu>\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</nav>\n\n\t<div class=\" pb-1 flex-1 max-h-full overflow-y-auto @container\">\n\t\t<Notes />\n\t</div>\n</div>\n"],"names":["saveAs","fileSaver","dayjs","duration","relativeTime","loadLocale","locales","locale","error","i18n","getContext","loaded","query","noteItems","$.mutable_source","fuse","selectedNote","notes","showDeleteConfirm","groupNotes","res","grouped","note","timeRange","getTimeRange","init","$.set","getNotes","Fuse","$.get","createNoteHandler","content","createNewNote","toast","goto","downloadHandler","type","blob","downloadPdf","deleteNoteHandler","id","deleteNoteById","inputFilesHandler","inputFiles","file","$i18n","reader","event","name","marked","dragged","onDragOver","_b","_a","onDragLeave","onDrop","onDestroy","dropzoneElement","onMount","$page","$WEBUI_NAME","$$value","$.untrack","$.event","button","$$render","consequent","$.each","div_8","baseUrl","copyToClipboard","$.template_effect","$.set_text","text_4","consequent_1","alternate","capitalizeFirstLetter","button_2","$.bind_value","input","consequent_3","alternate_2","$showSidebar","showSidebar","$mobile","$0","$.derived_safe_equal","$user","e","showArchivedChats","$.set_attribute","img"],"mappings":"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"}