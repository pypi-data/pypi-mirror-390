import{l as S,aj as w,s as O,r as s,a4 as _,u as q,a5 as H,e as G,j as d,Q as K,T as $,P as M,W as N}from"./index.Cfp6iZXn.js";import{u as Q}from"./uniqueId.BB0nVlzh.js";import{I as J}from"./InputInstructions.C740tCk8.js";import{u as X}from"./useBasicWidgetState.CrDxPbWh.js";import{u as Y,a as Z,b as tt}from"./useUpdateUiValue.xqgyqi-H.js";import{u as et,T as it}from"./useTextInputAutoExpand.C1IUONpj.js";import"./FormClearHelper.6wAwbIPO.js";import"./inputUtils.CptNuJwn.js";import"./base-input.DKexhoai.js";const at=(e,t)=>{let a="auto";if(e.heightConfig?.useStretch)a="100%";else if(e.heightConfig?.pixelHeight&&e.heightConfig.pixelHeight>0){const o=S(t.labelVisibility?.value)===w.Collapsed?2:30,l=e.heightConfig.pixelHeight-o;a=`${Math.max(0,l)}px`}return a},st=O("div",{target:"e1r0q00f0"})({height:"100%",display:"flex",flexDirection:"column"}),T=(e,t)=>e.getStringValue(t)??t.default??null,ot=e=>e.default??null,rt=e=>e.value??null,lt=(e,t,a,o)=>{t.setStringValue(e,a.value,{fromUi:a.fromUi},o)},nt=({disabled:e,element:t,widgetMgr:a,fragmentId:o,outerElement:l})=>{const c=s.useRef(Q("text_area_")).current,{width:W,elementRef:y}=_(),[r,h]=s.useState(!1),[I,b]=s.useState(!1),n=l.heightConfig?.useContent??!1,V=l.heightConfig?.useStretch??!1,v=at(l,t),x=s.useRef(null),[u,g]=s.useState(()=>T(a,t)??null),A=s.useCallback(()=>{g(t.default??null),h(!0)},[t]),[F,p]=X({getStateFromWidgetMgr:T,getDefaultStateFromProto:ot,getCurrStateFromProto:rt,updateWidgetMgrState:lt,element:t,widgetMgr:a,fragmentId:o,onFormCleared:A});Y(F,u,g,r);const i=q(),{height:R,maxHeight:P,updateScrollHeight:C}=et({textareaRef:x,dependencies:[t.placeholder]}),f=s.useCallback(()=>{h(!1),p({value:u,fromUi:!0})},[u,p]),k=s.useCallback(()=>{r&&f(),b(!1)},[r,f]),z=s.useCallback(()=>{b(!0)},[]),D=s.useCallback(()=>{n&&C()},[n,C]),E=Z({formId:t.formId,maxChars:t.maxChars,setDirty:h,setUiValue:g,setValueWithSource:p,additionalAction:D}),L=tt(t.formId,f,r,a,o,!0),{placeholder:U,formId:m}=t,j=H({formId:m})?a.allowFormEnterToSubmit(m):r,B=I&&W>i.breakpoints.hideWidgetDetails;return G(st,{className:"stTextArea","data-testid":"stTextArea",ref:y,children:[d(N,{label:t.label,disabled:e,labelVisibility:S(t.labelVisibility?.value),htmlFor:c,children:t.help&&d(K,{children:d($,{content:t.help,placement:M.TOP_RIGHT})})}),d(it,{inputRef:n?x:void 0,value:u??"",placeholder:U,onBlur:k,onFocus:z,onChange:E,onKeyDown:L,"aria-label":t.label,disabled:e,id:c,overrides:{Input:{style:{fontWeight:i.fontWeights.normal,lineHeight:i.lineHeights.inputWidget,height:n?R:v,maxHeight:n?P:"",minHeight:i.sizes.largestElementHeight,resize:V?"none":"vertical",paddingRight:i.spacing.md,paddingLeft:i.spacing.md,paddingBottom:i.spacing.md,paddingTop:i.spacing.md,"::placeholder":{color:i.colors.fadedText60}}},Root:{props:{"data-testid":"stTextAreaRootElement"},style:{borderLeftWidth:i.sizes.borderWidth,borderRightWidth:i.sizes.borderWidth,borderTopWidth:i.sizes.borderWidth,borderBottomWidth:i.sizes.borderWidth,flexGrow:1}}}}),B&&d(J,{dirty:r,value:u??"",maxLength:t.maxChars,type:"multiline",inForm:H({formId:m}),allowEnterToSubmit:j})]})},xt=s.memo(nt);export{xt as default};
