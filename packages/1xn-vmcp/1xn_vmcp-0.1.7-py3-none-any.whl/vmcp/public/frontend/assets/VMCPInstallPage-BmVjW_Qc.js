import{j as e}from"./ui-DTFgKa_e.js";import{f as E,r as i}from"./vendor-Dje7enk0.js";import{u as T,d as F,b as L,a as g,l as R,S as A,B as j,D as W,C as $}from"./index-tD243MzK.js";import{C as N,d as b,b as y,c as z,a as C}from"./card-Yrf7NGmU.js";import{V as B,I as G}from"./VMCPDetailsDisplay-DE89cmKt.js";import{Z as U}from"./zap-BrOjbvFk.js";import{L as Z}from"./link-Da243Ry6.js";import{M as q}from"./message-square-CW0HFtVv.js";import{D as H}from"./download-CW-Uw6j3.js";import{G as K}from"./git-fork-x6GTqEUF.js";import"./badge-D5TJqaKK.js";import"./favicon-icon-CjFK3LTq.js";import"./chevron-down-CLOcCYE1.js";import"./circle-check-big-YfK9xyEK.js";import"./type-C59iAb9S.js";import"./file-text-BBrGjPNc.js";import"./wifi-LHEink8J.js";function xe(){const a=E(),l=T(),{success:P,error:n}=F(),{user:w,loading:d,isAuthenticated:x}=L(),[o,M]=i.useState(""),[m,_]=i.useState("public"),[t,I]=i.useState(null),[S,u]=i.useState(!0),[p,h]=i.useState(!1),V=s=>s.startsWith("http://")||s.startsWith("https://"),f=s=>s.metadata?.icon?V(s.metadata.icon)?s.metadata.icon:`data:image/png;base64,${s.metadata.icon}`:null;i.useEffect(()=>{if(!d&&!x){l.push("/login");return}},[d,x,l]),i.useEffect(()=>{a.vmcp_id&&a.vmcp_type&&(M(a.vmcp_id),_(a.vmcp_type),k(a.vmcp_id,a.vmcp_type))},[a.vmcp_id,a.vmcp_type]);const k=async(s,v)=>{try{u(!0);const r=localStorage.getItem("access_token");if(!r){n("Please log in to install vMCPs"),l.push("/login");return}let c;c=await g.getPublicVMCPDetails(s,r),c.success&&c.data?I(c.data):(n(`Failed to load ${v} vMCP details`),l.push("/vmcp"))}catch{n("Failed to load vMCP details"),l.push("/vmcp")}finally{u(!1)}},D=async()=>{try{$.capture("vmcp_install_initiated",{vmcp_id:o,vmcp_type:m,vmcp_name:t?.name}),h(!0),console.log("üîß vmcpData:",t);const s=localStorage.getItem("access_token");if(!s){n("Please log in to install vMCPs"),l.push("/login");return}console.log("üîß setting up installVMCP:",s);const v={...t,user_id:w?.id||""};console.log("üîß Calling installVMCP with vmcpId:",o);const r=await g.installVMCP(o,s);if(console.log("üîß installVMCP result:",r),!r.success)throw new Error(r.error||"Failed to install vMCP");P("vMCP installed successfully!"),l.push("/vmcp")}catch(s){console.error("‚ùå Error installing vMCP:",s),n(s instanceof Error?s.message:"Unknown error")}finally{h(!1)}};return S?e.jsx("div",{className:"min-h-screen text-foreground flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-2 border-primary border-t-transparent mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading vMCP details..."})]})}):t?e.jsx("div",{className:"min-h-screen",children:e.jsxs("div",{className:"max-w-6xl mx-auto p-6",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"h-10 w-10 rounded-lg bg-gradient-to-br from-primary/20 to-primary/10 flex items-center justify-center relative overflow-hidden",children:f(t)?e.jsx("img",{src:f(t),alt:`${t.name} icon`,className:"h-7 w-7 object-contain"}):e.jsx(R,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h1",{className:"text-2xl font-bold mb-1",children:["Install ",m==="wellknown"?"Well-Known":"Public"," vMCP"]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Review and install ",t.name," to your account"]})]})]})}),e.jsxs(N,{className:"mb-6",children:[e.jsx(b,{className:"pb-4",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(y,{className:"text-xl",children:t.name}),e.jsx(z,{className:"text-sm mt-1",children:t.description||"No description available"})]})})}),e.jsx(C,{className:"pt-0",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center p-4 rounded-lg bg-muted/30",children:[e.jsx(A,{className:"h-6 w-6 mx-auto mb-2 text-primary"}),e.jsx("div",{className:"text-xl font-bold",children:t.vmcp_config?.selected_servers?.length||0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"MCP Servers"})]}),e.jsxs("div",{className:"text-center p-4 rounded-lg bg-muted/30",children:[e.jsx(U,{className:"h-6 w-6 mx-auto mb-2 text-primary"}),e.jsx("div",{className:"text-xl font-bold",children:t.total_tools||0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Tools"})]}),e.jsxs("div",{className:"text-center p-4 rounded-lg bg-muted/30",children:[e.jsx(Z,{className:"h-6 w-6 mx-auto mb-2 text-primary"}),e.jsx("div",{className:"text-xl font-bold",children:t.total_resources||0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Resources"})]}),e.jsxs("div",{className:"text-center p-4 rounded-lg bg-muted/30",children:[e.jsx(q,{className:"h-6 w-6 mx-auto mb-2 text-primary"}),e.jsx("div",{className:"text-xl font-bold",children:t.total_prompts||0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Prompts"})]})]})})]}),e.jsx(B,{vmcpData:t,vmcpType:m,isRemoteVMCP:!1,showExpandableLists:!0}),e.jsxs(N,{className:"mt-8",children:[e.jsx(b,{children:e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(G,{className:"h-5 w-5 text-blue-500"}),"Installation Information"]})}),e.jsx(C,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["This vMCP will be installed as a ",e.jsx("strong",{children:"read-only copy"}),". After installation, you will only be able to edit:"]}),e.jsxs("ul",{className:"text-sm text-muted-foreground space-y-1 ml-4",children:[e.jsx("li",{children:"‚Ä¢ Server authentication settings in the MCP Servers tab"}),e.jsx("li",{children:"‚Ä¢ Environment variable values"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"To make a fully editable copy, you can fork this vMCP after installation."})]})})]}),e.jsxs("div",{className:"flex justify-center gap-4 mt-8",children:[e.jsx(j,{onClick:D,disabled:p,size:"lg",className:"px-8 py-3",children:p?e.jsxs(e.Fragment,{children:[e.jsx(W,{className:"h-4 w-4 mr-2 animate-spin"}),"Installing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(H,{className:"h-4 w-4 mr-2"}),"Install vMCP"]})}),e.jsxs(j,{variant:"outline",size:"lg",className:"px-8 py-3",disabled:!0,title:"Fork functionality coming soon",children:[e.jsx(K,{className:"h-4 w-4 mr-2"}),"Fork vMCP"]})]})]})}):e.jsx("div",{className:"min-h-screen text-foreground flex items-center justify-center",children:e.jsx("div",{className:"text-center",children:e.jsx("p",{className:"text-destructive",children:"vMCP not found"})})})}export{xe as default};
//# sourceMappingURL=VMCPInstallPage-BmVjW_Qc.js.map
