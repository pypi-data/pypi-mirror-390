Metadata-Version: 2.3
Name: autowin
Version: 0.0.2
Summary: ä¸€ä¸ªåŸºäº pywinauto å’Œ pyautogui çš„è‡ªç”¨ Windows è‡ªåŠ¨åŒ–åº“ã€‚
Author: Xiaoqiang
Author-email: xiaoqiangclub@hotmail.com
Requires-Python: >=3.10
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Classifier: Programming Language :: Python :: 3.13
Requires-Dist: Pillow (>=12.0.0)
Requires-Dist: httpx (>=0.28.1)
Requires-Dist: parsel (>=1.10.0)
Requires-Dist: pyautogui (>=0.9.54)
Requires-Dist: pynput (>=1.8.1)
Requires-Dist: pyperclip (>=1.11.0)
Requires-Dist: pywinauto (>=0.6.9)
Description-Content-Type: text/markdown

# âœ¨ AutoWin: åŸºäº pywinauto å’Œ pyautogui çš„ Windows è‡ªåŠ¨åŒ–åº“

[![Python Version](https://img.shields.io/badge/Python-3.8%2B-blue.svg)](https://www.python.org/)
[![License](https://img.shields.io/badge/License-MIT-green.svg)](https://opensource.org/licenses/MIT)
[![Poetry](https://img.shields.io/badge/Poetry-Enabled-brightgreen)](https://python-poetry.org/)

## ğŸ“ é¡¹ç›®ç®€ä»‹

AutoWin æ˜¯ä¸€ä¸ªå¼ºå¤§ä¸”æ˜“ç”¨çš„ Windows è‡ªåŠ¨åŒ–åº“ï¼Œå®ƒå°è£…äº† [`pywinauto`](https://pywinauto.readthedocs.io/en/latest/) å’Œ [`pyautogui`](https://pyautogui.readthedocs.io/en/latest/) çš„æ ¸å¿ƒåŠŸèƒ½ï¼Œå¹¶æä¾›äº†ä¸€å¥—ç»Ÿä¸€ã€é«˜å±‚çš„ APIã€‚é€šè¿‡ AutoWinï¼Œå¼€å‘è€…å¯ä»¥è½»æ¾å®ç° Windows æ¡Œé¢åº”ç”¨ç¨‹åºçš„è‡ªåŠ¨åŒ–æ“ä½œï¼ŒåŒ…æ‹¬çª—å£ç®¡ç†ã€UI æ§ä»¶äº¤äº’ã€é¼ æ ‡é”®ç›˜æ¨¡æ‹Ÿã€å±å¹•æˆªå›¾ä¸å›¾åƒè¯†åˆ«ä»¥åŠå‰ªè´´æ¿æ“ä½œã€‚

AutoWin çš„è®¾è®¡ç†å¿µæ˜¯æä¾›ä¸€ä¸ªå¥å£®ã€å¯é ä¸”ç”¨æˆ·å‹å¥½çš„è‡ªåŠ¨åŒ–è§£å†³æ–¹æ¡ˆï¼Œå†…ç½®äº†æ—¥å¿—è®°å½•ã€é‡è¯•æœºåˆ¶å’Œå®Œå–„çš„é”™è¯¯å¤„ç†ï¼Œä»¥åº”å¯¹è‡ªåŠ¨åŒ–è¿‡ç¨‹ä¸­å¯èƒ½é‡åˆ°çš„å„ç§å¤æ‚æƒ…å†µã€‚

## ğŸš€ ä¸»è¦ç‰¹æ€§

*   **æ‰å¹³åŒ– API**: å°†æ ¸å¿ƒåŠŸèƒ½æå‡è‡³é¡¶å±‚ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡ `autowin.click()`ã€`autowin.get_window()` ç­‰æ–¹å¼è°ƒç”¨ï¼Œæ— éœ€å…³å¿ƒå†…éƒ¨æ¨¡å—ç»“æ„ã€‚
*   **çª—å£æ“ä½œ**: æŸ¥æ‰¾ã€æ¿€æ´»ã€æœ€å¤§åŒ–ã€æœ€å°åŒ–ã€æ¢å¤ã€å…³é—­ã€ç§»åŠ¨ã€è°ƒæ•´çª—å£å¤§å°ã€‚
*   **æ§ä»¶äº¤äº’**: æŸ¥æ‰¾ã€ç‚¹å‡»æŒ‰é’®ã€è¾“å…¥æ–‡æœ¬ã€é€‰æ‹©åˆ—è¡¨é¡¹ã€æ“ä½œå¤é€‰æ¡†ç­‰ã€‚
*   **é¼ æ ‡é”®ç›˜**: æ¨¡æ‹Ÿç‚¹å‡»ã€åŒå‡»ã€å³é”®ã€æ‹–æ‹½ã€æ»šåŠ¨ã€è¾“å…¥æ–‡æœ¬ã€æŒ‰é”®ç»„åˆã€‚
*   **å±å¹•æ„ŸçŸ¥**: æˆªå–å±å¹•ã€åœ¨å±å¹•ä¸ŠæŸ¥æ‰¾å›¾åƒå¹¶ç‚¹å‡»ã€‚
*   **å‰ªè´´æ¿**: å¤åˆ¶æ–‡æœ¬åˆ°å‰ªè´´æ¿ï¼Œä»å‰ªè´´æ¿ç²˜è´´æ–‡æœ¬ã€‚
*   **åº”ç”¨ç®¡ç†**: å¯åŠ¨åº”ç”¨ç¨‹åºã€æ‰“å¼€URLã€è·å–ç½‘é¡µæ ‡é¢˜ã€‚
*   **ç»Ÿä¸€äº‹ä»¶ç›‘å¬**: æä¾› `start_listening` å’Œ `stop_listening` ç»Ÿä¸€æ¥å£ï¼Œç”¨äºç›‘å¬é¼ æ ‡ã€é”®ç›˜äº‹ä»¶ã€å‰ªè´´æ¿å†…å®¹å˜åŒ–å’Œçƒ­é”®ã€‚
*   **å¥å£®æ€§**: å†…ç½®å¯é…ç½®çš„é‡è¯•æœºåˆ¶ï¼ˆæ”¯æŒé‡è¯•æ¬¡æ•°ã€å»¶è¿Ÿå’ŒæŒ‡æ•°é€€é¿ï¼‰ï¼Œæé«˜æ“ä½œæˆåŠŸç‡ã€‚
*   **æ§ä»¶ä¿¡æ¯**: æä¾› `print_control_info` APIï¼Œç”¨äºæ‰“å°çª—å£ä¸­æ‰€æœ‰æ§ä»¶çš„è¯¦ç»†æ ‡è¯†ç¬¦ï¼Œæ–¹ä¾¿UIè‡ªåŠ¨åŒ–å®šä½ã€‚
*   **å¯è§‚æµ‹æ€§**: å®Œå–„çš„æ—¥å¿—ç³»ç»Ÿï¼Œè®°å½•è‡ªåŠ¨åŒ–è„šæœ¬çš„æ‰§è¡Œè¿‡ç¨‹å’Œå…³é”®ä¿¡æ¯ã€‚
*   **é”™è¯¯å¤„ç†**: è¯¦ç»†çš„è‡ªå®šä¹‰å¼‚å¸¸ï¼Œå¸®åŠ©å¿«é€Ÿå®šä½å’Œè§£å†³é—®é¢˜ã€‚
*   **çµæ´»é…ç½®**: æ”¯æŒé€šè¿‡å…¨å±€ `settings` å¯¹è±¡è°ƒæ•´æ¨¡å—è¡Œä¸ºï¼ˆå¦‚è¶…æ—¶æ—¶é—´ã€æ—¥å¿—çº§åˆ«ã€é‡è¯•ç­–ç•¥ï¼‰ã€‚

## ğŸ“¦ å®‰è£…

æ‚¨å¯ä»¥é€šè¿‡ `pip` ç›´æ¥å®‰è£… AutoWinï¼š

```bash
pip install autowin
```

### ä»æºä»£ç å®‰è£… (ä½¿ç”¨ Poetry)

å¦‚æœæ‚¨å¸Œæœ›ä»æºä»£ç å®‰è£…æˆ–è¿›è¡Œå¼€å‘ï¼ŒAutoWin ä½¿ç”¨ [Poetry](https://python-poetry.org/) è¿›è¡Œé¡¹ç›®ç®¡ç†å’Œä¾èµ–å®‰è£…ã€‚è¯·ç¡®ä¿æ‚¨çš„ç³»ç»Ÿå·²å®‰è£… Poetryã€‚

1.  **å…‹éš†ä»“åº“**:
    ```bash
    git clone https://github.com/your_username/autowin.git
    cd autowin
    ```

2.  **å®‰è£…ä¾èµ–**:
    ```bash
    poetry install
    ```

3.  **æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ**:
    ```bash
    poetry shell
    ```

## ğŸ’¡ ä½¿ç”¨ç¤ºä¾‹

ä»¥ä¸‹æ˜¯ä¸€ä¸ªä½¿ç”¨ AutoWin è‡ªåŠ¨åŒ–è®¡ç®—å™¨çš„ç¤ºä¾‹ï¼Œå±•ç¤ºäº†å…¶ç®€æ´çš„ API è®¾è®¡ã€‚

```python
import autowin
import time
import logging

# --- 1. åŸºæœ¬é…ç½® ---
# æ‚¨å¯ä»¥æŒ‰éœ€è°ƒæ•´å…¨å±€è®¾ç½®
autowin.settings.LOG_LEVEL = logging.INFO
autowin.settings.DEFAULT_TIMEOUT = 15  # å¢åŠ é»˜è®¤è¶…æ—¶æ—¶é—´

def calculator_automation():
    """è‡ªåŠ¨åŒ–è®¡ç®—å™¨æ‰§è¡Œ 1 + 2 = 3 çš„è¿‡ç¨‹ã€‚"""
    try:
        # --- 2. å¯åŠ¨åº”ç”¨å¹¶è·å–çª—å£ ---
        autowin.logger.info("ğŸš€ æ­£åœ¨å¯åŠ¨è®¡ç®—å™¨...")
        autowin.start_app(r"C:\Windows\System32\calc.exe", wait_time=2)
        
        # è·å–è®¡ç®—å™¨çª—å£
        calc_window = autowin.get_window(title="è®¡ç®—å™¨")
        autowin.activate_window(calc_window)
        autowin.logger.info("âœ… æˆåŠŸè·å–å¹¶æ¿€æ´»è®¡ç®—å™¨çª—å£ã€‚")

        # --- 3. æ§ä»¶äº¤äº’ ---
        autowin.logger.info("ğŸ–±ï¸ æ­£åœ¨æ‰§è¡Œè®¡ç®—: 1 + 2 = ?")
        # ç‚¹å‡» "1"
        autowin.click_control(autowin.get_control(calc_window, title="ä¸€", auto_id="num1Button"))
        # ç‚¹å‡» "+"
        autowin.click_control(autowin.get_control(calc_window, title="åŠ ", auto_id="plusButton"))
        # ç‚¹å‡» "2"
        autowin.click_control(autowin.get_control(calc_window, title="äºŒ", auto_id="num2Button"))
        # ç‚¹å‡» "="
        autowin.click_control(autowin.get_control(calc_window, title="ç­‰äº", auto_id="equalButton"))
        
        time.sleep(1) # ç­‰å¾…è®¡ç®—ç»“æœ

        # --- 4. è·å–ç»“æœå¹¶éªŒè¯ ---
        result_display = autowin.get_control(calc_window, auto_id="CalculatorResults")
        result_text = autowin.get_text(result_display)
        
        if "3" in result_text:
            autowin.logger.info(f"âœ… è®¡ç®—ç»“æœæ­£ç¡®: {result_text.strip()}")
        else:
            autowin.logger.error(f"âŒ è®¡ç®—ç»“æœé”™è¯¯: {result_text.strip()}")

        # --- 5. å±å¹•æˆªå›¾ ---
        screenshot_path = autowin.take_screenshot("calculator_result.png")
        autowin.logger.info(f"ğŸ“¸ å·²å°†ç»“æœæˆªå›¾ä¿å­˜è‡³: {screenshot_path}")

    except autowin.WindowNotFoundError as e:
        autowin.logger.error(f"âŒ çª—å£æœªæ‰¾åˆ°: {e}")
    except autowin.ControlNotFoundError as e:
        autowin.logger.error(f"âŒ æ§ä»¶æœªæ‰¾åˆ°: {e}")
    except Exception as e:
        autowin.logger.error(f"âŒ å‘ç”ŸæœªçŸ¥é”™è¯¯: {e}")
    finally:
        # --- 6. å…³é—­åº”ç”¨ ---
        try:
            calc_window = autowin.get_window(title="è®¡ç®—å™¨", timeout=2)
            if calc_window:
                autowin.close_window(calc_window)
                autowin.logger.info("âœ… è®¡ç®—å™¨å·²å…³é—­ã€‚")
        except autowin.WindowNotFoundError:
            autowin.logger.warning("âš ï¸ è®¡ç®—å™¨çª—å£å·²ä¸å­˜åœ¨ã€‚")
        
        autowin.logger.info("--- è‡ªåŠ¨åŒ–æµç¨‹ç»“æŸ ---")

def hotkey_listener_example():
    """å±•ç¤ºå¦‚ä½•ç›‘å¬çƒ­é”®ã€‚"""
    print("\n--- çƒ­é”®ç›‘å¬ç¤ºä¾‹ ---")
    print("æŒ‰ä¸‹ Ctrl+Alt+H è§¦å‘å›è°ƒã€‚æŒ‰ Esc é”®åœæ­¢ç›‘å¬ã€‚")

    def on_hotkey_activate():
        print("ğŸ”¥ çƒ­é”® Ctrl+Alt+H å·²è¢«æŒ‰ä¸‹ï¼")

    # å¯åŠ¨çƒ­é”®ç›‘å¬
    hotkey_listener = autowin.start_listening(
        target='hotkey', 
        hotkey=['ctrl', 'alt', 'h'],
        on_activate=on_hotkey_activate
    )

    # å¯åŠ¨ä¸€ä¸ªç‹¬ç«‹çš„é”®ç›˜ç›‘å¬æ¥æ•è· Esc é”®ä»¥åœæ­¢ç¨‹åº
    def on_key_press(key):
        if key == autowin.listener.keyboard.Key.esc:
            print("ğŸ›‘ æ£€æµ‹åˆ° Escï¼Œæ­£åœ¨åœæ­¢æ‰€æœ‰ç›‘å¬...")
            autowin.stop_listening(hotkey_listener)
            return False # è¿”å› False ä»¥åœæ­¢æ­¤é”®ç›˜ç›‘å¬å™¨
    
    keyboard_listener = autowin.start_listening(target='keyboard', on_press=on_key_press)
    
    # é˜»å¡ä¸»çº¿ç¨‹ç›´åˆ°ç›‘å¬å™¨ç»“æŸ
    keyboard_listener.join()
    print("--- ç›‘å¬ç»“æŸ ---")


if __name__ == "__main__":
    calculator_automation()
    hotkey_listener_example()
```

## ğŸ“š API æ–‡æ¡£

éšç€ API çš„æ‰å¹³åŒ–ï¼Œæ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½éƒ½å¯ä»¥ç›´æ¥ä» `autowin` æ¨¡å—å¯¼å…¥å’Œè°ƒç”¨ã€‚è¯¦ç»†çš„å‡½æ•°ç­¾åå’Œè¯´æ˜è¯·ç›´æ¥å‚è€ƒæºä»£ç æˆ–ä½¿ç”¨ `help(autowin)` æŸ¥çœ‹ã€‚

ä¸»è¦çš„å‡½æ•°åŒ…æ‹¬ï¼š

-   **åº”ç”¨ä¸æ ¸å¿ƒ**: `start_app`, `connect_app`, `get_current_app`, `set_backend`, `print_control_info`, `get_url_title`
-   **çª—å£æ“ä½œ**: `get_window`, `activate_window`, `maximize_window`, `minimize_window`, `restore_window`, `close_window`, `move_window`, `resize_window`, `get_window_info`, `set_topmost`, `remove_topmost`, `is_topmost`
-   **æ§ä»¶æ“ä½œ**: `get_control`, `click_control`, `set_text`, `get_text`, `select_item`, `is_checked`, `check_control`, `uncheck_control`, `get_control_properties`
-   **è¾“å…¥æ“ä½œ**: `click`, `double_click`, `right_click`, `move_to`, `drag_to`, `scroll`, `type_text`, `press_key`, `hotkey`
-   **è§†è§‰ä¸æˆªå›¾**: `take_screenshot`, `find_image`, `click_image`, `wait_for_image`, `wait_until_image_disappears`
-   **å‰ªè´´æ¿**: `copy_to_clipboard`, `paste_from_clipboard`
-   **ç›‘å¬å™¨**: `start_listening`, `stop_listening`
-   **è¾…åŠ©å·¥å…·**: `sleep`, `get_mouse_position`, `get_screen_resolution`, `retry`
-   **é…ç½®ä¸å¼‚å¸¸**: `settings`, `logger`, `AutoWinError`, `WindowNotFoundError`, `ControlNotFoundError`, `ImageNotFoundError`, `ClipboardError`, `AutoWinConfigError`, `AutoWinInputError`
-   **æ¶ˆæ¯å‘é€**: `send_dingding_message`, `send_dingding_message_async`, `send_wecom_message`, `send_wecom_message_async`

## ï¸å¼€å‘ä¸è´¡çŒ®

æ¬¢è¿é€šè¿‡ Pull Request è´¡çŒ®ä»£ç ï¼Œæˆ–æäº¤ Issue æŠ¥å‘Š Bug å’Œæå‡ºæ–°åŠŸèƒ½å»ºè®®ã€‚

### ä»£ç é£æ ¼

æœ¬é¡¹ç›®éµå¾ª [PEP 8](https://www.python.org/dev/peps/pep-0008/) è§„èŒƒã€‚

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ã€‚è¯¦è§ `LICENSE` æ–‡ä»¶ã€‚

## â¤ï¸ é¸£è°¢

*   [pywinauto](https://pywinauto.readthedocs.io/en/latest/): å¼ºå¤§çš„ Windows GUI è‡ªåŠ¨åŒ–åº“ã€‚
*   [pyautogui](https://pyautogui.readthedocs.io/en/latest/): è·¨å¹³å°çš„ GUI è‡ªåŠ¨åŒ–å·¥å…·ã€‚
*   [pyperclip](https://pyperclip.readthedocs.io/en/latest/): è·¨å¹³å°å‰ªè´´æ¿æ¨¡å—ã€‚
*   [Pillow](https://python-pillow.org/): Python å›¾åƒå¤„ç†åº“ã€‚

---
**ä½œè€…**: Xiaoqiang  
**å¾®ä¿¡å…¬ä¼—å·**: XiaoqiangClub
