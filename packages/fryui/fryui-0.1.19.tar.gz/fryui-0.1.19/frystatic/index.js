var be=async function(){let{dom:m}=this.fryargs;this.focus=()=>{m.focus()},this.fryembeds=[]};var ye=async function(){let{gutters:m,ncol:r,nrow:n,resizable:c}=this.fryargs;this.hgutters=h=>{let g=[];for(let u=0;u<r;u++){let C=h*r+u,l=this.fryelement.children.item(C);if(l&&l.frycomponents&&l.frycomponents.length>0){let k=l.frycomponents[0];k.isGutter&&g.push(k)}}return g},this.vgutters=h=>{let g=[];for(let u=0;u<n;u++){let C=u*r+h,l=this.fryelement.children.item(C);if(l&&l.frycomponents&&l.frycomponents.length>0){let k=l.frycomponents[0];k.isGutter&&g.push(k)}}return g},this.fryembeds=[]};var me=async function(){let{el:m,bar:r,ish:n,isv:c,cursor:h,col:g,row:u,ncol:C,nrow:l,resizable:k,center:j}=this.fryargs,t=!1,i=[],f=[],b=[],d=[],p=0,v=0,S=0,e=0,a=0,y=0,R=[],_=[],$=0,Q=0,X=[],ee=[],re=0,te=0,oe=0,ne=0,U=0,Se,ke,F,ze,G,Ee,I="grid-template-columns",B="grid-template-rows",ie="bg-primarya",E=m.parentElement;r.classList.add("h-full"),r.classList.add("w-full"),n&&(r.classList.add("-top-3px"),r.classList.add("h-7px"),r.classList.remove("h-full")),c&&(r.classList.add("-left-3px"),r.classList.add("w-7px"),r.classList.remove("w-full"));let D=(o,s)=>Number(o.slice(0,-1*s.length)),_e=function(o){return o.endsWith("px")?{value:o,type:"px",numeric:D(o,"px")}:o.endsWith("fr")?{value:o,type:"fr",numeric:D(o,"fr")}:o.endsWith("%")?{value:o,type:"%",numeric:D(o,"%")}:o==="auto"?{value:o,type:"auto"}:null},Ce=o=>o.value?o.value:`${o.numeric}${o.type}`,W=o=>o.split(" ").map(_e),ae=o=>o.map(Ce).join(" "),se=o=>b.slice(0,o).reduce((s,w)=>s+w.numeric,0),Le=o=>b.slice(0,o+1).reduce((s,w)=>s+w.numeric,0),ce=o=>d.slice(0,o).reduce((s,w)=>s+w.numeric,0),je=o=>d.slice(0,o+1).reduce((s,w)=>s+w.numeric,0),le=o=>"touches"in o?o.touches[0].clientX:o.clientX,de=o=>"touches"in o?o.touches[0].clientY:o.clientY,A=(o,s)=>{i[o].value=null,i[o].type==="px"?i[o].numeric=s:i[o].type==="fr"?R.length===1?i[o].numeric=1:p!==0&&(i[o].numeric=s/p):i[o].type==="%"&&S!==0&&(i[o].numeric=s/S)},M=(o,s)=>{f[o].value=null,f[o].type==="px"?f[o].numeric=s:f[o].type==="fr"?X.length===1?f[o].numeric=1:v!==0&&(f[o].numeric=s/v):f[o].type==="%"&&e!==0&&(f[o].numeric=s/e)},T=(o,s)=>{for(let w=0;w<o.length;w++)if(o[w].type==s&&o[w].numeric>0)return w;return null},H=()=>!1,Re=()=>r.classList.add(ie),Ve=()=>r.classList.remove(ie),fe=()=>{if(this.centered){if(n)return this.fryparent.vgutters(0);if(c)return this.fryparent.hgutters(0)}if(C===1||l===1)return[this];let o=new Set;if(n)for(let s of this.fryparent.hgutters(u))o.add(s);if(c)for(let s of this.fryparent.vgutters(g))o.add(s);return o},ge=()=>{k&&fe().forEach(s=>s.show())},he=()=>{!t&&k&&fe().forEach(s=>s.hide())},Ne=o=>{let s=E.getBoundingClientRect();Se=s.width,ke=s.height,F=s.top,ze=s.bottom,G=s.left,Ee=s.right;let w=le(o),L=de(o);if(n){let z=E.style[B];if(z&&(f=W(z)),z=window.getComputedStyle(E)[B],z&&(d=W(z),this.centered&&(U=d[0].numeric+d[2].numeric+d[4].numeric)),$=L-F-ce(u),Q=d[u].numeric-$,X=f.filter(x=>x.type==="fr"),ee=f.filter(x=>x.type==="%"),X.length){let x=T(f,"fr");x!==null&&(v=d[x].numeric/f[x].numeric)}if(ee.length){let x=T(f,"%");x!==null&&(e=d[x].numeric/f[x].numeric)}oe=ce(u-1),ne=je(u+1)}if(c){let z=E.style[I];if(z&&(i=W(z)),z=window.getComputedStyle(E)[I],z&&(b=W(z),this.centered&&(U=b[0].numeric+b[2].numeric+b[4].numeric)),a=w-G-se(g),y=b[g].numeric-a,R=i.filter(x=>x.type==="fr"),_=i.filter(x=>x.type==="%"),R.length){let x=T(i,"fr");x!==null&&(p=b[x].numeric/i[x].numeric)}if(_.length){let x=T(i,"%");x!==null&&(S=b[x].numeric/i[x].numeric)}re=se(g-1),te=Le(g+1)}},ue=o=>{k&&("button"in o&&o.button!==0||(o.preventDefault(),Ne(o),t=!0,window.addEventListener("mouseup",N),window.addEventListener("touchend",N),window.addEventListener("touchcancel",N),window.addEventListener("mousemove",Y),window.addEventListener("touchmove",Y),document.documentElement.classList.add(h),E.addEventListener("selectstart",H),E.addEventListener("dragstart",H),E.style.userSelect="none",E.style.webkitUserSelect="none",E.style.MozUserSelect="none",E.style.pointerEvents="none",ge()))},Y=o=>{if(n){let s=de(o),w=F+oe+$,L=F+ne-Q;if(s<w&&(s=w),s>L&&(s=L),this.centered){let z=0,x=0;u===1?z=s-w:z=L-s,x=U-2*z,M(0,z),M(2,x),M(4,z)}else M(u-1,s-w),M(u+1,L-s);E.style[B]=ae(f)}if(c){let s=le(o),w=G+re+a,L=G+te-y;if(s<w&&(s=w),s>L&&(s=L),this.centered){let z=0,x=0;g===1?z=s-w:z=L-s,x=U-2*z,A(0,z),A(2,x),A(4,z)}else A(g-1,s-w),A(g+1,L-s);E.style[I]=ae(i)}},N=()=>{t=!1,window.removeEventListener("mouseup",N),window.removeEventListener("touchend",N),window.removeEventListener("touchcancel",N),window.removeEventListener("mousemove",Y),window.removeEventListener("touchmove",Y),document.documentElement.classList.remove(h),E.removeEventListener("selectstart",H),E.removeEventListener("dragstart",H),E.style.userSelect="",E.style.webkitUserSelect="",E.style.MozUserSelect="",E.style.pointerEvents="",he()};this.centered=j,this.show=Re,this.hide=Ve,this.col=g,this.row=u,this.ish=n,this.isv=c,this.isGutter=!0,this.fryembeds=[ge,he,ue,ue]};var pe=async function(){let{rightGutter:m,grid:r,leftGutter:n}=this.fryargs,c=(e,a)=>Number(e.slice(0,-1*a.length)),h=function(e){return e.endsWith("px")?{value:e,type:"px",numeric:c(e,"px")}:e.endsWith("fr")?{value:e,type:"fr",numeric:c(e,"fr")}:e.endsWith("%")?{value:e,type:"%",numeric:c(e,"%")}:e==="auto"?{value:e,type:"auto"}:null},g=e=>e.value?e.value:`${e.numeric}${e.type}`,u=e=>e.split(" ").map(h),C=e=>e.map(g).join(" "),l=5,k="grid-template-columns",j=(e,a)=>{for(let y=0;y<e.length;y++)if(e[y].type==a&&e[y].numeric>0)return y;return null},t=[],i=[],f=[],b=[],d=0,p=0,v=()=>{t=[],i=[],f=[],b=[],d=0,p=0;let e=r.style[k];if(e&&(t=u(e)),e=window.getComputedStyle(r)[k],e&&(i=u(e)),f=t.filter(a=>a.type==="fr"),f.length){let a=j(t,"fr");a!==null&&(d=i[a].numeric/t[a].numeric)}if(b=t.filter(a=>a.type==="%"),b.length){let a=j(t,"%");a!==null&&(p=i[a].numeric/t[a].numeric)}},S=(e,a)=>{t[e].value=null,t[e].type==="px"?t[e].numeric=a:t[e].type==="fr"?f.length===1?t[e].numeric=1:d!==0&&(t[e].numeric=a/d):t[e].type==="%"&&p!==0&&(t[e].numeric=a/p)};this.broaden=()=>{v();let e=i[0].numeric,a=i[2].numeric,y=i[4].numeric;e<=l||y<=l||(e-=l,y-=l,a+=l+l,S(0,e),S(2,a),S(4,y),r.style[k]=C(t))},this.narrow=()=>{v();let e=i[0].numeric,a=i[2].numeric,y=i[4].numeric;a<=l+l||(e+=l,y+=l,a-=l+l,S(0,e),S(2,a),S(4,y),r.style[k]=C(t))},this.setCentered=e=>{e&&!n.centered&&(r.style[k]="1fr 1px 2fr 1px 1fr"),n.centered=e,m.centered=e},this.isCentered=()=>n.centered,this.hgutters=e=>[n,m],this.vgutters=e=>e===1?[n]:e===3?[m]:[],this.fryembeds=[]};var xe=async function(){let{nrow:m,resizable:r}=this.fryargs;this.hgutters=n=>{let c=this.fryelement.children.item(n);if(c&&c.frycomponents&&c.frycomponents.length>0){let h=c.frycomponents[0];if(h.isGutter)return[h]}return[]},this.vgutters=n=>{let c=[];for(let h=0;h<m;h++){let g=this.fryelement.children.item(h);if(g&&g.frycomponents&&g.frycomponents.length>0){let u=g.frycomponents[0];u.isGutter&&c.push(u)}}return c},this.fryembeds=[]};var ve=async function(){let{topGutter:m,bottomGutter:r,grid:n}=this.fryargs,c=(e,a)=>Number(e.slice(0,-1*a.length)),h=function(e){return e.endsWith("px")?{value:e,type:"px",numeric:c(e,"px")}:e.endsWith("fr")?{value:e,type:"fr",numeric:c(e,"fr")}:e.endsWith("%")?{value:e,type:"%",numeric:c(e,"%")}:e==="auto"?{value:e,type:"auto"}:null},g=e=>e.value?e.value:`${e.numeric}${e.type}`,u=e=>e.split(" ").map(h),C=e=>e.map(g).join(" "),l=5,k="grid-template-rows",j=(e,a)=>{for(let y=0;y<e.length;y++)if(e[y].type==a&&e[y].numeric>0)return y;return null},t=[],i=[],f=[],b=[],d=0,p=0,v=()=>{t=[],i=[],f=[],b=[],d=0,p=0;let e=n.style[k];if(e&&(t=u(e)),e=window.getComputedStyle(n)[k],e&&(i=u(e)),f=t.filter(a=>a.type==="fr"),f.length){let a=j(t,"fr");a!==null&&(d=i[a].numeric/t[a].numeric)}if(b=t.filter(a=>a.type==="%"),b.length){let a=j(t,"%");a!==null&&(p=i[a].numeric/t[a].numeric)}},S=(e,a)=>{t[e].value=null,t[e].type==="px"?t[e].numeric=a:t[e].type==="fr"?f.length===1?t[e].numeric=1:d!==0&&(t[e].numeric=a/d):t[e].type==="%"&&p!==0&&(t[e].numeric=a/p)};this.broaden=()=>{v();let e=i[0].numeric,a=i[2].numeric,y=i[4].numeric;e<=l||y<=l||(e-=l,y-=l,a+=l+l,S(0,e),S(2,a),S(4,y),n.style[k]=C(t))},this.narrow=()=>{v();let e=i[0].numeric,a=i[2].numeric,y=i[4].numeric;a<=l+l||(e+=l,y+=l,a-=l+l,S(0,e),S(2,a),S(4,y),n.style[k]=C(t))},this.setCentered=e=>{e&&!m.centered&&(n.style[k]="1fr 1px 2fr 1px 1fr"),m.centered=e,r.centered=e},this.isCentered=()=>m.centered,this.hgutters=e=>{if(e===1)return[m];if(e===3)return[r]},this.vgutters=e=>[m,r],this.fryembeds=[]};var we=async function(){let{ncol:m,resizable:r}=this.fryargs;this.hgutters=n=>{let c=[];for(let h=0;h<m;h++){let g=this.fryelement.children.item(h);if(g&&g.frycomponents&&g.frycomponents.length>0){let u=g.frycomponents[0];u.isGutter&&c.push(u)}}return c},this.vgutters=n=>{let c=this.fryelement.children.item(n);if(c&&c.frycomponents&&c.frycomponents.length>0){let h=c.frycomponents[0];if(h.isGutter)return[h]}return[]},this.fryembeds=[]};var V=[],P=class{constructor(r){this.rawValue=r,this.effectSet=new Set}addEffect(r){this.effectSet.add(r)}removeEffect(r){this.effectSet.delete(r)}hasEffect(r){return this.effectSet.has(r)}peek(){return this.rawValue}get value(){let r=V.length;if(r===0)return this.rawValue;let n=V[r-1];return this.hasEffect(n)||(this.effectSet.add(n),n.addSignal(this)),this.rawValue}set value(r){if(this.rawValue!==r){this.rawValue=r;let n=[];for(let c of this.effectSet)try{c.callback()}catch(h){n.push([c,h])}if(n.length>0)throw n}}};var J=class{constructor(r){this.fn=r,this.active=!1,this.todispose=!1,this.disposed=!1,this.signalSet=new Set}addSignal(r){this.signalSet.add(r)}removeSignal(r){this.signalSet.delete(r)}callback(){if(!(this.active===!0||this.disposed===!0)){V.push(this),this.active=!0,this.signalSet.clear();try{this.fn()}finally{this.active=!1,V.pop(),this.todispose&&this.dispose()}}}dispose(){if(!this.disposed){if(this.active){this.todispose=!0;return}for(let r of this.signalSet)r.removeEffect(this);this.signalSet.clear(),this.todispose=!1,this.disposed=!0}}};function q(m){let r=new J(m);try{r.callback()}catch(n){throw r.dispose(),n}return r.dispose.bind(r)}var O=class{constructor(r){this.fn=r,this.rawValue=void 0,this.active=!1,this.todispose=!1,this.disposed=!1,this.effectSet=new Set,this.signalSet=new Set}addEffect(r){this.effectSet.add(r)}removeEffect(r){this.effectSet.delete(r)}hasEffect(r){return this.effectSet.has(r)}peek(){return this.rawValue}get value(){this.rawValue=this.fn();let r=V.length;if(r===0)return this.rawValue;let n=V[r-1];return this.hasEffect(n)||(this.effectSet.add(n),n.addSignal(this)),this.rawValue}addSignal(r){this.signalSet.add(r)}removeSignal(r){this.signalSet.delete(r)}callback(){if(this.active===!0||this.disposed===!0)return;V.push(this),this.active=!0,this.signalSet.clear();let r;try{if(r=this.fn(),r!=this.rawValue){this.rawValue=r;let n=[];for(let c of this.effectSet)try{c.callback()}catch(h){n.push([c,h])}if(n.length>0)throw n}}finally{this.active=!1,V.pop(),this.todispose&&this.dispose()}}dispose(){if(!this.disposed){if(this.active){this.todispose=!0;return}for(let r of this.signalSet)r.removeEffect(this);this.signalSet.clear();for(let r of this.effectSet)r.removeSignal(this);this.effectSet.clear(),this.todispose=!1,this.disposed=!0}}};var Z=class{constructor({cid:r,name:n,setup:c,args:h,refs:g,element:u,g:C}){this.fryid=r;let l=n.split(":");l.length==1?(this.fryapp="",this.fryname=n):(this.fryapp=l[0],this.fryname=l[1]),this.frysetup=c,this.fryargs=h,this.fryrefs=g,this.fryelement=u,this.fryg=C,this._fryparent=null,this._fryroot=null}ready(r){this.fryg.readyFns.push(r)}get g(){return this.fryg.g}get isReady(){return this.fryg.isReady}get fryparent(){if(this._fryparent)return this._fryparent;let r=this.fryelement,n=r.frycomponents,c=n.indexOf(this);if(c>0)return this._fryparent=n[c-1],this._fryparent;for(r=r.parentElement;r;){if("frycomponents"in r)return n=r.frycomponents,this._fryparent=n[n.length-1],this._fryparent;r=r.parentElement}}get fryroot(){let r=this.fryelement,n=this;if(!r.isConnected)return this._fryroot=null,null;if(this._fryroot)return this._fryroot;for(;r;)"frycomponents"in r&&(n=r.frycomponents[0]),r=r.parentElement;return this._fryroot=n,n}},Ae={};async function K(m,r,n){let c={readyFns:[],isReady:!1,g:Ae},h={},g=[],u={};for(let t of document.querySelectorAll("script[data-fryid]"))u[t.dataset.fryid]=t;function C(t){let i=document.createElement("textarea");return i.innerHTML=t,JSON.parse(i.value)}function l(t){if(t.tagName!=="SCRIPT"){if(t.tagName==="TEMPLATE")return;if(t.dataset&&"fryid"in t.dataset)for(let i of t.dataset.fryid.split(" ")){if(i in h)throw`duplicate component id ${i}`;if(!(i in u))throw`unknown component id ${i}`;let f=u[i],{setup:b,args:d,refs:p}=C(f.textContent),{fryname:v}=f.dataset;g.length===0&&d&&Object.assign(d,n);let S=h[i]=new Z({cid:i,name:v,setup:b,args:d,refs:p,element:t,g:c});g.push(S),"frycomponents"in t?t.frycomponents.push(S):t.frycomponents=[S]}for(let i of t.children)l(i)}}l(m);let k=m.querySelectorAll("[data-fryref]:not(script)");for(let t of k){let i=t.dataset.fryref;for(let f of i.split(" ")){let[b,d]=f.split("-"),p=h[d];if(b.endsWith(":a")){let v=b.slice(0,-2);v in p.fryargs?p.fryargs[v].push(t):p.fryargs[v]=[t]}else p.fryargs[b]=t}}for(let t of g){let i=function(f){let b=m.querySelector(`[data-frytid="${f}"]`);return{template:b,create:async p=>{let v=b.content.cloneNode(!0);return await K(v,r,p),v.firstElementChild.frycomponents[0]}}};for(let f in t.fryrefs){let b=t.fryrefs[f],d=f,p=v=>h[v];f.startsWith("t:")&&(d=f.slice(2),p=i),Array.isArray(b)?t.fryargs[d]=b.map(v=>p(v)):t.fryargs[d]=p(b)}}function j(t){let i=""+t.fryid+"/",f=t.fryembeds;function b(d){if("fryembed"in d.dataset){let p=d.dataset.fryembed;for(let v of p.split(" ")){if(!v.startsWith(i))continue;let[S,e,...a]=v.substr(i.length).split("-"),y=parseInt(S),R=a.join("-");if(y>=f.length){console.log("invalid embed id: ",S);continue}let _=f[y];e==="text"?_ instanceof P||_ instanceof O?q(()=>d.textContent=_.value):d.textContent=_:e==="html"?_ instanceof P||_ instanceof O?q(()=>d.innerHTML=_.value):d.innerHTML=_:e==="event"?d.addEventListener(R,_):e==="attr"?_ instanceof P||_ instanceof O?q(()=>d.setAttribute(R,_.value)):d.setAttribute(R,_):e==="object"?("frydata"in d||(d.frydata={}),d.frydata[R]=_):console.log("invalid attribute type: ",e)}}for(let p of d.children)b(p)}b(t.fryelement)}for(let t of g){if(!t.frysetup)continue;await r[t.frysetup].bind(t)(),j(t)}for(let t of c.readyFns)t();c.readyFns.length=0,c.isReady=!0}var Me={fryui_button_Button:be,fryui_grid_Grid:ye,fryui_grid_Gutter:me,fryui_grid_HCenter:pe,fryui_grid_HSplit:xe,fryui_grid_VCenter:ve,fryui_grid_VSplit:we},er=async m=>await K(m,Me);export{er as hydrate};
//# sourceMappingURL=index.js.map
