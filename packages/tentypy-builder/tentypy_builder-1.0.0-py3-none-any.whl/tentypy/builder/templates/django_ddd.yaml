name: Django DDD
description: Django with Domain-Driven Design
version: 1.0.0
author: Keniding

variables:
  PYTHON_VERSION: "3.11"
  DJANGO_VERSION: "4.2"

structure:
  - "{{PROJECT_NAME}}/"
  - "{{PROJECT_NAME}}":
      - __init__.py
      - settings.py
      - urls.py
      - wsgi.py
      - asgi.py
  - apps/
  - apps:
      - __init__.py
      - core/
      - core:
          - __init__.py
          - domain/
          - domain:
              - __init__.py
              - entities.py
              - repositories.py
          - application/
          - application:
              - __init__.py
              - use_cases.py
          - infrastructure/
          - infrastructure:
              - __init__.py
              - models.py
              - repositories.py
          - presentation/
          - presentation:
              - __init__.py
              - views.py
              - serializers.py
  - manage.py
  - requirements.txt
  - README.md
  - .env.example
  - .gitignore

files:
  README.md: |
    # {{PROJECT_NAME}}
    
    Django DDD project created with TentyPy Builder
    
    ## Installation
    
    ```bash
    pip install -r requirements.txt
    python manage.py migrate
    python manage.py runserver
    ```
    
    Author: {{AUTHOR}}

  requirements.txt: |
    Django=={{DJANGO_VERSION}}
    djangorestframework==3.14.0
    python-dotenv==1.0.0
    psycopg2-binary==2.9.9

  .env.example: |
    SECRET_KEY=your-secret-key-here
    DEBUG=True
    DATABASE_URL=postgresql://user:pass@localhost:5432/{{PROJECT_NAME}}

  .gitignore: |
    __pycache__/
    *.py[cod]
    .env
    .venv
    venv/
    db.sqlite3
    *.log
    media/
    staticfiles/

  manage.py: |
    #!/usr/bin/env python
    import os
    import sys
    
    if __name__ == "__main__":
        os.environ.setdefault("DJANGO_SETTINGS_MODULE", "{{PROJECT_NAME}}.settings")
        try:
            from django.core.management import execute_from_command_line
        except ImportError as exc:
            raise ImportError(
                "Couldn't import Django. Are you sure it's installed?"
            ) from exc
        execute_from_command_line(sys.argv)

  "{{PROJECT_NAME}}/__init__.py": ""

  "{{PROJECT_NAME}}/settings.py": |
    import os
    from pathlib import Path
    from dotenv import load_dotenv
    
    load_dotenv()
    
    BASE_DIR = Path(__file__).resolve().parent.parent
    
    SECRET_KEY = os.getenv('SECRET_KEY', 'django-insecure-change-this')
    DEBUG = os.getenv('DEBUG', 'True') == 'True'
    ALLOWED_HOSTS = []
    
    INSTALLED_APPS = [
        'django.contrib.admin',
        'django.contrib.auth',
        'django.contrib.contenttypes',
        'django.contrib.sessions',
        'django.contrib.messages',
        'django.contrib.staticfiles',
        'rest_framework',
        'apps.core',
    ]
    
    MIDDLEWARE = [
        'django.middleware.security.SecurityMiddleware',
        'django.contrib.sessions.middleware.SessionMiddleware',
        'django.middleware.common.CommonMiddleware',
        'django.middleware.csrf.CsrfViewMiddleware',
        'django.contrib.auth.middleware.AuthenticationMiddleware',
        'django.contrib.messages.middleware.MessageMiddleware',
        'django.middleware.clickjacking.XFrameOptionsMiddleware',
    ]
    
    ROOT_URLCONF = '{{PROJECT_NAME}}.urls'
    
    TEMPLATES = [
        {
            'BACKEND': 'django.template.backends.django.DjangoTemplates',
            'DIRS': [],
            'APP_DIRS': True,
            'OPTIONS': {
                'context_processors': [
                    'django.template.context_processors.debug',
                    'django.template.context_processors.request',
                    'django.contrib.auth.context_processors.auth',
                    'django.contrib.messages.context_processors.messages',
                ],
            },
        },
    ]
    
    WSGI_APPLICATION = '{{PROJECT_NAME}}.wsgi.application'
    
    DATABASES = {
        'default': {
            'ENGINE': 'django.db.backends.sqlite3',
            'NAME': BASE_DIR / 'db.sqlite3',
        }
    }
    
    LANGUAGE_CODE = 'en-us'
    TIME_ZONE = 'UTC'
    USE_I18N = True
    USE_TZ = True
    
    STATIC_URL = 'static/'
    DEFAULT_AUTO_FIELD = 'django.db.models.BigAutoField'

  "{{PROJECT_NAME}}/urls.py": |
    from django.contrib import admin
    from django.urls import path, include
    
    urlpatterns = [
        path('admin/', admin.site.urls),
        path('api/', include('apps.core.presentation.urls')),
    ]

  "{{PROJECT_NAME}}/wsgi.py": |
    import os
    from django.core.wsgi import get_wsgi_application
    
    os.environ.setdefault('DJANGO_SETTINGS_MODULE', '{{PROJECT_NAME}}.settings')
    application = get_wsgi_application()

  "{{PROJECT_NAME}}/asgi.py": |
    import os
    from django.core.asgi import get_asgi_application
    
    os.environ.setdefault('DJANGO_SETTINGS_MODULE', '{{PROJECT_NAME}}.settings')
    application = get_asgi_application()

  apps/__init__.py: ""
  apps/core/__init__.py: ""
  apps/core/domain/__init__.py: ""

  apps/core/domain/entities.py: |
    """
    Domain Entities
    """
    from dataclasses import dataclass
    from typing import Optional
    
    @dataclass
    class Entity:
        """Base Entity"""
        id: Optional[int] = None

  apps/core/domain/repositories.py: |
    """
    Domain Repository Interfaces
    """
    from abc import ABC, abstractmethod
    from typing import List, Optional
    
    class Repository(ABC):
        """Base Repository Interface"""
        
        @abstractmethod
        def get_by_id(self, id: int):
            pass
        
        @abstractmethod
        def get_all(self) -> List:
            pass
        
        @abstractmethod
        def save(self, entity):
            pass
        
        @abstractmethod
        def delete(self, id: int):
            pass

  apps/core/application/__init__.py: ""

  apps/core/application/use_cases.py: |
    """
    Application Use Cases
    """
    
    class BaseUseCase:
        """Base Use Case"""
        
        def execute(self, *args, **kwargs):
            raise NotImplementedError

  apps/core/infrastructure/__init__.py: ""

  apps/core/infrastructure/models.py: |
    """
    Infrastructure Models (Django ORM)
    """
    from django.db import models
    
    class BaseModel(models.Model):
        """Base Model"""
        created_at = models.DateTimeField(auto_now_add=True)
        updated_at = models.DateTimeField(auto_now=True)
        
        class Meta:
            abstract = True

  apps/core/infrastructure/repositories.py: |
    """
    Infrastructure Repository Implementations
    """
    from typing import List, Optional
    from apps.core.domain.repositories import Repository
    
    class DjangoRepository(Repository):
        """Django ORM Repository Implementation"""
        
        def __init__(self, model):
            self.model = model
        
        def get_by_id(self, id: int):
            return self.model.objects.filter(id=id).first()
        
        def get_all(self) -> List:
            return list(self.model.objects.all())
        
        def save(self, entity):
            return entity.save()
        
        def delete(self, id: int):
            obj = self.get_by_id(id)
            if obj:
                obj.delete()

  apps/core/presentation/__init__.py: ""

  apps/core/presentation/views.py: |
    """
    Presentation Layer Views
    """
    from rest_framework.views import APIView
    from rest_framework.response import Response
    from rest_framework import status
    
    class HealthCheckView(APIView):
        """Health Check Endpoint"""
        
        def get(self, request):
            return Response({
                'status': 'healthy',
                'service': '{{PROJECT_NAME}}'
            })

  apps/core/presentation/serializers.py: |
    """
    Presentation Layer Serializers
    """
    from rest_framework import serializers
    
    class BaseSerializer(serializers.Serializer):
        """Base Serializer"""
        pass

  apps/core/presentation/urls.py: |
    """
    Core API URLs
    """
    from django.urls import path
    from .views import HealthCheckView
    
    urlpatterns = [
        path('health/', HealthCheckView.as_view(), name='health-check'),
    ]
