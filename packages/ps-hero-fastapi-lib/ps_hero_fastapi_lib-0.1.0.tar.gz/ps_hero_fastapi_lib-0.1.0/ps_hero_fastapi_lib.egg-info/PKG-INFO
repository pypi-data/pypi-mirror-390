Metadata-Version: 2.4
Name: ps-hero-fastapi-lib
Version: 0.1.0
Summary: Biblioteca do model de Her√≥is com banco de dados.
Home-page: https://github.com/douglasbolis/ps_hero_fastapi_lib
Author: Douglas Lima
Author-email: douglasbolislima@gmail.com
Classifier: Programming Language :: Python :: 3
Classifier: Operating System :: OS Independent
Requires-Python: >=3.8
Description-Content-Type: text/markdown
License-File: LICENSE
Dynamic: author
Dynamic: author-email
Dynamic: classifier
Dynamic: description
Dynamic: description-content-type
Dynamic: home-page
Dynamic: license-file
Dynamic: requires-python
Dynamic: summary

# ps_hero_fastapi_lib

[![Test, Deploy Lib and FastAPI Service](https://github.com/douglasbolis/ps_hero_fastapi_lib/actions/workflows/test-and-deploy-lib.yml/badge.svg)](https://github.com/douglasbolis/ps_hero_fastapi_lib/actions/workflows/test-and-deploy-lib.yml)

Lib de Cadastro de Equipes e Her√≥is desenvolvida com SQLModel.
Aplica√ß√£o de Cadastro de Equipes e Her√≥is desenvolvida com FastAPI e a lib implementada.

## Explicando o c√≥digo

API de exemplo para gerenciar **Her√≥is** usando **FastAPI**, **SQLModel** (SQLAlchemy + Pydantic), e o padr√£o **MVC com Repository**:

* **Controller (Router)** ‚Üí recebe HTTP
* **Service** ‚Üí regras de neg√≥cio
* **Repository** ‚Üí acesso ao banco
* **Model (SQLModel)** ‚Üí entidades e DTOs
* **Database** ‚Üí cria√ß√£o do engine e sess√£o

---

## ‚ú® Principais recursos

* Estrutura limpa em camadas (**Controller ‚Üí Service ‚Üí Repository ‚Üí DB**)
* **SQLModel** (tipagem forte + ORM)
* Inje√ß√£o de depend√™ncia com `Depends`
* Tratamento de erros HTTP padronizado
* Pronto para trocar **SQLite** por **PostgreSQL**

---

## üìÇ Estrutura do projeto

```bash
.
‚îú‚îÄ‚îÄ LICENSE
‚îú‚îÄ‚îÄ Makefile
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ app
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ controller                   # Controller (Router)
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ __init__.py
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ generic.py
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ hero.py
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îî‚îÄ‚îÄ team.py
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ main.py                      # inicializa√ß√£o da app e rotas
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ test
‚îÇ¬†¬†     ‚îú‚îÄ‚îÄ __init__.py
‚îÇ¬†¬†     ‚îî‚îÄ‚îÄ test_controller.py
‚îú‚îÄ‚îÄ ps_hero_fastapi_lib
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ __init__.py
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ model                        # SQLModel: entidades e schemas (Create/Update/Public)
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ __init__.py
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ dto.py
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îî‚îÄ‚îÄ models.py
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ repository
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ __init__.py
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îî‚îÄ‚îÄ base.py                  # Acesso ao banco (CRUD)
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ service
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ __init__.py
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îî‚îÄ‚îÄ base.py                  # Regras de neg√≥cio
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ test
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ __init__.py
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îî‚îÄ‚îÄ test_models.py
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ util
‚îÇ¬†¬†     ‚îú‚îÄ‚îÄ __init__.py
‚îÇ¬†¬†     ‚îî‚îÄ‚îÄ database.py              # Engine, sess√£o e inicializa√ß√£o do schema
‚îú‚îÄ‚îÄ requirements.txt
‚îî‚îÄ‚îÄ setup.py
```

---

## üß∞ Stack & Requisitos

* Python 3.10+
* FastAPI
* SQLModel
* Uvicorn

`requirements.txt`:

```
fastapi==0.114.2
uvicorn[standard]==0.30.6
SQLModel==0.0.22
```

> Para PostgreSQL, adicione tamb√©m: `psycopg[binary]==3.*`

---

## ‚öôÔ∏è Configura√ß√£o & Execu√ß√£o

1. Crie o ambiente e instale depend√™ncias:

```bash
python -m venv .venv
source .venv/bin/activate        # Windows: .venv\Scripts\activate
pip install -r requirements.txt
```

2. (Opcional) Defina o banco via vari√°vel de ambiente:

* **SQLite (padr√£o)** ‚Äì j√° funciona sem configurar nada.
* **PostgreSQL**:

  ```bash
  export DATABASE_URL="postgresql+psycopg://app:app@localhost:5432/appdb"
  ```

3. Rode a aplica√ß√£o:

```bash
uvicorn app.main:app --reload
```

4. Acesse:

* Healthcheck: [http://127.0.0.1:8000/](http://127.0.0.1:8000/)
* Docs (Swagger): [http://127.0.0.1:8000/docs](http://127.0.0.1:8000/docs)
* ReDoc: [http://127.0.0.1:8000/redoc](http://127.0.0.1:8000/redoc)

---

## üß± Modelos (resumo)

* `Hero` (tabela): `id`, `name`, `secret_name?`, `age?`
* `HeroCreate` (entrada POST)
* `HeroUpdate` (entrada PATCH, campos opcionais)
* `HeroPublic` (sa√≠da nas respostas)

---

## üîå Endpoints (Heroes)

Base path: `/heroes`

| M√©todo | Rota         | Body         | Resposta           | Descri√ß√£o                   |
| ------ | ------------ | ------------ | ------------------ | --------------------------- |
| POST   | `/`          | `HeroCreate` | `HeroPublic`       | Cria um her√≥i               |
| GET    | `/`          | ‚Äî            | `List[HeroPublic]` | Lista her√≥is (offset/limit) |
| GET    | `/{hero_id}` | ‚Äî            | `HeroPublic`       | Busca por ID                |
| PATCH  | `/{hero_id}` | `HeroUpdate` | `HeroPublic`       | Atualiza campos parciais    |
| DELETE | `/{hero_id}` | ‚Äî            | `204 No Content`   | Remove her√≥i                |

---

## üß™ Exemplos (cURL)

Criar:

```bash
curl -X POST http://127.0.0.1:8000/heroes/ \
  -H "Content-Type: application/json" \
  -d '{"name":"Ada","secret_name":"The Enchantress","age":28}'
```

Listar:

```bash
curl "http://127.0.0.1:8000/heroes/?offset=0&limit=100"
```

Buscar por ID:

```bash
curl http://127.0.0.1:8000/heroes/1
```

Atualizar (parcial):

```bash
curl -X PATCH http://127.0.0.1:8000/heroes/1 \
  -H "Content-Type: application/json" \
  -d '{"name":"Ada Lovelace"}'
```

Remover:

```bash
curl -X DELETE http://127.0.0.1:8000/heroes/1 -i
```

---

## üß† Como as camadas se conectam

```
HTTP (FastAPI)
   ‚Üì
Controller (app/controllers/heroes.py)
   ‚Üì
Service (app/services/hero_service.py)
   ‚Üì
Repository (app/repositories/hero_repository.py)
   ‚Üì
DB Session (app/database.py) + SQLModel (app/models.py)
```

* **Controller**: lida com requisi√ß√µes/respostas e valida√ß√µes de query/path; injeta depend√™ncias com `Depends`.
* **Service**: regras de neg√≥cio (ex.: checar nome duplicado).
* **Repository**: SQL puro via SQLModel/SQLAlchemy (CRUD).
* **Database**: engine, sess√£o e cria√ß√£o de schema.

## Reference:
[Documento Fast API](https://fastapi.tiangolo.com/) : Documenta√ß√£o do FAST API. 
