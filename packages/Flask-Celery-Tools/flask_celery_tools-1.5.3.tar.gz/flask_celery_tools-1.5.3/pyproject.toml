[build-system]
requires = ["setuptools"]
build-backend = 'setuptools.build_meta'

[project]
name = "Flask-Celery-Tools"
license = "MIT"
dynamic = ["version"]
requires-python = ">= 3.11"
description = "Celery support for Flask without breaking PyCharm inspections."

classifiers = [
    "Development Status :: 5 - Production/Stable",
    "Environment :: Web Environment",
    "Environment :: Console",
    "Intended Audience :: Developers",
    "Operating System :: OS Independent",
    'Framework :: Flask',
    "Programming Language :: Python",
    "Programming Language :: Python :: Implementation :: CPython",
    "Programming Language :: Python :: Implementation :: PyPy",
    "Programming Language :: Python :: 3.11",
    "Programming Language :: Python :: 3.12",
    "Programming Language :: Python :: 3.13",
    "Topic :: Software Development",
]

dependencies = [
    'flask>=1.0.2',
    'celery<=5.3.6',
    'redis>=3.5.3',
    'sqlalchemy>=1.2.7'
]

[project.optional-dependencies]
dev = [
    "ruff",
    "mypy",
    "types-setuptools",
    "flask_sqlalchemy",
    "flask_redis"
]
test = ["pytest"]

[project.readme]
file = "README.md"
content-type = "text/markdown"

[[project.authors]]
name = "Adam Schubert"
email = "adam.schubert@sg1-game.net"


[project.urls]
Homepage = "https://github.com/Salamek/Flask-Celery-Tools"

[tool.setuptools.dynamic]
version = {attr = "flask_celery.__version__"}

[tool.setuptools.packages.find]
where = ["."]
exclude = ["tests*", "examples*"]

[tool.ruff]
line-length = 150
target-version = "py311"

[tool.ruff.lint]
select = ["ALL"]

[tool.ruff.lint.mccabe]
max-complexity = 20

[tool.ruff.lint.pylint]
#allow-magic-value-types = ["int", "str"]
max-args = 8
max-branches = 16
max-returns = 10


[tool.ruff.lint.per-file-ignores]
"tests/*" = ["S101", "PLR2004"]  # Use of assert detected, line too long


[[tool.mypy.overrides]]  # Celery is not typed
    module = "celery.*"
    ignore_missing_imports = true

[[tool.mypy.overrides]]  # Flask redis is not typed
    module = "flask_redis"
    ignore_missing_imports = true

[tool.mypy]
files = ["flask_celery", "tests"]
python_version = 3.11
strict = true
show_error_codes = true
disallow_untyped_decorators = false
exclude = "(.venv/.*|build/.*)"

[tool.pytest.ini_options]
# Tell pytest where to look for tests
testpaths = [
    "tests",
]

# Pattern to match test files
python_files = [
    "test_*.py",
]